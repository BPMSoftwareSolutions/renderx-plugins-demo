{
  "version": "1.0.0",
  "generatedAt": "2025-11-25T00:00:00.000Z",
  "title": "BDD Pipeline Visual Architecture & Integration Patterns",
  "overview": {
    "description": "Architectural patterns and visual representations of BDD pipeline integration with orchestration governance framework. Captures layer interactions, data flows, and governance enforcement points.",
    "scope": "End-to-end BDD specification → implementation → validation lifecycle within JSON-first governance model"
  },
  "architectureDiagrams": [
    {
      "id": "diagram-1",
      "name": "BDD Pipeline Complete Data Flow",
      "type": "dataflow",
      "description": "Shows movement of domain specifications through generation, enrichment, implementation, and validation layers",
      "asciiDiagram": "┌─────────────────────────────────────────────────────────────────────────────────────┐\n│                        BDD PIPELINE COMPLETE DATA FLOW                                │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n\n┌────────────────────────┐\n│  AUTHORITY LAYER       │\n├────────────────────────┤\n│ orchestration-domains  │ ◄───── Registry of 6+ orchestration domains\n│        .json           │        (Musical-conductor, SLO-Dashboard, ...)\n│                        │\n│ Domain Sequence JSON   │ ◄───── Movement/Beat/Event specifications\n│ (6 movements, 30 beats)│\n└────────────┬───────────┘\n             │\n             ▼\n┌────────────────────────────────────────────────────────────────┐\n│  GENERATION LAYER                                              │\n├────────────────────────────────────────────────────────────────┤\n│ generate-bdd-feature-stubs.js (npm run generate:bdd:stubs)    │\n│                                                                │\n│   Input: orchestration-domains.json                           │\n│   Output: *.feature file scaffolds (Gherkin format)           │\n│   Process: Scan registry → Create baseline scenarios          │\n└────────────┬─────────────────────────────────────────────────┘\n             │\n             ▼\n┌────────────────────────────────────────────────────────────────┐\n│  ENRICHMENT LAYER                                              │\n├────────────────────────────────────────────────────────────────┤\n│ interactive-bdd-wizard.js (npm run interactive:bdd:wizard)    │\n│                                                                │\n│   Input: *.feature scaffolds + Domain Sequence JSON           │\n│   Output: Enriched scenarios with Given-When-Then steps       │\n│   Process: Interactive CLI for movement/beat mapping          │\n└────────────┬─────────────────────────────────────────────────┘\n             │\n             ▼\n┌────────────────────────────────────────────────────────────────┐\n│  SPECIFICATION LAYER (Gherkin)                                │\n├────────────────────────────────────────────────────────────────┤\n│ ✓ musical-conductor-orchestration.feature (11 scenarios)     │\n│ ✓ 5 additional domain .feature files (1-2 scenarios each)    │\n│                                                                │\n│ Features:                                                      │\n│   - Musical-Conductor: 6 movements + dynamic composition      │\n│   - SLO-Dashboard: Event detection + report emission          │\n│   - Payment-Gateway: Transaction routing + approval flow      │\n│   - Health-Monitor: Threshold check + alert escalation        │\n│   - Notification-Service: Multi-channel dispatch              │\n│   - Audit-Log: Event recording + compliance validation        │\n└────────────┬─────────────────────────────────────────────────┘\n             │\n             ▼\n┌────────────────────────────────────────────────────────────────┐\n│  IMPLEMENTATION LAYER (TypeScript/Cucumber)                   │\n├────────────────────────────────────────────────────────────────┤\n│ Step Definitions: packages/*/bdd/step-definitions/*.ts        │\n│                                                                │\n│ Given Steps: Set up orchestration state, movement context     │\n│ When Steps: Execute domain operations, phase transitions      │\n│ Then Steps: Assert orchestration events, state changes        │\n│                                                                │\n│ Test Fixtures: test-fixtures/orchestration/*.json             │\n│   - Musical-conductor domain instances (6 movements)          │\n│   - Domain-specific test harnesses                            │\n│   - Mock orchestration runtime interfaces                     │\n└────────────┬─────────────────────────────────────────────────┘\n             │\n             ▼\n┌────────────────────────────────────────────────────────────────┐\n│  TEST EXECUTION & COVERAGE                                     │\n├────────────────────────────────────────────────────────────────┤\n│ npm run test:bdd (Cucumber test runner)                       │\n│                                                                │\n│ Outputs:                                                       │\n│  - BDD test results (pass/fail per scenario)                  │\n│  - Code coverage metrics (lines, branches)                    │\n│  - Orchestration runtime telemetry                            │\n│  - Movement/phase execution traces                            │\n└────────────┬─────────────────────────────────────────────────┘\n             │\n             ▼\n┌────────────────────────────────────────────────────────────────┐\n│  GOVERNANCE & VALIDATION (Layers 8-9)                         │\n├────────────────────────────────────────────────────────────────┤\n│ verify:orchestration:governance                               │\n│                                                                │\n│ Layer 8 - Hash Validation:                                    │\n│   ✓ SHA256(json_source) matches recorded hash                │\n│   ✓ No drift between JSON authority + generated markdown      │\n│                                                                │\n│ Layer 9 - Manifest Completeness:                              │\n│   ✓ All BDD docs registered in generated-docs-manifest.json   │\n│   ✓ Generator script references valid                         │\n│   ✓ Output paths match auto-generated files                   │\n│                                                                │\n│ Result: COMPLIANT or VIOLATIONS DETECTED                      │\n└────────────────────────────────────────────────────────────────┘\n"
    },
    {
      "id": "diagram-2",
      "name": "Layer Interaction & Governance Enforcement",
      "type": "layered_architecture",
      "description": "Shows how 5 architectural layers interact with governance enforcement checkpoints",
      "asciiDiagram": "┌─────────────────────────────────────────────────────────────────────────────────────┐\n│                    LAYER INTERACTION & GOVERNANCE ENFORCEMENT                        │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n\n         Authority Layer (JSON)          Generation Layer              Specification Layer\n                                          (Node Scripts)                (Gherkin)\n        ┌──────────────────────┐  ┌──────────────────────┐  ┌──────────────────────┐\n        │ orchestration-domains│──│ generate-bdd-feature-│──│ *.feature files      │\n        │      .json           │  │    stubs.js          │  │                      │\n        ├──────────────────────┤  ├──────────────────────┤  ├──────────────────────┤\n        │ Domain Sequences     │  │ (Scanning & Registry)│  │ 11 scenarios         │\n        │ (6 movements)        │  │  [REGISTRY SCAN]     │  │ (Musical-Conductor)  │\n        └──────────────────────┘  └──────────┬───────────┘  └──────────────────────┘\n                  ▲                          │                        │\n              [L4: CI/CD]           ┌─────────┴────────────┐          │\n         Verify source files        │ interactive-bdd-     │          │\n                                    │    wizard.js         │          │\n        ┌──────────────────────┐    │  [ENRICHMENT]        │          │\n        │ Musical-Conductor    │    └──────────┬───────────┘          │\n        │ Sequence JSON        │               │                      ▼\n        │ (30 beats, 6         │               └──────────────────────▶ Implementation Layer\n        │  movements)          │                                      (TypeScript)\n        └──────────────────────┘        ┌──────────────────────────────┐\n                  ▲                     │ Step Definitions             │\n              [L5: Build]               │ *.ts (Given/When/Then)       │\n         Schema validation             └──────────┬───────────────────┘\n                                                   │\n              [L1-L3: IDE/Pre-Commit/Pre-Build]    │\n                  Detect invalid JSON             │\n                                                   ▼\n        ┌──────────────────────┐  ┌──────────────────────────────────┐\n        │  BDD Test Suite      │  │ Test Execution & Coverage        │\n        │  npm run test:bdd    │  │ npm run test:bdd                 │\n        │                      │  ├──────────────────────────────────┤\n        └──────────────────────┘  │ Results: Pass/Fail per scenario  │\n              ▲                    │ Coverage: Lines, Branches        │\n              │                    │ Telemetry: Movement traces       │\n          [L6: Execute]            └──────────┬───────────────────────┘\n          Run tests & check                    │\n          orchestration calls                  ▼\n                                   ┌──────────────────────────────────┐\n                                   │ Governance Documentation Layer   │\n                                   ├──────────────────────────────────┤\n                                   │ bdd-pipeline-analysis.json       │\n                                   │ (Authority for this analysis)    │\n                                   │                                  │\n                                   │ bdd-pipeline-visual-arch.json    │\n                                   │ (Architecture patterns)          │\n                                   └──────────┬───────────────────────┘\n                                              │\n                         [L7: Audit]         │\n                    Review governance docs   ▼\n                                   ┌──────────────────────────────────┐\n                                   │ Manifest Registration            │\n                                   ├──────────────────────────────────┤\n                                   │ generated-docs-manifest.json     │\n                                   │                                  │\n                                   │ Entry: source → output →         │\n                                   │        generator → hash_strategy │\n                                   └──────────┬───────────────────────┘\n                                              │\n                         [L8: Hash Validation]│\n                    SHA256(json) verification ▼\n                                   ┌──────────────────────────────────┐\n                                   │ Auto-Generated Markdown          │\n                                   ├──────────────────────────────────┤\n                                   │ BDD_PIPELINE_ANALYSIS.md         │\n                                   │ (From JSON authority)            │\n                                   │ [AUTO-GENERATED header]          │\n                                   │                                  │\n                                   │ BDD_PIPELINE_VISUAL_ARCH.md      │\n                                   │ (From JSON architecture)         │\n                                   │ [AUTO-GENERATED header]          │\n                                   └──────────┬───────────────────────┘\n                                              │\n                         [L9: Agent Governance]│\n                    Verify manifest entries   ▼\n                    Check generator scripts   COMPLIANCE\n                    Confirm drift-free       ✓ PASSED\n                                             or\n                                             ✗ VIOLATIONS\n"
    },
    {
      "id": "diagram-3",
      "name": "Musical-Conductor Domain - Movement to Scenario Mapping",
      "type": "mapping",
      "description": "Shows how 6 movements map to 11 BDD scenarios with orchestration phase alignment",
      "asciiDiagram": "┌─────────────────────────────────────────────────────────────────────────────────────┐\n│           MUSICAL-CONDUCTOR DOMAIN: MOVEMENTS → SCENARIOS MAPPING                   │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n\n╔════════════════════════════════════════════════════════════════════════════════════╗\n║ ORCHESTRATION SEQUENCE: musical-conductor-orchestration.json                       ║\n║ 6 Movements, 30 Beats Total                                                        ║\n╚════════════════════════════════════════════════════════════════════════════════════╝\n\n┌─ Movement 1: Awakening (5 Beats) ──┐    Scenarios: 1-2\n│ • Beat 1: Initialization              │    ┌─────────────────────────────────┐\n│ • Beat 2: Resonance Detection        │    │ Scenario 1: Initialize           │\n│ • Beat 3: Signal Amplification       │    │ Given: Default orchestration     │\n│ • Beat 4: State Synchronization      │    │ When: Awakening movement starts  │\n│ • Beat 5: Ready Signal               │    │ Then: All subsystems initialized │\n│                                       │    │                                  │\n│                                       │    │ Scenario 2: Detect Resonance     │\n│                                       │    │ Given: Awakening state active    │\n│                                       │    │ When: Signal resonance detected  │\n│                                       │    │ Then: Resonance value recorded   │\n│                                       │    └─────────────────────────────────┘\n└───────────────────────────────────────┘\n\n┌─ Movement 2: Ascent (5 Beats) ────────┐    Scenarios: 3-4\n│ • Beat 6: Momentum Buildup            │    ┌─────────────────────────────────┐\n│ • Beat 7: Phase Acceleration          │    │ Scenario 3: Build Momentum      │\n│ • Beat 8: Threshold Approach          │    │ Given: Resonance detected       │\n│ • Beat 9: Peak Preparation           │    │ When: Momentum phase active     │\n│ • Beat 10: Transition Signal         │    │ Then: Acceleration meter rises  │\n│                                       │    │                                  │\n│                                       │    │ Scenario 4: Approach Threshold  │\n│                                       │    │ Given: Momentum building        │\n│                                       │    │ When: Threshold proximity check │\n│                                       │    │ Then: Preparation signal sent   │\n│                                       │    └─────────────────────────────────┘\n└───────────────────────────────────────┘\n\n┌─ Movement 3: Zenith (4 Beats) ────────┐    Scenarios: 5-6\n│ • Beat 11: Peak Activation            │    ┌─────────────────────────────────┐\n│ • Beat 12: Harmonic Convergence       │    │ Scenario 5: Reach Peak          │\n│ • Beat 13: Harmonic Release          │    │ Given: Threshold approached     │\n│ • Beat 14: Apex State                │    │ When: Peak activation triggered │\n│                                       │    │ Then: Harmonic convergence      │\n│                                       │    │                                  │\n│                                       │    │ Scenario 6: Release Harmonics   │\n│                                       │    │ Given: Peak state reached       │\n│                                       │    │ When: Release phase initiated   │\n│                                       │    │ Then: Harmonic state captured   │\n│                                       │    └─────────────────────────────────┘\n└───────────────────────────────────────┘\n\n┌─ Movement 4: Descent (5 Beats) ──────┐    Scenarios: 7-8\n│ • Beat 15: Initial Decay             │    ┌─────────────────────────────────┐\n│ • Beat 16: Harmonic Dissipation      │    │ Scenario 7: Begin Descent       │\n│ • Beat 17: Momentum Release          │    │ Given: Apex state active        │\n│ • Beat 18: Phase Deceleration        │    │ When: Descent phase begins      │\n│ • Beat 19: Transition Signal         │    │ Then: Harmonic dissipation      │\n│                                       │    │                                  │\n│                                       │    │ Scenario 8: Release Momentum    │\n│                                       │    │ Given: Dissipation detected     │\n│                                       │    │ When: Momentum release phase    │\n│                                       │    │ Then: Deceleration meter active │\n│                                       │    └─────────────────────────────────┘\n└───────────────────────────────────────┘\n\n┌─ Movement 5: Resolution (4 Beats) ──┐    Scenarios: 9-10\n│ • Beat 20: State Stabilization       │    ┌─────────────────────────────────┐\n│ • Beat 21: Signal Damping            │    │ Scenario 9: Stabilize State     │\n│ • Beat 22: Baseline Approach         │    │ Given: Descent phase active     │\n│ • Beat 23: Resolution Point          │    │ When: State stabilization check │\n│                                       │    │ Then: Baseline approached       │\n│                                       │    │                                  │\n│                                       │    │ Scenario 10: Damp Signals       │\n│                                       │    │ Given: Stabilization detected   │\n│                                       │    │ When: Damping phase active     │\n│                                       │    │ Then: Signal amplitude reduced  │\n│                                       │    └─────────────────────────────────┘\n└───────────────────────────────────────┘\n\n┌─ Movement 6: Completion (2 Beats) ──┐    Scenario: 11\n│ • Beat 24: Final Transition          │    ┌─────────────────────────────────┐\n│ • Beat 25: Completion State          │    │ Scenario 11: Complete Sequence  │\n│                                       │    │ Given: Resolution state active   │\n│ [Dynamic Composition Beats 26-30]    │    │ When: Completion phase starts   │\n│ • Beats 26-30: Composed at runtime   │    │ Then: Orchestration completed   │\n│   based on movement feedback         │    │                                  │\n│                                       │    │ Note: Includes dynamic beats     │\n│                                       │    │ (26-30) composed at runtime     │\n│                                       │    └─────────────────────────────────┘\n└───────────────────────────────────────┘\n\nKEY PATTERNS:\n• Movement 1-5 map to dedicated scenarios (1-10)\n• Movement 6 includes both baseline scenarios and dynamic beat handling\n• Each scenario includes orchestration phase context (Given) + event trigger (When) + verification (Then)\n• Total: 11 scenarios fully mapping musical-conductor domain specification\n"
    },
    {
      "id": "diagram-4",
      "name": "Governance Enforcement Chain - Layers 1-9",
      "type": "enforcement_layers",
      "description": "Complete governance enforcement chain showing how BDD documentation flows through 9 validation layers",
      "asciiDiagram": "┌─────────────────────────────────────────────────────────────────────────────────────┐\n│                   GOVERNANCE ENFORCEMENT CHAIN: LAYERS 1-9                           │\n│                  (BDD Documentation & Orchestration Governance)                      │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n\n     INPUT: bdd-pipeline-analysis.json (JSON Authority)\n          ↓\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 1: IDE DETECTION (Real-time, Editor Integration)                             │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Monitors: JSON file format, schema compliance                                     │\n│ • Checks: Valid JSON syntax, required fields present                               │\n│ • Action: Red squiggles on schema violations, hover hints                          │\n│ • Result: Immediate developer feedback                                             │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 2: PRE-COMMIT HOOKS (Local Git Integration)                                  │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: git commit attempt                                                       │\n│ • Checks: JSON structure, no orphaned files, schema validation                      │\n│ • Action: Prevent commit if validation fails                                       │\n│ • Result: Violations caught before pushing                                         │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 3: PRE-BUILD VALIDATION (Local Build)                                        │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: npm run build or npm run prebuild                                       │\n│ • Checks: All manifests loaded, generator scripts exist, paths valid               │\n│ • Action: Fail build if references broken                                         │\n│ • Result: Broken configurations detected locally                                   │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 4: CI BUILD VALIDATION (GitHub Actions / Build Server)                       │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: Push to main branch                                                     │\n│ • Checks: Full build, all tests, orchestration governance check                    │\n│ • Action: Block merge if CI fails                                                  │\n│ • Result: Violations prevented from reaching main                                  │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 5: CI/CD EXECUTION (Automated Pipeline)                                      │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: Green CI build                                                          │\n│ • Checks: npm run pre:manifests (regenerate all auto-generated docs)               │\n│ • Action: Verify generated files match expected outputs                            │\n│ • Result: Generation pipeline validated                                            │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 6: TEST EXECUTION (BDD & Unit Tests)                                         │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: npm run test:bdd                                                        │\n│ • Checks: All 11 musical-conductor scenarios pass, step definitions work           │\n│ • Action: Fail if any BDD scenario broken                                          │\n│ • Result: Functional correctness validated                                         │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 7: AUDIT REVIEW (Manual/Automated Audit)                                     │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: npm run allocate:documents, drift audit scripts                          │\n│ • Checks: Document classification, governance alignment, no manual violations       │\n│ • Action: Generate audit reports, flag orphaned files                              │\n│ • Result: Governance violations detected, remediation guidance provided             │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 8: HASH VALIDATION (Governance Doc Hash Verification)                        │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: verify:orchestration:governance                                         │\n│ • Checks: SHA256(bdd-pipeline-analysis.json) == recorded hash in manifest          │\n│           SHA256(bdd-pipeline-visual-arch.json) == recorded hash                   │\n│ • Action: Detect if JSON source modified without manifest update                   │\n│ • Result: Drift between JSON authority and generated markdown prevented             │\n│                                                                                     │\n│ Hash Strategy Applied:                                                              │\n│   source: docs/governance/bdd-pipeline-analysis.json                               │\n│   hash_strategy: sha256(json_source)                                               │\n│   recorded_hash: [computed at manifest registration time]                          │\n│   verification: npm run verify:orchestration:governance                             │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (if passes)\n┌─────────────────────────────────────────────────────────────────────────────────────┐\n│ LAYER 9: AGENT SELF-GOVERNANCE (Manifest Completeness & Generator Validation)       │\n├─────────────────────────────────────────────────────────────────────────────────────┤\n│ • Trigger: npm run verify:orchestration:governance (final pass)                    │\n│ • Checks:                                                                           │\n│   1. All BDD documentation entries in generated-docs-manifest.json                 │\n│   2. Generator script paths reference valid files                                  │\n│   3. Output markdown files exist and contain AUTO-GENERATED headers                │\n│   4. No generator script failures detected                                         │\n│   5. Manifest validation passes (all entries well-formed)                          │\n│                                                                                     │\n│ • Action: Abort orchestration if any check fails                                   │\n│ • Result: ✓ COMPLIANT (all 9 layers passed)                                        │\n│          or ✗ VIOLATIONS DETECTED (specific layer reported)                        │\n└─────────────────────────────────────────────────────────────────────────────────────┘\n          ↓ (final result)\n     OUTPUT: Auto-generated Markdown Documentation\n            • docs/governance/BDD_PIPELINE_ANALYSIS.md\n            • docs/governance/BDD_PIPELINE_VISUAL_ARCHITECTURE.md\n            • [AUTO-GENERATED headers present]\n            • [Ready for repository]\n\nKEY PROPERTIES:\n• Fail-fast at each layer: Early detection = faster feedback\n• Layered approach: Different violation types caught at different times\n• Layer 8-9 specific to governance docs: Ensures drift-free documentation\n• Hash validation (L8) catches edits that bypass pre-commit (L2)\n• Agent self-governance (L9) verifies generator consistency\n"
    }
  ],
  "integrationPatterns": [
    {
      "id": "pattern-1",
      "name": "Feature Generation from Domain Registry",
      "description": "How BDD feature files are auto-generated from orchestration-domains.json",
      "trigger": "npm run generate:bdd:stubs",
      "input": {
        "file": "orchestration-domains.json",
        "scanning": "Parse all domain entries with sequence references"
      },
      "process": [
        "1. Read orchestration-domains.json registry",
        "2. For each domain with sequenceId reference:",
        "   - Load corresponding sequence JSON",
        "   - Extract movements and beats count",
        "   - Generate baseline scenarios",
        "3. Create packages/{domain}/bdd/{domain}.feature",
        "4. Populate Feature: {domain-name}, Scenario: outline scaffolds"
      ],
      "output": {
        "files": "*.feature files with auto-stub scenarios",
        "format": "Gherkin with Given-When-Then structure",
        "examples": [
          "packages/musical-conductor/bdd/musical-conductor-orchestration.feature",
          "packages/slo-dashboard/bdd/slo-dashboard-orchestration.feature"
        ]
      }
    },
    {
      "id": "pattern-2",
      "name": "Scenario Enrichment via Interactive Wizard",
      "description": "Interactive CLI for enriching baseline scenarios with movement/beat/event mappings",
      "trigger": "npm run interactive:bdd:wizard",
      "input": {
        "files": "*.feature scaffolds",
        "context": "Domain sequence JSON with movement/beat definitions"
      },
      "process": [
        "1. Present menu of available *.feature files",
        "2. For each feature, iterate through scenarios:",
        "   - Display scenario outline (Given-When-Then placeholders)",
        "   - Prompt for Given step details (movement, beat number)",
        "   - Prompt for When step details (event type, phase)",
        "   - Prompt for Then step details (assertions, expected outcomes)",
        "3. Generate enriched steps with actual orchestration context",
        "4. Save back to feature file"
      ],
      "output": {
        "enhancement": "From scaffolds to full Given-When-Then scenarios",
        "context": "Movement references, beat indices, event types",
        "example": "Scenario: Reach Peak → Given: Musical-conductor in Zenith movement → When: Peak activation triggered"
      }
    },
    {
      "id": "pattern-3",
      "name": "Step Definition Implementation Pattern",
      "description": "TypeScript/Cucumber step definition binding to orchestration runtime",
      "file": "packages/orchestration/bdd/step-definitions/orchestration-steps.ts",
      "pattern": [
        "import { Given, When, Then } from '@cucumber/cucumber';",
        "",
        "Given('movement {word} in {word} state', (movementName: string, state: string) => {",
        "  // Arrange: Create orchestrator with movement context",
        "  const orchestrator = new OrchestratorRunner();",
        "  orchestrator.setMovement(movementName);",
        "  orchestrator.setState(state);",
        "});",
        "",
        "When('beat {int} executes', (beatNumber: number) => {",
        "  // Act: Trigger beat execution in orchestrator",
        "  orchestrator.executeBeat(beatNumber);",
        "});",
        "",
        "Then('orchestration event {word} is recorded', (eventType: string) => {",
        "  // Assert: Verify event in telemetry",
        "  const events = orchestrator.getRecordedEvents();",
        "  expect(events).toContainEqual(expect.objectContaining({ type: eventType }));",
        "});"
      ]
    },
    {
      "id": "pattern-4",
      "name": "Governance Documentation Registration",
      "description": "How BDD documentation is registered as governance artifacts",
      "authority_source": "docs/governance/bdd-pipeline-analysis.json",
      "registration_in_manifest": {
        "file": "docs/governance/generated-docs-manifest.json",
        "entry": {
          "id": "bdd-pipeline-analysis-md",
          "source": "docs/governance/bdd-pipeline-analysis.json",
          "output": "docs/governance/BDD_PIPELINE_ANALYSIS.md",
          "generator": "scripts/generate-governance-docs.cjs",
          "hash_strategy": "sha256(json_source)",
          "auto_generated_header": "<!-- GOVERNANCE: AUTO-GENERATED source=bdd-pipeline-analysis.json -->"
        }
      },
      "generation_trigger": "npm run pre:manifests",
      "validation_trigger": "npm run verify:orchestration:governance",
      "enforcement_layers": [
        8,
        9
      ]
    }
  ],
  "keyTechnicalConcepts": [
    {
      "concept": "JSON Authority First",
      "explanation": "All BDD governance specifications originate from JSON (not markdown). Markdown is auto-generated reflection only."
    },
    {
      "concept": "Movement-to-Scenario Mapping",
      "explanation": "Each orchestration movement (6 in musical-conductor) maps to 1-2 BDD scenarios with Given-When-Then steps capturing movement semantics."
    },
    {
      "concept": "Drift-Free Governance",
      "explanation": "SHA256 hashing (Layer 8) ensures JSON sources haven't drifted from auto-generated markdown. Layer 9 validates generator consistency."
    },
    {
      "concept": "Auto-Stub Pattern",
      "explanation": "Most domains (5 of 6) use auto-generated 1-2 baseline scenarios. Musical-conductor uses manual rich pattern (11 scenarios)."
    },
    {
      "concept": "Registry Scanning",
      "explanation": "generate-bdd-feature-stubs.js scans orchestration-domains.json to auto-discover domains and generate corresponding .feature files."
    },
    {
      "concept": "Orchestration Runtime Integration",
      "explanation": "BDD steps execute against actual OrchestratorRunner interfaces, not mock frameworks. Real movement/beat/event execution."
    },
    {
      "concept": "9-Layer Enforcement Chain",
      "explanation": "From IDE (L1) through self-governance (L9), BDD and governance violations caught at progressively stricter validation levels."
    }
  ],
  "id": "bdd-pipeline-visual-architecture",
  "name": "unknown"
}