{
  "name": "Symphonia Auditing System",
  "version": "1.0.0",
  "description": "Comprehensive auditing and conformity system for Symphonia Pipeline artifacts (orchestration domains, contracts, sequences, BDD specs, handler specs)",
  "purpose": "Establish and enforce governance conformity across all orchestration pipeline artifacts",
  "scope": [
    "orchestration-domains.json",
    "contracts/*.contract.json",
    "packages/*/json-sequences/**/*.json",
    "packages/*/bdd/**/*.feature",
    "packages/*/__tests__/**/*.spec.ts"
  ],
  "governance": {
    "framework": "UNIFIED_GOVERNANCE_AUTHORITY",
    "layer": "Layer 5: Conformity & Audit",
    "enforcement": "Automated auditing with governance-driven remediation"
  },
  "auditDimensions": [
    {
      "id": "orchestration-domains",
      "name": "Orchestration Domain Conformity",
      "description": "Validates completeness and consistency of orchestration domain definitions",
      "rules": [
        {
          "id": "domain-id-required",
          "level": "CRITICAL",
          "description": "Every domain must have a unique ID",
          "check": "$.domains[*].id must exist and be unique",
          "remediation": "Auto-generate from domain name if missing"
        },
        {
          "id": "domain-metadata-complete",
          "level": "CRITICAL",
          "description": "Domain must have required metadata fields",
          "check": "Domain must have: id, name, category, description, purpose, status",
          "remediation": "Populate missing fields with defaults or prompt user"
        },
        {
          "id": "domain-movement-structure",
          "level": "MAJOR",
          "description": "Domain movements must have proper beat structure",
          "check": "movements > 0, beats > 0, movements * 5 <= beats (musical tempo)",
          "remediation": "Adjust movements/beats ratio to meet musical constraints"
        },
        {
          "id": "domain-key-signature",
          "level": "MAJOR",
          "description": "Domain must have valid musical key signature",
          "check": "key must be one of: C Major, D Major, E Major, F Major, G Major, A Major, B Major, etc.",
          "remediation": "Set to C Major (standard default)"
        },
        {
          "id": "domain-time-signature",
          "level": "MAJOR",
          "description": "Domain must have valid time signature",
          "check": "timeSignature must match pattern: ^[0-9]+/[0-9]+$",
          "remediation": "Set to 4/4 (standard default)"
        },
        {
          "id": "domain-handler-beats-present",
          "level": "MAJOR",
          "description": "Domain handler items must follow beat pattern",
          "check": "sketch.phases[*].items.length == beats for each movement",
          "remediation": "Align phase item count with beat count"
        },
        {
          "id": "domain-plugin-reference",
          "level": "MAJOR",
          "description": "Plugin domains must reference existing plugin",
          "check": "If category=plugin, pluginId must exist in packages/*/",
          "remediation": "Verify plugin path or update category"
        },
        {
          "id": "domain-sequence-alignment",
          "level": "MAJOR",
          "description": "Domain sequence must exist in json-sequences",
          "check": "If sketch.sequence exists, corresponding JSON sequence file must exist",
          "remediation": "Create corresponding sequence file or remove reference"
        }
      ]
    },
    {
      "id": "contracts",
      "name": "Contract Schema Conformity",
      "description": "Validates event contracts for completeness and consistency",
      "rules": [
        {
          "id": "contract-feature-required",
          "level": "CRITICAL",
          "description": "Contract must have feature identifier",
          "check": "contract.feature must exist",
          "remediation": "Infer from contract filename or prompt user"
        },
        {
          "id": "contract-required-fields",
          "level": "CRITICAL",
          "description": "Contract must define required event fields",
          "check": "contract.required must be non-empty array",
          "remediation": "Populate with standard fields: feature, event, beats, status, shapeHash"
        },
        {
          "id": "contract-hash-strategy",
          "level": "MAJOR",
          "description": "Contract must define hash strategy for validation",
          "check": "contract.hashStrategy must exist and be valid",
          "remediation": "Set to sha256(serializedWithoutMeta)"
        },
        {
          "id": "contract-optional-fields-defined",
          "level": "MAJOR",
          "description": "Contract should document optional fields",
          "check": "contract.optional should be present",
          "remediation": "Add optional array with common fields: durationMs, correlationId, coverageId"
        },
        {
          "id": "contract-version-monotonic",
          "level": "MAJOR",
          "description": "Contract version must be documented",
          "check": "contract.version must be >= 1",
          "remediation": "Initialize version to 1"
        },
        {
          "id": "contract-metadata-timestamp",
          "level": "MINOR",
          "description": "Contract metadata should include creation timestamp",
          "check": "contract.meta.created should exist in ISO format",
          "remediation": "Add current timestamp"
        }
      ]
    },
    {
      "id": "sequences",
      "name": "Sequence Flow Conformity",
      "description": "Validates JSON sequence definitions for structural integrity",
      "rules": [
        {
          "id": "sequence-id-required",
          "level": "CRITICAL",
          "description": "Sequence must have unique identifier",
          "check": "sequence.id must exist and match filename (without .json)",
          "remediation": "Auto-generate or sync with filename"
        },
        {
          "id": "sequence-name-required",
          "level": "CRITICAL",
          "description": "Sequence must have descriptive name",
          "check": "sequence.name must exist and be descriptive (> 3 chars)",
          "remediation": "Generate from ID with titlecase"
        },
        {
          "id": "sequence-beats-positive",
          "level": "CRITICAL",
          "description": "Sequence must have positive beat count",
          "check": "sequence.beats > 0",
          "remediation": "Count actual handler items and set beats"
        },
        {
          "id": "sequence-tempo-valid",
          "level": "MAJOR",
          "description": "Sequence tempo must be within musical range",
          "check": "sequence.tempo >= 60 AND sequence.tempo <= 240",
          "remediation": "Set to 120 (standard tempo)"
        },
        {
          "id": "sequence-movements-structured",
          "level": "MAJOR",
          "description": "Sequence movements must have clear phase names",
          "check": "All phases in sketch.phases must have descriptive names",
          "remediation": "Format as 'Movement N: [Purpose]'"
        },
        {
          "id": "sequence-handler-kinds-classified",
          "level": "MAJOR",
          "description": "Sequence handler items must indicate kind (pure, io, stage-crew, orchestration)",
          "check": "Each item must be suffixed with handler kind marker or include it in metadata",
          "remediation": "Add kind classification to items or separate by phase"
        },
        {
          "id": "sequence-error-scenarios",
          "level": "MAJOR",
          "description": "Sequence should document error handling scenarios",
          "check": "Sequence metadata should mention error scenarios or fallback flows",
          "remediation": "Add error scenarios to metadata or comments"
        }
      ]
    },
    {
      "id": "bdd-specs",
      "name": "BDD Specification Conformity",
      "description": "Validates Gherkin BDD feature files for completeness and testability",
      "rules": [
        {
          "id": "feature-declaration-present",
          "level": "CRITICAL",
          "description": "Feature file must have Feature declaration",
          "check": "First non-comment line must be: Feature: [Feature Name]",
          "remediation": "Add Feature declaration if missing"
        },
        {
          "id": "user-story-present",
          "level": "CRITICAL",
          "description": "Feature must have user story (In order, As a, I want)",
          "check": "Feature section must include complete user story",
          "remediation": "Add standard user story format"
        },
        {
          "id": "background-defined",
          "level": "MAJOR",
          "description": "Feature should define Background setup",
          "check": "Background section should exist with Given steps",
          "remediation": "Add Background section with common setup"
        },
        {
          "id": "scenarios-complete",
          "level": "CRITICAL",
          "description": "Each Scenario must have Given-When-Then structure",
          "check": "All Scenario blocks must have Given/When/Then steps",
          "remediation": "Complete missing Given/When/Then blocks"
        },
        {
          "id": "scenario-data-tables",
          "level": "MAJOR",
          "description": "Scenarios with multiple cases should use data tables",
          "check": "Scenarios with >3 similar steps should use data tables or Scenario Outlines",
          "remediation": "Convert to Scenario Outline with data tables"
        },
        {
          "id": "scenario-count-minimum",
          "level": "MAJOR",
          "description": "Feature should have minimum scenarios for coverage",
          "check": "Feature must have >= 2 scenarios (happy path + alternative)",
          "remediation": "Add additional scenarios for edge cases"
        },
        {
          "id": "step-definitions-testable",
          "level": "MAJOR",
          "description": "All steps must be testable and specific",
          "check": "Steps must be concrete, not abstract (e.g., avoid 'something happens')",
          "remediation": "Replace vague steps with specific business actions"
        },
        {
          "id": "domain-traceability",
          "level": "MAJOR",
          "description": "Feature should trace to orchestration domain",
          "check": "Feature file should be in domain-specific package/bdd/ directory",
          "remediation": "Move to correct domain package/bdd/ location"
        }
      ]
    },
    {
      "id": "handler-specs",
      "name": "Handler Specification Conformity",
      "description": "Validates handler test specs for completeness and implementation readiness",
      "rules": [
        {
          "id": "handler-business-bdd-exists",
          "level": "CRITICAL",
          "description": "Handler must have business BDD test specification",
          "check": "packages/[domain]/__tests__/business-bdd-handlers/[handler].spec.ts must exist",
          "remediation": "Generate business BDD test from handler specification"
        },
        {
          "id": "handler-unit-tests-exist",
          "level": "CRITICAL",
          "description": "Handler must have unit test stubs",
          "check": "packages/[domain]/__tests__/[sequence].[operation].spec.ts must exist",
          "remediation": "Generate unit test stubs with happy path and error scenarios"
        },
        {
          "id": "handler-implementation-exists",
          "level": "CRITICAL",
          "description": "Handler implementation must exist or be marked TODO",
          "check": "packages/[domain]/src/handlers/[sequence]/[operation].ts must exist or be planned",
          "remediation": "Create handler file or document in implementation plan"
        },
        {
          "id": "handler-context-setup",
          "level": "MAJOR",
          "description": "Handler tests must set up proper context and mocks",
          "check": "beforeEach hook must initialize handler, mocks, input, output, error",
          "remediation": "Add standard context setup pattern"
        },
        {
          "id": "handler-happy-path-test",
          "level": "MAJOR",
          "description": "Handler must have happy path test case",
          "check": "At least one test should verify successful handler execution",
          "remediation": "Add happy path test with realistic inputs"
        },
        {
          "id": "handler-error-handling-test",
          "level": "MAJOR",
          "description": "Handler must have error scenario test case",
          "check": "At least one test should verify error handling",
          "remediation": "Add error handling test with exception scenarios"
        },
        {
          "id": "handler-business-value-documented",
          "level": "MAJOR",
          "description": "Handler spec must document business value",
          "check": "Business BDD spec must include 'business value', 'persona', and 'scenarios'",
          "remediation": "Add business context documentation"
        },
        {
          "id": "handler-sequence-traceability",
          "level": "MAJOR",
          "description": "Handler must trace to sequence flow",
          "check": "Handler name and sequence must match orchestration domain definition",
          "remediation": "Verify handler maps to sequence beat position"
        }
      ]
    }
  ],
  "conformityLevels": [
    {
      "level": "CRITICAL",
      "score": 0,
      "impact": "Prevents artifact from functioning in production",
      "action": "MUST be fixed before deployment"
    },
    {
      "level": "MAJOR",
      "score": 25,
      "impact": "Reduces reliability or maintainability",
      "action": "SHOULD be fixed in next sprint"
    },
    {
      "level": "MINOR",
      "score": 50,
      "impact": "Minor quality or documentation issue",
      "action": "CAN be fixed in future maintenance"
    }
  ],
  "auditOutputs": [
    {
      "id": "symphonia-audit-report",
      "name": "Symphony Audit Report",
      "format": "JSON",
      "location": "docs/governance/symphonia-audit-report.json",
      "contents": [
        "conformity_score (0-100)",
        "total_artifacts_scanned",
        "critical_violations",
        "major_violations",
        "minor_violations",
        "recommendations",
        "remediations_suggested"
      ]
    },
    {
      "id": "symphonia-conformity-dashboard",
      "name": "Symphony Conformity Dashboard",
      "format": "Markdown (auto-generated)",
      "location": "docs/governance/SYMPHONIA_CONFORMITY_DASHBOARD.md",
      "contents": [
        "overall_conformity_score",
        "breakdown_by_dimension",
        "critical_issues_table",
        "major_issues_table",
        "remediation_suggestions",
        "trend_analysis"
      ]
    },
    {
      "id": "symphonia-remediation-plan",
      "name": "Symphony Remediation Plan",
      "format": "Markdown (auto-generated)",
      "location": "docs/governance/SYMPHONIA_REMEDIATION_PLAN.md",
      "contents": [
        "prioritized_violations",
        "remediation_steps",
        "owner_assignments",
        "estimated_effort",
        "validation_checklist"
      ]
    }
  ],
  "integrations": {
    "governanceFramework": "UNIFIED_GOVERNANCE_AUTHORITY Layer 5",
    "conformityEngine": "Validates all orchestration artifacts",
    "reportingSystem": "Generates governance compliance reports",
    "enforcementMechanism": "Prevents non-compliant artifacts from deployment"
  },
  "auditSchedule": {
    "frequency": "On every commit to orchestration artifacts",
    "fullAudit": "Nightly (00:00 UTC)",
    "incrementalAudit": "Per-commit validation"
  },
  "successCriteria": [
    "All orchestration domains have conformity score >= 90",
    "All contracts define required fields and hash strategies",
    "All sequences have complete movement structure with beat definitions",
    "All BDD specs have Given-When-Then completeness",
    "All handler specs have business BDD + unit tests + implementation traces"
  ]
}
