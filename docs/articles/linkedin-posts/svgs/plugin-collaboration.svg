<svg xmlns="http://www.w3.org/2000/svg" width="640" height="300" viewBox="0 0 640 300" font-family="'Segoe UI', system-ui" role="img" aria-label="Animated multi-plugin collaboration flow">
  <defs>
    <linearGradient id="gPlugin" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#f5f5f5"/>
      <stop offset="100%" stop-color="#e0f2f1"/>
    </linearGradient>
    <linearGradient id="gEvent" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#bbdefb"/>
      <stop offset="100%" stop-color="#64b5f6"/>
    </linearGradient>
    <filter id="glow"><feGaussianBlur stdDeviation="4" result="c"/><feMerge><feMergeNode in="c"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    <style>
      .plugin { fill:url(#gPlugin); stroke:#616161; stroke-width:2; rx:12; }
      .label { font-size:12px; font-weight:600; fill:#263238; }
      .bus-line { stroke:#90caf9; stroke-width:4; stroke-dasharray:6 6; }
      .event { fill:url(#gEvent); stroke:#1976d2; stroke-width:1.5; rx:8; }
      .user { fill:#ffe082; stroke:#ffa000; stroke-width:2; }
      .arrow { stroke:#1976d2; stroke-width:2; marker-end:url(#a); stroke-dasharray:40 20; }
      .title { font-size:16px; font-weight:700; fill:#1565c0; }
      @media (prefers-color-scheme: dark) { .label { fill:#e3f2fd; } .title { fill:#90caf9; } }
    </style>
    <marker id="a" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="7" markerHeight="7" orient="auto">
      <polygon points="0 0 10 5 0 10" fill="#1976d2"/>
    </marker>
    <path id="pulsePath" d="M100 188 L510 188" fill="none" />
  </defs>
  <rect width="640" height="300" fill="#071720"/>
  <text x="320" y="32" class="title" filter="url(#glow)">Emergent Multi-Plugin Flow</text>
  <line x1="80" y1="200" x2="560" y2="200" class="bus-line">
    <animate attributeName="stroke-dashoffset" values="0;60" dur="6s" repeatCount="indefinite"/>
  </line>

  <!-- Plugins -->
  <g filter="url(#glow)"><rect x="60" y="70" width="110" height="70" class="plugin" /><text x="115" y="110" class="label" text-anchor="middle">library</text></g>
  <g filter="url(#glow)"><rect x="210" y="70" width="110" height="70" class="plugin" /><text x="265" y="110" class="label" text-anchor="middle">canvas</text></g>
  <g filter="url(#glow)"><rect x="360" y="70" width="110" height="70" class="plugin" /><text x="415" y="110" class="label" text-anchor="middle">component</text></g>
  <g filter="url(#glow)"><rect x="510" y="70" width="110" height="70" class="plugin" /><text x="565" y="110" class="label" text-anchor="middle">control</text></g>

  <!-- Events on bus -->
  <g filter="url(#glow)">
    <rect x="100" y="170" width="110" height="36" class="event"/>
    <text x="155" y="193" class="label" text-anchor="middle">drag.start</text>
    <rect x="250" y="170" width="110" height="36" class="event" opacity="0.9">
      <animate attributeName="opacity" values="0.4;0.9;0.4" dur="6s" repeatCount="indefinite"/>
    </rect>
    <text x="305" y="193" class="label" text-anchor="middle">preview</text>
    <rect x="400" y="170" width="110" height="36" class="event" opacity="0.85">
      <animate attributeName="opacity" values="0.4;0.85;0.4" dur="6s" repeatCount="indefinite" begin="1.5s"/>
    </rect>
    <text x="455" y="193" class="label" text-anchor="middle">create</text>
    <rect x="250" y="230" width="110" height="36" class="event" />
    <text x="305" y="253" class="label" text-anchor="middle">component.add</text>
  </g>

  <!-- User -->
  <g filter="url(#glow)">
    <circle cx="40" cy="105" r="24" class="user" />
    <text x="40" y="111" font-size="12" font-weight="600">User</text>
  </g>

  <!-- Arrows (top orchestration line) -->
  <line x1="170" y1="140" x2="210" y2="140" class="arrow">
    <animate attributeName="stroke-dashoffset" values="0;60" dur="3s" repeatCount="indefinite"/>
  </line>
  <line x1="320" y1="140" x2="360" y2="140" class="arrow">
    <animate attributeName="stroke-dashoffset" values="60;0" dur="3s" repeatCount="indefinite"/>
  </line>
  <line x1="470" y1="140" x2="510" y2="140" class="arrow">
    <animate attributeName="stroke-dashoffset" values="0;60" dur="3s" repeatCount="indefinite"/>
  </line>

  <!-- Moving pulse along bus -->
  <circle r="10" fill="#00bcd4" filter="url(#glow)">
    <animateMotion dur="6s" repeatCount="indefinite" rotate="auto">
      <mpath xlink:href="#pulsePath" />
    </animateMotion>
    <animate attributeName="r" values="10;14;10" dur="2s" repeatCount="indefinite"/>
  </circle>

  <desc>Animated diagram showing independent plugins emitting and consuming events along a shared bus producing emergent behavior.</desc>
</svg>
