<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Complete storyboard summary - comic strip style -->
  
  <!-- Background -->
  <rect x="0" y="0" width="1200" height="800" fill="#F8F9FA"/>
  
  <!-- Title -->
  <rect x="50" y="20" width="1100" height="60" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="5"/>
  <text x="600" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1976D2">EventRouter School Bus Journey - Complete Story</text>
  <text x="600" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#424242">From Publisher Origin to Application State</text>
  
  <!-- Scene panels (comic strip style) -->
  
  <!-- Scene 1 Panel -->
  <g id="scene-1-panel" transform="translate(50, 100)">
    <rect x="0" y="0" width="180" height="120" fill="#FFFFFF" stroke="#333" stroke-width="2" rx="5"/>
    <rect x="5" y="5" width="170" height="90" fill="#87CEEB"/>
    
    <!-- Mini depot -->
    <rect x="20" y="60" width="40" height="25" fill="#8B7355" stroke="#6B5535" stroke-width="1"/>
    <polygon points="15,60 40,45 65,60" fill="#654321"/>
    
    <!-- Mini bus leaving -->
    <rect x="80" y="70" width="30" height="10" fill="#FFD700" stroke="#E6C200" stroke-width="1" rx="2"/>
    <circle cx="85" cy="82" r="3" fill="#333"/>
    <circle cx="105" cy="82" r="3" fill="#333"/>
    <circle cx="112" cy="73" r="1" fill="#FFFF00"/>
    
    <!-- Mini road -->
    <rect x="5" y="85" width="170" height="8" fill="#404040"/>
    <rect x="20" y="88" width="10" height="2" fill="#FFFF00"/>
    <rect x="40" y="88" width="10" height="2" fill="#FFFF00"/>
    <rect x="60" y="88" width="10" height="2" fill="#FFFF00"/>
    
    <text x="90" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">Scene 1: Depot</text>
    <text x="90" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#666">publish(topic, payload)</text>
  </g>
  
  <!-- Scene 2 Panel -->
  <g id="scene-2-panel" transform="translate(250, 100)">
    <rect x="0" y="0" width="180" height="120" fill="#FFFFFF" stroke="#333" stroke-width="2" rx="5"/>
    <rect x="5" y="5" width="170" height="90" fill="#87CEEB"/>
    
    <!-- Mini bus -->
    <rect x="40" y="70" width="30" height="10" fill="#FFD700" stroke="#E6C200" stroke-width="1" rx="2"/>
    <circle cx="45" cy="82" r="3" fill="#333"/>
    <circle cx="65" cy="82" r="3" fill="#333"/>
    
    <!-- Traffic light -->
    <rect x="100" y="50" width="8" height="20" fill="#333" rx="2"/>
    <circle cx="104" cy="60" r="2" fill="#FFFF00"/>
    
    <!-- Billboard -->
    <rect x="120" y="55" width="25" height="15" fill="#F0F0F0" stroke="#333" stroke-width="1"/>
    <text x="132" y="62" text-anchor="middle" font-family="Courier, monospace" font-size="4" fill="#000">manifest</text>
    
    <!-- Road -->
    <rect x="5" y="85" width="170" height="8" fill="#404040"/>
    
    <text x="90" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">Scene 2: Rules</text>
    <text x="90" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#666">Manifest + Debounce</text>
  </g>
  
  <!-- Scene 3 Panel -->
  <g id="scene-3-panel" transform="translate(450, 100)">
    <rect x="0" y="0" width="180" height="120" fill="#FFFFFF" stroke="#333" stroke-width="2" rx="5"/>
    <rect x="5" y="5" width="170" height="90" fill="#87CEEB"/>
    
    <!-- Mini bus -->
    <rect x="30" y="70" width="30" height="10" fill="#FFD700" stroke="#E6C200" stroke-width="1" rx="2"/>
    <circle cx="35" cy="82" r="3" fill="#333"/>
    <circle cx="55" cy="82" r="3" fill="#333"/>
    
    <!-- Bus stop -->
    <rect x="100" y="50" width="40" height="20" fill="#E0E7FF" stroke="#3B82F6" stroke-width="1"/>
    <rect x="105" y="65" width="15" height="5" fill="#3B82F6"/>
    <rect x="125" y="65" width="15" height="5" fill="#EF4444"/>
    
    <!-- Replay cache -->
    <rect x="150" y="55" width="15" height="15" fill="#6B7280" stroke="#374151" stroke-width="1"/>
    <text x="157" y="63" text-anchor="middle" font-family="Arial, sans-serif" font-size="4" fill="#10B981">CACHE</text>
    
    <!-- Road -->
    <rect x="5" y="85" width="170" height="8" fill="#404040"/>
    
    <text x="90" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">Scene 3: Subscribers</text>
    <text x="90" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#666">Live + Replay Cache</text>
  </g>
  
  <!-- Scene 4 Panel -->
  <g id="scene-4-panel" transform="translate(650, 100)">
    <rect x="0" y="0" width="180" height="120" fill="#FFFFFF" stroke="#333" stroke-width="2" rx="5"/>
    <rect x="5" y="5" width="170" height="90" fill="#87CEEB"/>
    
    <!-- Mini bus -->
    <rect x="20" y="70" width="30" height="10" fill="#FFD700" stroke="#E6C200" stroke-width="1" rx="2"/>
    <circle cx="25" cy="82" r="3" fill="#333"/>
    <circle cx="45" cy="82" r="3" fill="#333"/>
    
    <!-- Transfer hub -->
    <circle cx="90" cy="75" r="20" fill="#4682B4" stroke="#2F4F4F" stroke-width="1"/>
    <line x1="85" y1="80" x2="95" y2="70" stroke="#FFFFFF" stroke-width="2"/>
    <circle cx="95" cy="70" r="1" fill="#FFFFFF"/>
    
    <!-- Branch buses -->
    <rect x="130" y="50" width="20" height="8" fill="#32CD32" rx="1"/>
    <rect x="130" y="90" width="20" height="8" fill="#FF6347" rx="1"/>
    
    <!-- Road -->
    <rect x="5" y="85" width="170" height="8" fill="#404040"/>
    
    <text x="90" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">Scene 4: Hub</text>
    <text x="90" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#666">Conductor Orchestration</text>
  </g>
  
  <!-- Scene 5 Panel -->
  <g id="scene-5-panel" transform="translate(850, 100)">
    <rect x="0" y="0" width="180" height="120" fill="#FFFFFF" stroke="#333" stroke-width="2" rx="5"/>
    <rect x="5" y="5" width="170" height="90" fill="#87CEEB"/>
    
    <!-- Mini bus -->
    <rect x="60" y="70" width="30" height="10" fill="#FFD700" stroke="#E6C200" stroke-width="1" rx="2"/>
    <circle cx="65" cy="82" r="3" fill="#333"/>
    <circle cx="85" cy="82" r="3" fill="#333"/>
    
    <!-- Street signs -->
    <rect x="20" y="45" width="12" height="8" fill="#FFD700" stroke="#E6C200" stroke-width="1"/>
    <circle cx="26" cy="49" r="2" fill="none" stroke="#DC143C" stroke-width="1"/>
    <line x1="24" y1="47" x2="28" y2="51" stroke="#DC143C" stroke-width="1"/>
    
    <rect x="120" y="45" width="12" height="8" fill="#228B22"/>
    <rect x="140" y="45" width="12" height="8" fill="#4169E1"/>
    
    <!-- Performance lanes -->
    <polygon points="30,88 40,86 40,90 30,92" fill="#FFFF00" opacity="0.7"/>
    <rect x="45" y="87" width="3" height="4" fill="#FFFF00" opacity="0.7"/>
    
    <!-- Road -->
    <rect x="5" y="85" width="170" height="8" fill="#404040"/>
    
    <text x="90" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">Scene 5: Boundaries</text>
    <text x="90" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#666">Rules + Performance</text>
  </g>
  
  <!-- Scene 6 Panel -->
  <g id="scene-6-panel" transform="translate(1050, 100)">
    <rect x="0" y="0" width="130" height="120" fill="#FFFFFF" stroke="#333" stroke-width="2" rx="5"/>
    <rect x="5" y="5" width="120" height="90" fill="#87CEEB"/>
    
    <!-- Parked bus -->
    <rect x="15" y="75" width="25" height="8" fill="#FFD700" stroke="#E6C200" stroke-width="1" rx="2"/>
    <circle cx="20" cy="85" r="2" fill="#333"/>
    <circle cx="35" cy="85" r="2" fill="#333"/>
    
    <!-- School -->
    <rect x="60" y="50" width="50" height="30" fill="#CD853F" stroke="#8B4513" stroke-width="1"/>
    <polygon points="55,50 85,35 115,50" fill="#8B0000"/>
    <rect x="80" y="65" width="10" height="15" fill="#4682B4" rx="5" ry="0"/>
    
    <!-- Flag -->
    <rect x="83" y="30" width="4" height="20" fill="#8B4513"/>
    <rect x="87" y="32" width="8" height="5" fill="#FF0000"/>
    
    <!-- Children -->
    <circle cx="45" cy="80" r="2" fill="#FBBF24"/>
    <rect x="44" y="82" width="2" height="4" fill="#3B82F6"/>
    
    <circle cx="75" cy="82" r="2" fill="#F87171"/>
    <rect x="74" y="84" width="2" height="4" fill="#10B981"/>
    
    <!-- Road ending -->
    <rect x="5" y="85" width="50" height="8" fill="#404040"/>
    <rect x="55" y="85" width="70" height="8" fill="#C0C0C0"/>
    
    <text x="65" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">Scene 6: School</text>
    <text x="65" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#666">Application State</text>
  </g>
  
  <!-- Flow arrows between scenes -->
  <g stroke="#1976D2" stroke-width="3" fill="none" marker-end="url(#arrowhead)">
    <path d="M 230,160 L 250,160"/>
    <path d="M 430,160 L 450,160"/>
    <path d="M 630,160 L 650,160"/>
    <path d="M 830,160 L 850,160"/>
    <path d="M 1030,160 L 1050,160"/>
  </g>
  
  <!-- Overall flow description -->
  <g transform="translate(50, 250)">
    <rect x="0" y="0" width="1100" height="200" fill="#FFFFFF" stroke="#1976D2" stroke-width="2" rx="5"/>
    <rect x="10" y="10" width="1080" height="30" fill="#E3F2FD"/>
    <text x="550" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1976D2">Complete EventRouter Journey</text>
    
    <!-- Flow steps -->
    <g font-family="Arial, sans-serif" font-size="12" fill="#333">
      <text x="30" y="70" font-weight="bold">1. PUBLISHING:</text>
      <text x="30" y="85">Event originates at depot (publisher) and begins journey</text>
      
      <text x="30" y="110" font-weight="bold">2. ROUTING RULES:</text>
      <text x="30" y="125">Manifest defines route; debounce controls burst handling</text>
      
      <text x="30" y="150" font-weight="bold">3. SUBSCRIBERS:</text>
      <text x="30" y="165">Live subscribers receive immediately; late ones get replay cache</text>
      
      <text x="580" y="70" font-weight="bold">4. ORCHESTRATION:</text>
      <text x="580" y="85">Conductor hub sequences events into plugin workflows</text>
      
      <text x="580" y="110" font-weight="bold">5. BOUNDARIES:</text>
      <text x="580" y="125">Safety rules, feature flags, and performance controls</text>
      
      <text x="580" y="150" font-weight="bold">6. FINAL STATE:</text>
      <text x="580" y="165">Events successfully delivered to application state</text>
    </g>
  </g>
  
  <!-- Technical mapping -->
  <g transform="translate(50, 470)">
    <rect x="0" y="0" width="1100" height="150" fill="#F5F5F5" stroke="#666" stroke-width="1" rx="5"/>
    <rect x="10" y="10" width="1080" height="25" fill="#E0E0E0"/>
    <text x="550" y="27" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Technical Mapping</text>
    
    <g font-family="Courier, monospace" font-size="10" fill="#333">
      <text x="30" y="55" font-weight="bold">Bus = EventRouter.publish(topic, payload)</text>
      <text x="30" y="70">Depot = Publisher origin point</text>
      <text x="30" y="85">Route = Manifest-defined event routing</text>
      <text x="30" y="100">Traffic Lights = Performance controls (debounce/throttle)</text>
      <text x="30" y="115">Guardrails = Safety boundaries and validation</text>
      <text x="30" y="130">Street Signs = Feature flags and diagnostics</text>
      
      <text x="580" y="55" font-weight="bold">Bus Stops = Subscriber registration points</text>
      <text x="580" y="70">Replay Cache = Late subscriber hydration</text>
      <text x="580" y="85">Transfer Hub = Conductor orchestration</text>
      <text x="580" y="100">Plugin Buses = Sequence execution</text>
      <text x="580" y="115">School = Final application state</text>
      <text x="580" y="130">Children = Successfully delivered events</text>
    </g>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1976D2"/>
    </marker>
  </defs>
</svg>
