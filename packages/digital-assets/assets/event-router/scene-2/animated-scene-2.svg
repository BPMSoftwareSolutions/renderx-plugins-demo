<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
  <!-- Scene 2: Bus encountering first rules of the road with animations -->
  
  <!-- Background sky -->
  <rect x="0" y="0" width="800" height="250" fill="#87CEEB"></rect>
  
  <!-- Clouds -->
  <g fill="#FFFFFF" opacity="0.8">
    <circle cx="120" cy="50" r="18"></circle>
    <circle cx="140" cy="50" r="12"></circle>
    <circle cx="105" cy="55" r="10"></circle>
    
    <circle cx="650" cy="70" r="22"></circle>
    <circle cx="675" cy="70" r="16"></circle>
    <circle cx="630" cy="75" r="12"></circle>
    
    <circle cx="400" cy="40" r="15"></circle>
    <circle cx="415" cy="40" r="10"></circle>
    <circle cx="390" cy="45" r="8"></circle>
  </g>
  
  <!-- Ground -->
  <rect x="0" y="250" width="800" height="150" fill="#4A6B3A"></rect>
  
  <!-- Road -->
  <rect x="0" y="280" width="800" height="60" fill="#404040"></rect>
  <rect x="0" y="278" width="800" height="2" fill="#606060"></rect>
  <rect x="0" y="340" width="800" height="2" fill="#606060"></rect>
  
  <!-- Guardrails -->
  <rect x="0" y="265" width="800" height="8" fill="#E0E0E0" stroke="#C0C0C0" stroke-width="1"></rect>
  <rect x="0" y="345" width="800" height="8" fill="#E0E0E0" stroke="#C0C0C0" stroke-width="1"></rect>
  
  <!-- Guardrail posts -->
  <g fill="#C0C0C0">
    <rect x="50" y="260" width="4" height="18"></rect>
    <rect x="150" y="260" width="4" height="18"></rect>
    <rect x="250" y="260" width="4" height="18"></rect>
    <rect x="350" y="260" width="4" height="18"></rect>
    <rect x="450" y="260" width="4" height="18"></rect>
    <rect x="550" y="260" width="4" height="18"></rect>
    <rect x="650" y="260" width="4" height="18"></rect>
    <rect x="750" y="260" width="4" height="18"></rect>
    
    <rect x="50" y="345" width="4" height="18"></rect>
    <rect x="150" y="345" width="4" height="18"></rect>
    <rect x="250" y="345" width="4" height="18"></rect>
    <rect x="350" y="345" width="4" height="18"></rect>
    <rect x="450" y="345" width="4" height="18"></rect>
    <rect x="550" y="345" width="4" height="18"></rect>
    <rect x="650" y="345" width="4" height="18"></rect>
    <rect x="750" y="345" width="4" height="18"></rect>
  </g>
  
  <!-- Dashed center line -->
  <g fill="#FFFF00">
    <rect x="50" y="308" width="40" height="4"></rect>
    <rect x="120" y="308" width="40" height="4"></rect>
    <rect x="190" y="308" width="40" height="4"></rect>
    <rect x="260" y="308" width="40" height="4"></rect>
    <rect x="330" y="308" width="40" height="4"></rect>
    <rect x="400" y="308" width="40" height="4"></rect>
    <rect x="470" y="308" width="40" height="4"></rect>
    <rect x="540" y="308" width="40" height="4"></rect>
    <rect x="610" y="308" width="40" height="4"></rect>
    <rect x="680" y="308" width="40" height="4"></rect>
  </g>
  
  <!-- School bus with stop-and-go animation -->
  <g id="school-bus" transform="translate(200, 250)">
    <!-- Bus movement: approach, stop at red light, continue on green -->
    <animateTransform attributeName="transform" type="translate" 
                      values="50,250; 350,250; 350,250; 900,250" 
                      dur="12s" 
                      repeatCount="indefinite"/>
    
    <rect x="0" y="0" width="100" height="35" rx="4" ry="4" fill="#FFD700" stroke="#E6C200" stroke-width="2"></rect>
    <rect x="95" y="3" width="10" height="29" rx="5" ry="5" fill="#FFD700" stroke="#E6C200" stroke-width="2"></rect>
    <rect x="-2" y="-3" width="104" height="5" rx="2.5" ry="2.5" fill="#FFA500"></rect>
    
    <!-- Windows -->
    <rect x="90" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="82" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="74" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="66" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="58" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="50" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="42" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="34" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="26" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="18" y="6" width="7" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    
    <rect x="97" y="6" width="6" height="10" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <rect x="12" y="8" width="5" height="6" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    
    <!-- Door and details -->
    <rect x="80" y="20" width="10" height="13" rx="1" ry="1" fill="#E6C200" stroke="#D4AF37" stroke-width="1"></rect>
    <rect x="82" y="22" width="6" height="6" rx="1" ry="1" fill="#2F4F4F" opacity="0.8"></rect>
    <circle cx="84" cy="30" r="0.8" fill="#000"></circle>
    
    <text x="50" y="24" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" font-weight="bold" fill="#000">SCHOOL BUS</text>
    <rect x="0" y="18" width="100" height="3" fill="#FFA500"></rect>
    
    <!-- Headlight -->
    <circle cx="101" cy="12" r="2.5" fill="#FFFF00">
      <animate attributeName="opacity" values="0.8;1;0.8" dur="2s" repeatCount="indefinite"></animate>
    </circle>
    
    <!-- Wheels with spinning animation -->
    <g id="front-wheel">
      <circle cx="20" cy="37" r="6" fill="#333" stroke="#222" stroke-width="1"></circle>
      <circle cx="20" cy="37" r="3" fill="#666"></circle>
      <g transform-origin="20 37">
        <line x1="20" y1="32" x2="20" y2="42" stroke="#AAA" stroke-width="1"></line>
        <line x1="15" y1="37" x2="25" y2="37" stroke="#AAA" stroke-width="1"></line>
        <animateTransform attributeName="transform" type="rotate" values="0;360" dur="1s" repeatCount="indefinite"/>
      </g>
    </g>
    
    <g id="rear-wheel">
      <circle cx="80" cy="37" r="6" fill="#333" stroke="#222" stroke-width="1"></circle>
      <circle cx="80" cy="37" r="3" fill="#666"></circle>
      <g transform-origin="80 37">
        <line x1="80" y1="32" x2="80" y2="42" stroke="#AAA" stroke-width="1"></line>
        <line x1="75" y1="37" x2="85" y2="37" stroke="#AAA" stroke-width="1"></line>
        <animateTransform attributeName="transform" type="rotate" values="0;360" dur="1s" repeatCount="indefinite"/>
      </g>
    </g>
  </g>
  
  <!-- Traffic light with red-yellow-green sequence -->
  <g id="traffic-light" transform="translate(450, 180)">
    <!-- Pole -->
    <rect x="18" y="70" width="4" height="80" fill="#666" stroke="#444" stroke-width="1"></rect>
    
    <!-- Housing -->
    <rect x="5" y="10" width="30" height="70" rx="5" ry="5" fill="#333" stroke="#222" stroke-width="2"></rect>
    <rect x="7" y="12" width="26" height="66" rx="3" ry="3" fill="#444"></rect>
    
    <!-- Light housings -->
    <circle cx="20" cy="25" r="8" fill="#222" stroke="#111" stroke-width="1"></circle>
    <circle cx="20" cy="40" r="8" fill="#222" stroke="#111" stroke-width="1"></circle>
    <circle cx="20" cy="55" r="8" fill="#222" stroke="#111" stroke-width="1"></circle>
    
    <!-- Red light (on during bus stop phase) -->
    <circle cx="20" cy="25" r="6" fill="#FF0000">
      <animate attributeName="opacity" values="1;1;1;0.3;0.3" dur="12s" repeatCount="indefinite"></animate>
    </circle>
    
    <!-- Yellow light (debounce transition) -->
    <circle cx="20" cy="40" r="6" fill="#FFFF00">
      <animate attributeName="opacity" values="0.3;0.3;1;1;0.3" dur="12s" repeatCount="indefinite"></animate>
    </circle>
    <circle cx="17" cy="37" r="2" fill="#FFFFFF" opacity="0.6">
      <animate attributeName="opacity" values="0.2;0.2;0.8;0.8;0.2" dur="12s" repeatCount="indefinite"></animate>
    </circle>
    
    <!-- Green light (on when bus continues) -->
    <circle cx="20" cy="55" r="6" fill="#00FF00">
      <animate attributeName="opacity" values="0.3;0.3;0.3;1;1" dur="12s" repeatCount="indefinite"></animate>
    </circle>
  </g>
  
  <!-- Billboard with manifest -->
  <g id="billboard" transform="translate(500, 120)">
    <!-- Billboard structure -->
    <rect x="0" y="0" width="120" height="80" fill="#F0F0F0" stroke="#333" stroke-width="2" rx="3"></rect>
    <rect x="2" y="2" width="116" height="76" fill="#FFFFFF" stroke="#DDD" stroke-width="1" rx="2"></rect>
    
    <!-- Support posts -->
    <rect x="10" y="75" width="6" height="40" fill="#8B4513"></rect>
    <rect x="104" y="75" width="6" height="40" fill="#8B4513"></rect>
    
    <!-- Manifest content -->
    <text x="60" y="15" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">MANIFEST</text>
    
    <text x="10" y="30" font-family="Courier, monospace" font-size="8" fill="#000">{</text>
    <text x="15" y="42" font-family="Courier, monospace" font-size="8" fill="#000">"topic": "bus.route",</text>
    <text x="15" y="54" font-family="Courier, monospace" font-size="8" fill="#000">"routes": ["school"],</text>
    <text x="15" y="66" font-family="Courier, monospace" font-size="8" fill="#000">"perf.debounceMs": 500</text>
    <text x="10" y="78" font-family="Courier, monospace" font-size="8" fill="#000">}</text>
  </g>
  
  <!-- Street sign with diagnostics -->
  <g id="street-sign" transform="translate(650, 200)">
    <!-- Sign post -->
    <rect x="18" y="40" width="4" height="60" fill="#666"></rect>
    
    <!-- Sign -->
    <rect x="0" y="0" width="40" height="25" fill="#228B22" stroke="#006400" stroke-width="2" rx="2"></rect>
    <rect x="2" y="2" width="36" height="21" fill="#32CD32" stroke="#228B22" stroke-width="1" rx="1"></rect>
    
    <!-- Sign text -->
    <text x="20" y="10" text-anchor="middle" font-family="Courier, monospace" font-size="6" font-weight="bold" fill="#FFFFFF">Logs â–¶</text>
    <text x="20" y="18" text-anchor="middle" font-family="Courier, monospace" font-size="5" fill="#FFFFFF">routing_to...</text>
  </g>
  
  <!-- Caption -->
  <g id="caption" transform="translate(400, 370)">
    <rect x="-180" y="-10" width="360" height="25" fill="#FFFFFF" fill-opacity="0.9" stroke="#333" stroke-width="1" rx="5"></rect>
    <text x="0" y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#333">Manifest plans route; yellow light settles bursts (debounce)</text>
  </g>
</svg>
