{
  "scene": {
    "id": "event-router-scene-4-conductor",
    "canvas": {
      "width": 800,
      "height": 400
    },
    "bg": "#87CEEB",
    "defs": {
      "filters": [
        "<filter id=\"sceneShadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\"><feDropShadow dx=\"0\" dy=\"4\" stdDeviation=\"8\" flood-color=\"#000\" flood-opacity=\"0.25\"/></filter>",
        "<filter id=\"conductorGlow\"><feGaussianBlur stdDeviation=\"3\" result=\"b\"/><feMerge><feMergeNode in=\"b\"/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>"
      ],
      "gradients": [
        "<linearGradient id=\"roadGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\"><stop offset=\"0\" stop-color=\"#404040\"/><stop offset=\"0.5\" stop-color=\"#505050\"/><stop offset=\"1\" stop-color=\"#404040\"/></linearGradient>",
        "<linearGradient id=\"hubGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\"><stop offset=\"0\" stop-color=\"#4682B4\"/><stop offset=\"1\" stop-color=\"#2F4F4F\"/></linearGradient>",
        "<linearGradient id=\"conductorGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\"><stop offset=\"0\" stop-color=\"#6B4EFF\"/><stop offset=\"1\" stop-color=\"#4A3ACD\"/></linearGradient>"
      ]
    },
    "nodes": [
      {
        "kind": "boundary",
        "id": "scene-4-boundary",
        "title": "Scene 4: Conductor Hub (Transfer & Orchestration)",
        "at": {
          "x": 20,
          "y": 20
        },
        "size": {
          "width": 760,
          "height": 360
        },
        "style": {
          "fill": "#F3E5F5",
          "stroke": "#9C27B0",
          "strokeWidth": 2,
          "labelColor": "#9C27B0",
          "filter": "url(#sceneShadow)"
        },
        "grid": {
          "cols": 4,
          "rowH": 80,
          "gutter": 20,
          "padding": 20
        },
        "policy": {
          "mode": "strict",
          "overflow": "clip",
          "tolerance": 2,
          "snap": {
            "grid": 4
          }
        },
        "children": [
          {
            "kind": "shape",
            "id": "sky-background",
            "at": {
              "x": 0,
              "y": 0
            },
            "size": {
              "width": 760,
              "height": 200
            },
            "shape": "rect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "none"
            },
            "_absRect": {
              "x": 20,
              "y": 20,
              "w": 760,
              "h": 200
            }
          },
          {
            "kind": "shape",
            "id": "ground",
            "at": {
              "x": 0,
              "y": 200
            },
            "size": {
              "width": 760,
              "height": 120
            },
            "shape": "rect",
            "style": {
              "fill": "#4A6B3A",
              "stroke": "none"
            },
            "_absRect": {
              "x": 20,
              "y": 220,
              "w": 760,
              "h": 120
            }
          },
          {
            "kind": "shape",
            "id": "main-road",
            "at": {
              "x": 0,
              "y": 230
            },
            "size": {
              "width": 400,
              "height": 60
            },
            "shape": "rect",
            "style": {
              "fill": "url(#roadGradient)",
              "stroke": "#606060",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 20,
              "y": 252,
              "w": 400,
              "h": 60
            }
          },
          {
            "kind": "shape",
            "id": "continuation-road",
            "at": {
              "x": 500,
              "y": 230
            },
            "size": {
              "width": 260,
              "height": 60
            },
            "shape": "rect",
            "style": {
              "fill": "url(#roadGradient)",
              "stroke": "#606060",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 520,
              "y": 252,
              "w": 260,
              "h": 60
            }
          },
          {
            "kind": "shape",
            "id": "upper-branch",
            "at": {
              "x": 450,
              "y": 180
            },
            "size": {
              "width": 100,
              "height": 30
            },
            "shape": "polygon",
            "style": {
              "fill": "#404040",
              "stroke": "#606060",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 472,
              "y": 200,
              "w": 100,
              "h": 30
            }
          },
          {
            "kind": "shape",
            "id": "lower-branch",
            "at": {
              "x": 450,
              "y": 310
            },
            "size": {
              "width": 100,
              "height": 30
            },
            "shape": "polygon",
            "style": {
              "fill": "#404040",
              "stroke": "#606060",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 472,
              "y": 332,
              "w": 100,
              "h": 30
            }
          },
          {
            "kind": "shape",
            "id": "transfer-hub",
            "at": {
              "x": 400,
              "y": 210
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "shape": "circle",
            "style": {
              "fill": "url(#hubGradient)",
              "stroke": "#2F4F4F",
              "strokeWidth": 3
            },
            "_absRect": {
              "x": 420,
              "y": 232,
              "w": 100,
              "h": 100
            }
          },
          {
            "kind": "shape",
            "id": "conductor-center",
            "at": {
              "x": 425,
              "y": 235
            },
            "size": {
              "width": 50,
              "height": 50
            },
            "shape": "circle",
            "style": {
              "fill": "url(#conductorGradient)",
              "stroke": "#4A3ACD",
              "strokeWidth": 2,
              "filter": "url(#conductorGlow)"
            },
            "_absRect": {
              "x": 444,
              "y": 256,
              "w": 50,
              "h": 50
            }
          },
          {
            "kind": "text",
            "id": "conductor-label",
            "at": {
              "x": 450,
              "y": 275
            },
            "text": "Conductor: play()",
            "style": {
              "fill": "#FFFFFF",
              "fontSize": 10,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 472,
              "y": 296,
              "w": 136,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "plugin-a-bus",
            "at": {
              "x": 520,
              "y": 160
            },
            "size": {
              "width": 80,
              "height": 30
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#32CD32",
              "stroke": "#228B22",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 540,
              "y": 180,
              "w": 80,
              "h": 30
            }
          },
          {
            "kind": "text",
            "id": "plugin-a-label",
            "at": {
              "x": 560,
              "y": 175
            },
            "text": "PLUGIN A",
            "style": {
              "fill": "#FFFFFF",
              "fontSize": 8,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 580,
              "y": 196,
              "w": 64,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "plugin-b-bus",
            "at": {
              "x": 520,
              "y": 320
            },
            "size": {
              "width": 80,
              "height": 30
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#FF6347",
              "stroke": "#DC143C",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 540,
              "y": 340,
              "w": 80,
              "h": 30
            }
          },
          {
            "kind": "text",
            "id": "plugin-b-label",
            "at": {
              "x": 560,
              "y": 335
            },
            "text": "PLUGIN B",
            "style": {
              "fill": "#FFFFFF",
              "fontSize": 8,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 580,
              "y": 356,
              "w": 64,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "school-bus",
            "at": {
              "x": 300,
              "y": 200
            },
            "size": {
              "width": 120,
              "height": 40
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#FFD700",
              "stroke": "#E6C200",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 320,
              "y": 220,
              "w": 120,
              "h": 40
            }
          },
          {
            "kind": "text",
            "id": "bus-label",
            "at": {
              "x": 360,
              "y": 215
            },
            "text": "SCHOOL BUS",
            "style": {
              "fill": "#000000",
              "fontSize": 8,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 380,
              "y": 236,
              "w": 80,
              "h": 16
            }
          },
          {
            "kind": "text",
            "id": "sky-headline",
            "at": {
              "x": 380,
              "y": 40
            },
            "text": "The Conductor orchestrates the flow.",
            "style": {
              "fill": "#1E3A56",
              "fontSize": 24,
              "fontWeight": "bold",
              "textAnchor": "middle",
              "stroke": "#FFFFFF",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 400,
              "y": 60,
              "w": 288,
              "h": 16
            }
          },
          {
            "kind": "text",
            "id": "sky-description",
            "at": {
              "x": 380,
              "y": 65
            },
            "text": "At the hub, events branch into sequences and plugins.",
            "style": {
              "fill": "#3C556E",
              "fontSize": 16,
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 356,
              "y": 84,
              "w": 424,
              "h": 16
            }
          },
          {
            "kind": "text",
            "id": "scene-caption",
            "at": {
              "x": 380,
              "y": 320
            },
            "text": "Special hub: topics route into sequences via Conductor (plugins)",
            "style": {
              "fill": "#9C27B0",
              "fontSize": 14,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 268,
              "y": 340,
              "w": 512,
              "h": 16
            }
          }
        ],
        "_absRect": {
          "x": 20,
          "y": 20,
          "w": 760,
          "h": 360
        }
      }
    ],
    "ports": [
      {
        "id": "conductor-in",
        "nodeId": "scene-4-boundary",
        "side": "left",
        "offset": 180
      },
      {
        "id": "plugin-a-out",
        "nodeId": "scene-4-boundary",
        "side": "top",
        "offset": 520
      },
      {
        "id": "plugin-b-out",
        "nodeId": "scene-4-boundary",
        "side": "bottom",
        "offset": 520
      },
      {
        "id": "conductor-out",
        "nodeId": "scene-4-boundary",
        "side": "right",
        "offset": 180
      }
    ],
    "flows": [
      {
        "id": "conductor-orchestration-flow",
        "path": "conductor-in -> plugin-a-out",
        "token": {
          "size": 6,
          "color": "#6B4EFF",
          "trail": {
            "length": 100,
            "opacity": 0.4
          }
        },
        "speed": 85,
        "loop": true,
        "activate": {
          "boundaryIds": [
            "scene-4-boundary"
          ],
          "className": "active-scene"
        }
      },
      {
        "id": "conductor-branch-flow",
        "path": "conductor-in -> plugin-b-out",
        "token": {
          "size": 6,
          "color": "#6B4EFF",
          "trail": {
            "length": 100,
            "opacity": 0.4
          }
        },
        "speed": 85,
        "loop": true,
        "delay": 2000
      },
      {
        "id": "conductor-main-flow",
        "path": "conductor-in -> conductor-out",
        "token": {
          "size": 6,
          "color": "#6B4EFF",
          "trail": {
            "length": 100,
            "opacity": 0.4
          }
        },
        "speed": 85,
        "loop": true,
        "delay": 1000
      }
    ]
  },
  "diagnostics": [
    {
      "code": "OUT_OF_BOUNDS",
      "nodeId": "sky-description",
      "boundaryId": "scene-4-boundary",
      "severity": "error",
      "message": "Node 'sky-description' escapes boundary 'scene-4-boundary'.",
      "actual": {
        "rect": {
          "x": 400,
          "y": 84,
          "w": 424,
          "h": 16
        },
        "boundary": {
          "x": 20,
          "y": 20,
          "w": 760,
          "h": 360
        }
      },
      "suggestedFix": {
        "at": {
          "x": 356,
          "y": 84
        }
      }
    },
    {
      "code": "OUT_OF_BOUNDS",
      "nodeId": "scene-caption",
      "boundaryId": "scene-4-boundary",
      "severity": "error",
      "message": "Node 'scene-caption' escapes boundary 'scene-4-boundary'.",
      "actual": {
        "rect": {
          "x": 400,
          "y": 340,
          "w": 512,
          "h": 16
        },
        "boundary": {
          "x": 20,
          "y": 20,
          "w": 760,
          "h": 360
        }
      },
      "suggestedFix": {
        "at": {
          "x": 268,
          "y": 340
        }
      }
    }
  ],
  "summary": {
    "errors": 2,
    "warnings": 0
  }
}