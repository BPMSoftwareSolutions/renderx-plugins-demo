{
  "id": "symphonic-code-analysis-pipeline",
  "sequenceId": "symphonic-code-analysis-pipeline",
  "name": "Symphonic Code Analysis Pipeline",
  "packageName": "orchestration",
  "title": "Symphonic Code Analysis Pipeline - Orchestration Code Metrics & Coverage",
  "description": "Multi-movement orchestration for comprehensive code analysis of symphonic orchestration codebases, measuring code metrics per beat, test coverage, complexity, and architectural conformity.",
  "kind": "orchestration",
  "status": "active",
  "category": "analysis-pipeline",
  "purpose": "Provide comprehensive, per-beat code metrics, test coverage, and architecture conformity reporting across all orchestration domains without suppressing or masking missing data.",
  "metadata": {
    "version": "1.0.0",
    "relatedDomains": [
      "build-pipeline-symphony",
      "orchestration-core",
      "renderx-web-orchestration",
      "graphing-orchestration",
      "symphonia-conformity-alignment-pipeline",
      "safe-continuous-delivery-pipeline"
    ]
  },
  "beats": 16,
  "movements": [
    {
      "name": "Code Discovery & Beat Mapping",
      "description": "Discover all source files, map them to orchestration beats, and collect baseline metrics",
      "beats": [
        {
          "name": "scan-orchestration-files",
          "description": "Scan JSON sequences and identify beat definitions, handlers, and event mappings",
          "handler": {
            "name": "analysis.discovery#scanOrchestrationFiles"
          }
        },
        {
          "name": "discover-source-code",
          "description": "Discover all TypeScript/JavaScript implementation files matching beat handlers",
          "handler": {
            "name": "analysis.discovery#discoverSourceCode"
          }
        },
        {
          "name": "map-beats-to-code",
          "description": "Create beat-to-handler-to-source-file mapping for correlation",
          "handler": {
            "name": "analysis.discovery#mapBeatsToCode"
          }
        },
        {
          "name": "collect-baseline",
          "description": "Establish baseline metrics for comparison and trend analysis",
          "handler": {
            "name": "analysis.discovery#collectBaseline"
          }
        }
      ]
    },
    {
      "name": "Code Metrics Analysis",
      "description": "Calculate LOC, complexity, duplication, and maintainability metrics per beat and movement",
      "beats": [
        {
          "name": "count-lines-of-code",
          "description": "Calculate LOC per beat, per movement, and per orchestration domain",
          "handler": {
            "name": "analysis.metrics#countLinesOfCode"
          }
        },
        {
          "name": "analyze-complexity",
          "description": "Calculate cyclomatic complexity, cognitive complexity per beat handler",
          "handler": {
            "name": "analysis.metrics#analyzeComplexity"
          }
        },
        {
          "name": "detect-duplication",
          "description": "Identify code duplication patterns and calculate duplication percentage",
          "handler": {
            "name": "analysis.metrics#detectDuplication"
          }
        },
        {
          "name": "calculate-maintainability",
          "description": "Compute maintainability index and technical debt score per module",
          "handler": {
            "name": "analysis.metrics#calculateMaintainability"
          }
        }
      ]
    },
    {
      "name": "Test Coverage Analysis",
      "description": "Measure statement, branch, function, and line coverage with mapping to beats",
      "beats": [
        {
          "name": "measure-statement-coverage",
          "description": "Identify test files and calculate statement coverage with beat correlation",
          "handler": {
            "name": "analysis.coverage#measureStatementCoverage"
          }
        },
        {
          "name": "measure-branch-coverage",
          "description": "Calculate branch coverage (if/else, switch paths) per beat",
          "handler": {
            "name": "analysis.coverage#measureBranchCoverage"
          }
        },
        {
          "name": "measure-function-coverage",
          "description": "Calculate function call coverage and handler execution coverage",
          "handler": {
            "name": "analysis.coverage#measureFunctionCoverage"
          }
        },
        {
          "name": "calculate-gap-analysis",
          "description": "Identify uncovered code and test gaps aligned with beats",
          "handler": {
            "name": "analysis.coverage#calculateGapAnalysis"
          }
        }
      ]
    },
    {
      "name": "Architecture Conformity & Reporting",
      "description": "Validate handler-to-beat mapping, calculate conformity score, generate reports and trends",
      "beats": [
        {
          "name": "validate-handler-mapping",
          "description": "Verify all beats have handlers and handlers have corresponding implementation",
          "handler": {
            "name": "analysis.conformity#validateHandlerMapping"
          }
        },
        {
          "name": "calculate-conformity-score",
          "description": "Synthesize all metrics into orchestration conformity and fractal architecture score (0-1)",
          "handler": {
            "name": "analysis.conformity#calculateConformityScore"
          }
        },
        {
          "name": "generate-trend-report",
          "description": "Compare current metrics to historical baselines and project trends",
          "handler": {
            "name": "analysis.conformity#generateTrendReport"
          }
        },
        {
          "name": "generate-analysis-report",
          "description": "Produce final markdown report with all metrics, diagrams, and recommendations",
          "handler": {
            "name": "analysis.conformity#generateAnalysisReport"
          }
        }
      ]
    }
  ]
  ,
  "analysisMetrics": {
    "codeMetrics": {
      "linesOfCode": {
        "description": "Total and per-scope LOC across beats and movements",
        "benchmark": "Track trend vs. baseline; no hard threshold",
        "aggregation": "sum, perBeat, perMovement, perDomain",
        "visualization": "bar-chart"
      },
      "complexity": {
        "description": "Cyclomatic and cognitive complexity per handler",
        "benchmark": "Average cyclomatic < 10; cognitive < 8",
        "aggregation": "average, perBeat",
        "visualization": "line-chart"
      },
      "duplication": {
        "description": "Percentage of duplicated code",
        "benchmark": "< 5%",
        "aggregation": "percentage",
        "visualization": "gauge"
      },
      "maintainability": {
        "description": "Maintainability index per module",
        "benchmark": ">= 80 (green)",
        "aggregation": "perModule",
        "visualization": "scatter"
      }
    },
    "testCoverage": {
      "statement": {
        "description": "Statement coverage across handlers",
        "benchmark": ">= 85%",
        "perBeat": true
      },
      "branch": {
        "description": "Branch coverage (decision points)",
        "benchmark": ">= 80%",
        "perBeat": true
      },
      "function": {
        "description": "Function coverage and handler execution",
        "benchmark": ">= 90%",
        "perBeat": true
      },
      "line": {
        "description": "Line coverage",
        "benchmark": ">= 85%",
        "perBeat": true
      }
    },
    "conformityMetrics": {
      "handlerCompleteness": {
        "description": "All beats mapped to implemented handlers",
        "benchmark": "100%",
        "impact": "high"
      },
      "testCoverageConformity": {
        "description": "Coverage meets minimum benchmarks",
        "benchmark": ">= 0.85 overall",
        "impact": "medium"
      },
      "fractalArchitecture": {
        "description": "Fractal architecture alignment across orchestration domains and sequences",
        "benchmark": ">= 0.85",
        "impact": "high"
      },
      "architectureConformity": {
        "description": "Alignment with orchestration and fractal architecture",
        "benchmark": ">= 0.85",
        "impact": "high"
      },
      "overallScore": {
        "description": "Composite score of all metrics",
        "benchmark": ">= 0.85",
        "impact": "critical"
      }
    }
  },
  "reportingArtifacts": [
    {
      "name": "Beat Metrics Report",
      "type": "markdown",
      "description": "Per-beat LOC, complexity, and coverage",
      "purpose": "Enable targeted improvements",
      "generated": true
    },
    {
      "name": "Domain Analysis JSON",
      "type": "json",
      "description": "Machine-readable analysis for automation",
      "purpose": "CI validation and trend tracking",
      "generated": true
    },
    {
      "name": "Trend Comparison",
      "type": "markdown",
      "description": "Baseline vs. current deltas",
      "purpose": "Reveal regressions and improvements",
      "generated": true
    }
  ],
  "governance": {
    "policies": [
      "No masking of missing data",
      "Publish all analysis artifacts",
      "Require handler-to-beat mapping",
      "Validate coverage thresholds"
    ]
  },
  "implementation": {
    "bindings": [
      { "beat": 1, "handler": "analysis.discovery#scanOrchestrationFiles", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 2, "handler": "analysis.discovery#discoverSourceCode", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 3, "handler": "analysis.discovery#mapBeatsToCode", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 4, "handler": "analysis.discovery#collectBaseline", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 5, "handler": "analysis.metrics#countLinesOfCode", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 6, "handler": "analysis.metrics#analyzeComplexity", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 7, "handler": "analysis.metrics#detectDuplication", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 8, "handler": "analysis.metrics#calculateMaintainability", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 9, "handler": "analysis.coverage#measureStatementCoverage", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 10, "handler": "analysis.coverage#measureBranchCoverage", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 11, "handler": "analysis.coverage#measureFunctionCoverage", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 12, "handler": "analysis.coverage#calculateGapAnalysis", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 13, "handler": "analysis.conformity#validateHandlerMapping", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 14, "handler": "analysis.conformity#calculateConformityScore", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 15, "handler": "analysis.conformity#generateTrendReport", "script": "scripts/analyze-symphonic-code.cjs" },
      { "beat": 16, "handler": "analysis.conformity#generateAnalysisReport", "script": "scripts/analyze-symphonic-code.cjs" }
    ]
  },
  "events": [
    "analysis.discovery.started",
    "analysis.discovery.completed",
    "analysis.metrics.completed",
    "analysis.coverage.completed",
    "analysis.conformity.completed",
    "analysis.reporting.completed",
    "movement-4:fractal-architecture-analyzed"
  ]
  ,
  "beatDetails": [
    { "movement": 4, "number": 1, "name": "validate-handler-mapping", "description": "Validate handler-to-beat mapping across orchestration domains" },
    { "movement": 4, "number": 2, "name": "fractal-architecture-evaluation", "description": "Evaluate fractal architecture alignment and compute conformity scores" },
    { "movement": 4, "number": 3, "name": "generate-trend-report", "description": "Generate trend report comparing current metrics to baseline" },
    { "movement": 4, "number": 4, "name": "generate-analysis-report", "description": "Produce final analysis report and artifacts" }
  ]
}
