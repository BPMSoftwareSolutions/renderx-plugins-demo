{
  "id": "event-router-scene-1-depot",
  "canvas": { "width": 800, "height": 400 },
  "bg": "#87CEEB",
  "defs": {
    "filters": [
      "<filter id=\"sceneShadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\"><feDropShadow dx=\"0\" dy=\"4\" stdDeviation=\"8\" flood-color=\"#000\" flood-opacity=\"0.25\"/></filter>",
      "<filter id=\"busGlow\"><feGaussianBlur stdDeviation=\"2\" result=\"b\"/><feMerge><feMergeNode in=\"b\"/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>"
    ],
    "gradients": [
      "<linearGradient id=\"roadGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\"><stop offset=\"0\" stop-color=\"#404040\"/><stop offset=\"0.5\" stop-color=\"#505050\"/><stop offset=\"1\" stop-color=\"#404040\"/></linearGradient>",
      "<linearGradient id=\"busGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\"><stop offset=\"0\" stop-color=\"#FFD700\"/><stop offset=\"0.5\" stop-color=\"#FFA500\"/><stop offset=\"1\" stop-color=\"#FFD700\"/></linearGradient>"
    ]
  },
  "nodes": [
    {
      "kind": "boundary",
      "id": "scene-1-boundary",
      "title": "Scene 1: Publisher Origin (Bus Leaves Depot)",
      "at": { "x": 20, "y": 20 },
      "size": { "width": 760, "height": 360 },
      "style": { 
        "fill": "#E8F4FD", 
        "stroke": "#1976D2", 
        "strokeWidth": 2, 
        "labelColor": "#1976D2",
        "filter": "url(#sceneShadow)"
      },
      "grid": { "cols": 4, "rowH": 80, "gutter": 20, "padding": 20 },
      "policy": { "mode": "strict", "overflow": "clip", "tolerance": 2, "snap": { "grid": 4 } },
      "children": [
        {
          "kind": "shape",
          "id": "sky-background",
          "at": { "x": 0, "y": 0 },
          "size": { "width": 760, "height": 200 },
          "shape": "rect",
          "style": { "fill": "#87CEEB", "stroke": "none" }
        },
        {
          "kind": "shape",
          "id": "cloud-1",
          "at": { "x": 130, "y": 40 },
          "size": { "width": 40, "height": 25 },
          "shape": "ellipse",
          "style": { "fill": "#FFFFFF", "opacity": 0.8, "stroke": "none" }
        },
        {
          "kind": "shape",
          "id": "cloud-2",
          "at": { "x": 580, "y": 60 },
          "size": { "width": 50, "height": 30 },
          "shape": "ellipse",
          "style": { "fill": "#FFFFFF", "opacity": 0.8, "stroke": "none" }
        },
        {
          "kind": "shape",
          "id": "ground",
          "at": { "x": 0, "y": 200 },
          "size": { "width": 760, "height": 120 },
          "shape": "rect",
          "style": { "fill": "#4A6B3A", "stroke": "none" }
        },
        {
          "kind": "shape",
          "id": "road",
          "at": { "x": 0, "y": 230 },
          "size": { "width": 760, "height": 60 },
          "shape": "rect",
          "style": { "fill": "url(#roadGradient)", "stroke": "#606060", "strokeWidth": 2 }
        },
        {
          "kind": "shape",
          "id": "depot-building",
          "at": { "x": 50, "y": 100 },
          "size": { "width": 200, "height": 130 },
          "shape": "roundedRect",
          "style": { "fill": "#8B7355", "stroke": "#6B5535", "strokeWidth": 2 }
        },
        {
          "kind": "shape",
          "id": "depot-roof",
          "at": { "x": 40, "y": 100 },
          "size": { "width": 220, "height": 40 },
          "shape": "polygon",
          "style": { "fill": "#654321", "stroke": "#543210", "strokeWidth": 2 }
        },
        {
          "kind": "text",
          "id": "depot-sign",
          "at": { "x": 150, "y": 125 },
          "text": "SCHOOL BUS DEPOT",
          "style": { "fill": "#FFFFFF", "fontSize": 12, "fontWeight": "bold", "textAnchor": "middle" }
        },
        {
          "kind": "shape",
          "id": "school-bus",
          "at": { "x": 300, "y": 200 },
          "size": { "width": 120, "height": 40 },
          "shape": "roundedRect",
          "style": { "fill": "url(#busGradient)", "stroke": "#E6C200", "strokeWidth": 2, "filter": "url(#busGlow)" }
        },
        {
          "kind": "text",
          "id": "bus-label",
          "at": { "x": 360, "y": 215 },
          "text": "SCHOOL BUS",
          "style": { "fill": "#000000", "fontSize": 8, "fontWeight": "bold", "textAnchor": "middle" }
        },
        {
          "kind": "shape",
          "id": "bus-front-wheel",
          "at": { "x": 325, "y": 235 },
          "size": { "width": 16, "height": 16 },
          "shape": "circle",
          "style": { "fill": "#333333", "stroke": "#222222", "strokeWidth": 2 }
        },
        {
          "kind": "shape",
          "id": "bus-rear-wheel",
          "at": { "x": 395, "y": 235 },
          "size": { "width": 16, "height": 16 },
          "shape": "circle",
          "style": { "fill": "#333333", "stroke": "#222222", "strokeWidth": 2 }
        },
        {
          "kind": "shape",
          "id": "bus-headlight",
          "at": { "x": 415, "y": 205 },
          "size": { "width": 6, "height": 6 },
          "shape": "circle",
          "style": { "fill": "#FFFF00", "stroke": "none", "filter": "url(#busGlow)" }
        },
        {
          "kind": "text",
          "id": "sky-headline",
          "at": { "x": 380, "y": 40 },
          "text": "Every journey starts with a publish.",
          "style": { "fill": "#1E3A56", "fontSize": 24, "fontWeight": "bold", "textAnchor": "middle", "stroke": "#FFFFFF", "strokeWidth": 1 }
        },
        {
          "kind": "text",
          "id": "sky-description",
          "at": { "x": 380, "y": 65 },
          "text": "The depot launches the event onto the route.",
          "style": { "fill": "#3C556E", "fontSize": 16, "textAnchor": "middle" }
        },
        {
          "kind": "text",
          "id": "scene-caption",
          "at": { "x": 380, "y": 320 },
          "text": "Bus leaves depot â†’ publish(topic, payload)",
          "style": { "fill": "#1976D2", "fontSize": 14, "fontWeight": "bold", "textAnchor": "middle" }
        }
      ]
    }
  ],
  "ports": [
    {
      "id": "depot-out",
      "nodeId": "scene-1-boundary",
      "side": "right",
      "offset": 180
    }
  ],
  "flows": [
    {
      "id": "bus-movement-flow",
      "path": "depot-out",
      "token": { 
        "size": 6, 
        "color": "#FFD700", 
        "trail": { "length": 100, "opacity": 0.4 } 
      },
      "speed": 100,
      "loop": true,
      "activate": { 
        "boundaryIds": ["scene-1-boundary"], 
        "className": "active-scene" 
      }
    }
  ]
}
