import n from"./__vite-browser-external-B1O5LaIO.js";function m(r){try{const e=n.join(process.cwd(),"public","json-components",`${r}.json`);if(!n.existsSync(e))return null;const s=n.readFileSync(e,"utf8");return JSON.parse(s)?.ui?.styles?.css||null}catch{return null}}function c(r,e){try{const s=e.payload.uiFileContent;if(!s||typeof s!="object")throw new Error("No uiFileContent provided");if(!Array.isArray(s.components))throw new Error("uiFileContent.components must be an array");const a=s.components.map(t=>{const o={id:String(t.id),type:String(t.type||t.template?.tag||"div"),tag:String(t.template?.tag||t.type||"div"),classRefs:Array.isArray(t.template?.classRefs)?t.template.classRefs.slice():[],style:typeof t.template?.style=="object"&&t.template?.style?t.template.style:{},layout:{x:Number(t.layout?.x||0),y:Number(t.layout?.y||0),width:Number(t.layout?.width||0),height:Number(t.layout?.height||0)},parentId:t.parentId??null,siblingIndex:Number(t.siblingIndex||0),createdAt:t.createdAt||Date.now()},p=["rx-comp",`rx-${o.type}`],y=Array.isArray(o.classRefs)?o.classRefs.filter(i=>typeof i=="string"&&i.length):[];o.classRefs=Array.from(new Set([...p,...y])),t.content&&typeof t.content=="object"&&(o.content={...t.content});const l=m(o.type);return l&&(o.css=l),o});e.payload.importComponents=a,e.payload.importCssClasses=s.cssClasses||{}}catch(s){e.logger?.error?.("Failed to parse .ui file:",s),e.payload.importComponents=[],e.payload.importCssClasses={}}}export{c as parseUiFile};
