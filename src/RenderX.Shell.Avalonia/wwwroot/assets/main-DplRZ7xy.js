const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CxJ4TEFD.js","assets/global-CMa2Rm43.js","assets/EventRouter-DUQzZvsb.js","assets/global-DVG2pnu0.css","assets/Header-A6BR6KQZ-DYj0DEFE.js","assets/interactionManifest-BORsh5a3.js","assets/index-C57Nc51U.js","assets/component-mapper-Dsg136Sp.js","assets/feature-flags-IuyZAa4_.js","assets/index-CsBUx9bv.js","assets/index-Cpx-AAyB.js","assets/index-Dy4e3oam.css","assets/index-B3Djfygz.js","assets/chunk-FUFL4N7I-ClPrRS59.js","assets/chunk-RBWFAUMD-CqxTm3oP.js","assets/index-CpUT_Mw0.js"])))=>i.map(i=>d[i]);
import{_ as V,b as Ne,m as Ce,d as Le,l as Pe,e as De,f as Ze,h as Oe,r as Ye,j as Ge,a as es,g as ke,n as ss,o as ts,i as ns,p as rs,q as as,v as is,c as os}from"./global-CMa2Rm43.js";import{a as m,j as e,E as xe,R as K}from"./EventRouter-DUQzZvsb.js";import{i as Ie}from"./feature-flags-IuyZAa4_.js";import{r as ls}from"./index-CpUT_Mw0.js";import{EventRouter as de}from"./EventRouter-BSDNTYCD.js";let Q=null,ue=!1;async function cs(){if(ue&&Q)return Q;try{if(typeof window<"u"&&typeof globalThis.fetch=="function"){const n=await fetch("/layout-manifest.json");return n.ok?(Q=await n.json(),ue=!0,Q):(ue=!0,Q=null,null)}const t=await V(()=>import("./layout-manifest-DgaBAoel.js"),[]),r=t?.default||t||"{}";return Q=JSON.parse(r),ue=!0,Q}catch{return ue=!0,Q=null,null}}function ds(s){if(!s||typeof s!="object")throw new Error("Invalid layout manifest");if(!s.layout||!s.slots)throw new Error("Missing layout or slots in manifest");return!0}function us(s){const t=(s||"").trim();if(!t||/^https?:\/\//i.test(t))return!1;const r=t.startsWith("plugins/")||t.startsWith("json-sequences/")||t.startsWith("public/");return!t.startsWith("/")&&!t.startsWith(".")&&!r&&t.startsWith("@")}const ms={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};let hs=(async()=>{try{if(typeof window<"u"&&typeof globalThis.fetch=="function"){const t=await fetch("/plugins/plugin-manifest.json");if(t.ok)return await t.json()}try{const r=(await V(()=>import("./env-Bd5ebxPY.js"),[])).getArtifactsDir?.();if(r){const n=await V(()=>import("./__vite-browser-external-B1O5LaIO.js"),[]),i=(await V(()=>import("./__vite-browser-external-B1O5LaIO.js"),[])).join(process.cwd(),r,"plugins","plugin-manifest.json"),l=await n.readFile(i,"utf-8").catch(()=>null);if(l)return JSON.parse(l||'{"plugins":[]}')}}catch{}try{if((await V(()=>import("./env-Bd5ebxPY.js"),[])).getArtifactsDir?.())return{plugins:[]}}catch{}try{const t=await V(()=>import("./plugin-manifest-BeQfmLYd.js"),[]),r=t?.default||t||'{"plugins":[]}';return JSON.parse(r)}catch{return{plugins:[]}}}catch{return{plugins:[]}}})();function ps(s){try{const t=import.meta.resolve;if(typeof t=="function"){const r=t(s);if(typeof r=="string"&&r)return r}}catch{}try{const t=ms;t&&t.DEV&&us(s)}catch{}return s}const gs={"@renderx-plugins/header":()=>V(()=>import("./index-CxJ4TEFD.js"),__vite__mapDeps([0,1,2,3,4,5])),"@renderx-plugins/library":()=>V(()=>import("./index-C57Nc51U.js"),__vite__mapDeps([6,7,2,5,4,8])),"@renderx-plugins/canvas":()=>V(()=>import("./index-CsBUx9bv.js"),__vite__mapDeps([9,4,2,5,8])),"@renderx-plugins/library-component":()=>V(()=>import("./index-Cpx-AAyB.js"),__vite__mapDeps([10,2])),"@renderx-plugins/control-panel":async()=>{try{await V(()=>Promise.resolve({}),__vite__mapDeps([11]))}catch{}return V(()=>import("./index-B3Djfygz.js").then(s=>s.C),__vite__mapDeps([12,13,14,2,4,5,15]))}};function fs({slot:s}){const[t,r]=m.useState(null);return m.useEffect(()=>{let n=!0;return(async()=>{try{const i=(await hs).plugins.find(x=>x.ui?.slot===s);if(!i||!i.ui)throw new Error(`No plugin UI found for slot ${s}`);let l=i.ui.module;if(l.startsWith("../../src/vendor/")){const x=l.replace("../../src/vendor/","../../../src/vendor/");x!==l&&(l=x)}if(typeof import.meta<"u"&&!!import.meta.vitest&&typeof globalThis<"u"&&globalThis.__RENDERX_FORCE_LIBRARY_RESOLUTION_ERROR===!0&&l==="@renderx-plugins/library"){const x=new TypeError("Failed to resolve module specifier '@renderx-plugins/library'");throw console.warn("⚠️ Failed runtime register for","LibraryPlugin",x),x}const p=gs[l],h=ps(l);if(h.startsWith("https:"))throw new Error(`Unsupported module specifier: ${h}. Remote https: imports are not allowed in Node.js/Esm environments.`);const g=(p?await p():await import(h))[i.ui.export];if(!g)throw new Error(`Export ${i.ui.export} not found in ${i.ui.module}`);n&&r(()=>g)}catch(a){console.error(a),n&&typeof window<"u"&&r(()=>()=>e.jsxs("div",{style:{padding:12},children:["Failed to load panel: ",String(a)]}))}})(),()=>{n=!1}},[s]),t?e.jsx(t,{}):null}function te({slot:s,capabilities:t}){const r=!!t?.droppable,n=m.useCallback(a=>{if(r)try{a.preventDefault();try{a.dataTransfer&&(a.dataTransfer.dropEffect="copy")}catch{}}catch{}},[r]);return e.jsx("div",{"data-slot-content":"",style:{position:"absolute",inset:0,display:"flex"},onDragOverCapture:r?n:void 0,children:e.jsx(fs,{slot:s})})}function xs(){const[s,t]=m.useState(null),[r,n]=m.useState(!1);if(m.useEffect(()=>{if(typeof window>"u")return;let u=!0;return cs().then(g=>{if(u){if(!g){n(!0);return}ds(g),t(g)}}).catch(g=>{console.error(g),u&&n(!0)}),()=>{u=!1}},[]),r)return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr 360px",height:"100vh"},children:[e.jsx("div",{"data-slot":"library",style:{position:"relative"},children:e.jsx(te,{slot:"library"})}),e.jsx("div",{"data-slot":"canvas",style:{position:"relative"},children:e.jsx(te,{slot:"canvas",capabilities:{droppable:!0}})}),e.jsx("div",{"data-slot":"controlPanel",style:{position:"relative"},children:e.jsx(te,{slot:"controlPanel"})})]});if(!s)return e.jsx("div",{"data-layout-container":"",style:{display:"grid"}});const a=s.layout||{};let i=a.columns||[],l=a.rows||[];const d=a.areas||[],c=Array.isArray(a.responsive)?a.responsive:[];for(const u of c)if(typeof matchMedia=="function"&&u.media&&matchMedia(u.media).matches){i=u.columns||i,l=u.rows||l;break}const p={display:"grid",gridTemplateColumns:i.join(" "),gridTemplateRows:l.join(" "),height:"100vh"},h={};try{const u=Array.isArray(s.slots)?s.slots:[];for(const g of u){const x=g?.name;if(!x)continue;const j=g?.capabilities||{};h[x]={droppable:!!j.droppable}}}catch{}return e.jsx("div",{"data-layout-container":"",style:p,children:d.flatMap((u,g)=>u.map((x,j)=>e.jsx("div",{"data-slot":x,style:{gridRow:g+1,gridColumn:j+1,position:"relative"},children:e.jsx(te,{slot:x,capabilities:h[x]})},`${g}-${j}`)))})}function vs(s){const t=[],r=[],n=()=>window.RenderX?.conductor,a=l=>{if(!n())return!1;const c=l.target.window?window:l.target.selector?document.querySelector(l.target.selector):null;if(!c)return!1;const p=async u=>{try{if(l.guard?.key&&u.key!==l.guard.key||l.guard?.ctrlKey!==void 0&&u.ctrlKey!==l.guard.ctrlKey||l.guard?.metaKey!==void 0&&u.metaKey!==l.guard.metaKey||l.guard?.shiftKey!==void 0&&u.shiftKey!==l.guard.shiftKey||l.guard?.altKey!==void 0&&u.altKey!==l.guard.altKey||l.guard?.notClosestMatch&&u.target?.closest?.(l.guard.notClosestMatch))return;const g=n();if(!g)return;await xe.publish(l.publish.topic,l.publish.payload??{},g)}catch{}};c.addEventListener(l.event,p,l.options);const h=()=>{try{c.removeEventListener(l.event,p,l.options)}catch{}};return t.push(h),!0};for(const l of s)a(l)||r.push(l);let i=null;return r.length&&(i=new MutationObserver(()=>{for(let l=r.length-1;l>=0;l--)a(r[l])&&r.splice(l,1);!r.length&&i&&(i.disconnect(),i=null)}),i.observe(document.body,{childList:!0,subtree:!0})),()=>{try{i&&i.disconnect()}catch{}for(;t.length;){const l=t.pop();try{l&&l()}catch{}}}}const js=[{id:"canvas.deselect.onCanvasClick",target:{selector:"#rx-canvas"},event:"click",options:!0,guard:{notClosestMatch:".rx-comp,[id^='rx-node-']"},publish:{topic:"canvas.component.deselect.requested",payload:{}}},{id:"canvas.deselect.onEscape",target:{window:!0},event:"keydown",guard:{key:"Escape"},publish:{topic:"canvas.component.deselect.requested",payload:{}}},{id:"canvas.delete.onDelete",target:{window:!0},event:"keydown",guard:{key:"Delete"},publish:{topic:"canvas.component.delete.requested",payload:{}}},{id:"canvas.copy.onCtrlC",target:{window:!0},event:"keydown",guard:{key:"c",ctrlKey:!0,metaKey:!1},publish:{topic:"canvas.component.copy",payload:{}}},{id:"canvas.copy.onCmdC",target:{window:!0},event:"keydown",guard:{key:"c",metaKey:!0,ctrlKey:!1},publish:{topic:"canvas.component.copy",payload:{}}},{id:"canvas.paste.onCtrlV",target:{window:!0},event:"keydown",guard:{key:"v",ctrlKey:!0,metaKey:!1},publish:{topic:"canvas.component.paste",payload:{}}},{id:"canvas.paste.onCmdV",target:{window:!0},event:"keydown",guard:{key:"v",metaKey:!0,ctrlKey:!1},publish:{topic:"canvas.component.paste",payload:{}}}];/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bs=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),qe=s=>{const t=bs(s);return t.charAt(0).toUpperCase()+t.slice(1)},Ae=(...s)=>s.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Ns=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ws={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=m.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...d},c)=>m.createElement("svg",{ref:c,...ws,width:t,height:t,stroke:s,strokeWidth:n?Number(r)*24/Number(t):r,className:Ae("lucide",a),...!i&&!Ns(d)&&{"aria-hidden":"true"},...d},[...l.map(([p,h])=>m.createElement(p,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=(s,t)=>{const r=m.forwardRef(({className:n,...a},i)=>m.createElement(Ss,{ref:i,iconNode:t,className:Ae(`lucide-${ys(qe(s))}`,`lucide-${s}`,n),...a}));return r.displayName=qe(s),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],fe=E("activity",Cs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Is=E("arrow-right-left",ks);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],$s=E("book-open",qs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],$e=E("boxes",Es);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ts=E("calendar",Ms);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ee=E("chart-column",Rs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ls=E("check",_s);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Fe=E("clock",Ps);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Os=E("copy",Ds);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Be=E("database",As);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],je=E("file-code",Fs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]],zs=E("file-input",Bs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]],Js=E("file-output",Us);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Me=E("git-branch",Hs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Xs=E("lock",Vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ws=E("map-pin",Ks);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Zs=E("message-square",Qs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],we=E("package",Ys);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"m14.622 17.897-10.68-2.913",key:"vj2p1u"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z",key:"18tc5c"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15",key:"ytzfxy"}]],et=E("paintbrush",Gs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],tt=E("palette",st);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],rt=E("play",nt);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],it=E("radio",at);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],lt=E("refresh-cw",ot);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],dt=E("route",ct);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],mt=E("search",ut);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ze=E("settings",ht);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],gt=E("sliders-vertical",pt);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],xt=E("target",ft);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],jt=E("zap",vt),yt=({plugins:s,routes:t,topicsMap:r,onSelectNode:n})=>{const[a,i]=m.useState(new Set(["plugins","routes","topics","components","conductor","performance","sequence-player","log-converter"])),[l,d]=m.useState(""),[c,p]=m.useState(null),h=o=>!!o.ui,u=o=>!!o.runtime,g=o=>!!o.topics&&(o.topics.subscribes.length>0||o.topics.publishes.length>0),x=o=>t.some(A=>A.pluginId===o.id),j=o=>!!o.sequences&&o.sequences.length>0,y=o=>!!o.permissions,S=o=>!!o.configuration,f=o=>!!o.metrics,N=o=>!!o.dependencies,q=o=>!!o?.module,z=o=>!!o?.sequences&&o.sequences.length>0,J=o=>!!o?.capabilities&&o.capabilities.length>0,L=o=>!!o?.backgroundJobs&&o.backgroundJobs.length>0,O=o=>!!o?.caching,F=o=>!!o?.slot,P=o=>!!o?.module,R=o=>!!o?.dependencies&&o.dependencies.length>0,le=o=>!!o?.props&&Object.keys(o.props).length>0,D=o=>!!o?.events&&o.events.length>0,W=o=>!!o?.styling&&(o.styling.cssClasses&&o.styling.cssClasses.length>0||o.styling.themeVariables&&Object.keys(o.styling.themeVariables).length>0),ne=o=>!!o?.lifecycleHooks&&(!!o.lifecycleHooks.onMount||!!o.lifecycleHooks.onUpdate||!!o.lifecycleHooks.onUnmount),ce=o=>{i(A=>{const B=new Set(A);return B.has(o)?B.delete(o):B.add(o),B})},M=o=>a.has(o),re=o=>{p(o),n(o)},ae=m.useMemo(()=>l?s.filter(o=>o.id.toLowerCase().includes(l.toLowerCase())):s,[s,l]),X=m.useMemo(()=>l?t.filter(o=>o.route.toLowerCase().includes(l.toLowerCase())||o.pluginId.toLowerCase().includes(l.toLowerCase())||o.sequenceId.toLowerCase().includes(l.toLowerCase())):t,[t,l]),ee=m.useMemo(()=>l?Object.entries(r).filter(([o])=>o.toLowerCase().includes(l.toLowerCase())):Object.entries(r),[r,l]),b=({nodeId:o,label:A,level:B=0,hasChildren:w=!1,badge:$,icon:C,onClick:v})=>{const I=M(o),k=c===o;return e.jsxs("div",{className:`tree-node ${k?"selected":""}`,style:{paddingLeft:`${B*1}rem`},onClick:_=>{_.stopPropagation(),w&&ce(o),re(o),v?.()},children:[w&&e.jsx("span",{className:"tree-node-icon",children:I?"▼":"▶"}),!w&&!C&&e.jsx("span",{className:"tree-node-icon",children:"•"}),C&&e.jsx("span",{className:"tree-node-icon",style:{display:"inline-flex",alignItems:"center"},children:C}),e.jsx("span",{className:"tree-node-label",children:A}),$&&e.jsx("span",{className:"tree-node-badge",children:$})]})};return e.jsxs("div",{className:"plugin-tree-explorer",children:[e.jsxs("div",{className:"tree-header",children:[e.jsx("h3",{className:"tree-title",children:"Plugin Explorer"}),e.jsx("input",{type:"text",className:"tree-search",placeholder:"Search...",value:l,onChange:o=>d(o.target.value)})]}),e.jsxs("div",{className:"tree-content",children:[e.jsx(b,{nodeId:"plugins",label:"Plugins",hasChildren:!0,badge:`${ae.length}`}),M("plugins")&&ae.map(o=>{const A=`plugin:${o.id}`,B=M(A);return e.jsxs(K.Fragment,{children:[e.jsx(b,{nodeId:A,label:o.id,level:1,hasChildren:!0}),B&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:info`,label:"Plugin Info",level:2,icon:e.jsx(we,{size:14})}),h(o)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:ui`,label:"UI Configuration",level:2,icon:e.jsx(tt,{size:14}),hasChildren:!0}),M(`plugin:${o.id}:ui`)&&e.jsxs(e.Fragment,{children:[F(o.ui)&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:slot`,label:"Slot",level:3,icon:e.jsx(Ws,{size:14})}),P(o.ui)&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:module`,label:"Module Path",level:3,icon:e.jsx(je,{size:14})}),R(o.ui)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:ui:dependencies`,label:"Dependencies",level:3,icon:e.jsx($e,{size:14}),hasChildren:!0,badge:`${o.ui?.dependencies?.length||0}`}),M(`plugin:${o.id}:ui:dependencies`)&&o.ui?.dependencies?.map((w,$)=>{const C=`plugin:${o.id}:ui:dependencies:${w.name}`;return e.jsxs(K.Fragment,{children:[e.jsx(b,{nodeId:C,label:w.name,level:4,hasChildren:!0}),M(C)&&e.jsxs(e.Fragment,{children:[w.version&&e.jsx(b,{nodeId:`${C}:version`,label:`Version: ${w.version}`,level:5}),w.size&&e.jsx(b,{nodeId:`${C}:size`,label:`Size: ${w.size}`,level:5}),w.license&&e.jsx(b,{nodeId:`${C}:license`,label:`License: ${w.license}`,level:5})]})]},`${o.id}-dep-${$}`)})]}),le(o.ui)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:ui:props`,label:"Props",level:3,icon:e.jsx(gt,{size:14}),hasChildren:!0,badge:`${Object.keys(o.ui?.props||{}).length}`}),M(`plugin:${o.id}:ui:props`)&&Object.entries(o.ui?.props||{}).map(([w,$])=>{const C=`plugin:${o.id}:ui:props:${w}`;return e.jsxs(K.Fragment,{children:[e.jsx(b,{nodeId:C,label:w,level:4,hasChildren:!0}),M(C)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`${C}:type`,label:`Type: ${$.type}`,level:5}),$.default!==void 0&&e.jsx(b,{nodeId:`${C}:default`,label:`Default: ${JSON.stringify($.default)}`,level:5}),$.required!==void 0&&e.jsx(b,{nodeId:`${C}:required`,label:`Required: ${$.required}`,level:5}),$.validation&&e.jsx(b,{nodeId:`${C}:validation`,label:`Validation: ${JSON.stringify($.validation)}`,level:5})]})]},`${o.id}-prop-${w}`)})]}),D(o.ui)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:ui:events`,label:"Events",level:3,icon:e.jsx(it,{size:14}),hasChildren:!0,badge:`${o.ui?.events?.length||0}`}),M(`plugin:${o.id}:ui:events`)&&o.ui?.events?.map((w,$)=>{const C=`plugin:${o.id}:ui:events:${w.name}`;return e.jsxs(K.Fragment,{children:[e.jsx(b,{nodeId:C,label:w.name,level:4,hasChildren:!0}),M(C)&&e.jsxs(e.Fragment,{children:[w.payloadSchema&&e.jsx(b,{nodeId:`${C}:payloadSchema`,label:`Payload Schema: ${JSON.stringify(w.payloadSchema)}`,level:5}),w.frequency&&e.jsx(b,{nodeId:`${C}:frequency`,label:`Frequency: ${w.frequency}`,level:5}),w.subscribers&&w.subscribers.length>0&&e.jsx(b,{nodeId:`${C}:subscribers`,label:`Subscribers: ${w.subscribers.join(", ")}`,level:5})]})]},`${o.id}-event-${$}`)})]}),W(o.ui)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:ui:styling`,label:"Styling",level:3,icon:e.jsx(et,{size:14}),hasChildren:!0}),M(`plugin:${o.id}:ui:styling`)&&e.jsxs(e.Fragment,{children:[o.ui?.styling?.cssClasses&&o.ui.styling.cssClasses.length>0&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:styling:cssClasses`,label:`CSS Classes: ${o.ui.styling.cssClasses.join(", ")}`,level:4}),o.ui?.styling?.themeVariables&&Object.keys(o.ui.styling.themeVariables).length>0&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:styling:themeVariables`,label:`Theme Variables: ${JSON.stringify(o.ui.styling.themeVariables)}`,level:4})]})]}),ne(o.ui)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:ui:lifecycleHooks`,label:"Lifecycle Hooks",level:3,icon:e.jsx(fe,{size:14}),hasChildren:!0}),M(`plugin:${o.id}:ui:lifecycleHooks`)&&e.jsxs(e.Fragment,{children:[o.ui?.lifecycleHooks?.onMount&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:lifecycleHooks:onMount`,label:`onMount: ${o.ui.lifecycleHooks.onMount}`,level:4}),o.ui?.lifecycleHooks?.onUpdate&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:lifecycleHooks:onUpdate`,label:`onUpdate: ${o.ui.lifecycleHooks.onUpdate}`,level:4}),o.ui?.lifecycleHooks?.onUnmount&&e.jsx(b,{nodeId:`plugin:${o.id}:ui:lifecycleHooks:onUnmount`,label:`onUnmount: ${o.ui.lifecycleHooks.onUnmount}`,level:4})]})]})]})]}),u(o)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:runtime`,label:"Runtime",level:2,icon:e.jsx(jt,{size:14}),hasChildren:!0}),M(`plugin:${o.id}:runtime`)&&e.jsxs(e.Fragment,{children:[q(o.runtime)&&e.jsx(b,{nodeId:`plugin:${o.id}:runtime:module`,label:"Module Path",level:3,icon:e.jsx(je,{size:14})}),z(o.runtime)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:runtime:sequences`,label:"Sequences",level:3,icon:e.jsx(Me,{size:14}),hasChildren:!0,badge:`${o.runtime?.sequences?.length||0}`}),M(`plugin:${o.id}:runtime:sequences`)&&o.runtime?.sequences?.map((w,$)=>{const C=`plugin:${o.id}:runtime:sequences:${w.id}`;return e.jsxs(K.Fragment,{children:[e.jsx(b,{nodeId:C,label:w.name||w.id,level:4,hasChildren:!0}),M(C)&&e.jsxs(e.Fragment,{children:[w.handlers&&w.handlers.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`${C}:handlers`,label:"Handlers",level:5,icon:e.jsx(rt,{size:14}),hasChildren:!0,badge:`${w.handlers.length}`}),M(`${C}:handlers`)&&w.handlers.map((v,I)=>e.jsx(b,{nodeId:`${C}:handlers:${v.name}`,label:`${v.name}${v.duration?` (${v.duration}ms)`:""}${v.errorRate?` [${v.errorRate}% errors]`:""}`,level:6},`${C}-handler-${I}`))]}),w.movements&&w.movements.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`${C}:movements`,label:"Movements",level:5,icon:e.jsx(Is,{size:14}),hasChildren:!0,badge:`${w.movements.length}`}),M(`${C}:movements`)&&w.movements.map((v,I)=>e.jsx(b,{nodeId:`${C}:movements:${I}`,label:`${v.from} → ${v.to}`,level:6},`${C}-movement-${I}`))]}),w.parameters&&Object.keys(w.parameters).length>0&&e.jsx(b,{nodeId:`${C}:parameters`,label:"Parameters",level:5,icon:e.jsx(zs,{size:14})}),w.dataBatonContracts&&e.jsx(b,{nodeId:`${C}:dataBatonContracts`,label:"Data Baton Contracts",level:5,icon:e.jsx(je,{size:14})}),w.returns&&e.jsx(b,{nodeId:`${C}:returns`,label:"Returns",level:5,icon:e.jsx(Js,{size:14})}),w.executions&&w.executions.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`${C}:executions`,label:"Executions",level:5,icon:e.jsx(Fe,{size:14}),hasChildren:!0,badge:`${w.executions.length}`}),M(`${C}:executions`)&&w.executions.map((v,I)=>{const k=`${C}:executions:${v.id}`;return e.jsxs(K.Fragment,{children:[e.jsx(b,{nodeId:k,label:`${v.timestamp} (${v.duration}ms)`,level:6,hasChildren:!0}),M(k)&&e.jsxs(e.Fragment,{children:[v.input&&e.jsx(b,{nodeId:`${k}:input`,label:"Input",level:7}),v.output&&e.jsx(b,{nodeId:`${k}:output`,label:"Output",level:7}),v.errors&&e.jsx(b,{nodeId:`${k}:errors`,label:"Errors",level:7})]})]},`${C}-exec-${I}`)})]}),w.metrics&&e.jsx(b,{nodeId:`${C}:metrics`,label:`Metrics: ${w.metrics.avgDuration?`${w.metrics.avgDuration}ms avg`:""}${w.metrics.successRate?`, ${w.metrics.successRate}% success`:""}`,level:5,icon:e.jsx(Ee,{size:14})})]})]},`${o.id}-seq-${$}`)})]}),J(o.runtime)&&e.jsx(b,{nodeId:`plugin:${o.id}:runtime:capabilities`,label:"Capabilities",level:3,icon:e.jsx(xt,{size:14}),badge:`${o.runtime?.capabilities?.length||0}`}),L(o.runtime)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{nodeId:`plugin:${o.id}:runtime:backgroundJobs`,label:"Background Jobs",level:3,icon:e.jsx(Ts,{size:14}),hasChildren:!0,badge:`${o.runtime?.backgroundJobs?.length||0}`}),M(`plugin:${o.id}:runtime:backgroundJobs`)&&o.runtime?.backgroundJobs?.map((w,$)=>e.jsx(b,{nodeId:`plugin:${o.id}:runtime:backgroundJobs:${w.id}`,label:`${w.id} [${w.status}]${w.schedule?` - ${w.schedule}`:""}`,level:4},`${o.id}-job-${$}`))]}),O(o.runtime)&&e.jsx(b,{nodeId:`plugin:${o.id}:runtime:caching`,label:`Caching: ${o.runtime?.caching?.strategy||"N/A"}${o.runtime?.caching?.hitRate?` (${o.runtime.caching.hitRate}% hit rate)`:""}`,level:3,icon:e.jsx(Be,{size:14})})]})]}),g(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:topics`,label:"Topics",level:2,icon:e.jsx(Zs,{size:14})}),x(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:routes`,label:"Routes",level:2,icon:e.jsx(dt,{size:14})}),j(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:sequences`,label:"Sequences",level:2,icon:e.jsx(Me,{size:14})}),y(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:permissions`,label:"Permissions",level:2,icon:e.jsx(Xs,{size:14})}),S(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:configuration`,label:"Configuration",level:2,icon:e.jsx(ze,{size:14})}),f(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:metrics`,label:"Metrics",level:2,icon:e.jsx(Ee,{size:14})}),N(o)&&e.jsx(b,{nodeId:`plugin:${o.id}:dependencies`,label:"Dependencies",level:2,icon:e.jsx($e,{size:14})})]})]},o.id)}),e.jsx(b,{nodeId:"routes",label:"Routes",hasChildren:X.length>0,badge:`${X.length}`}),M("routes")&&X.length>0&&X.map((o,A)=>e.jsx(b,{nodeId:`route:${o.route}`,label:o.route,level:1},`route-${A}`)),e.jsx(b,{nodeId:"topics",label:"Topics",hasChildren:!0,badge:`${ee.length}`}),M("topics")&&ee.map(([o])=>e.jsx(b,{nodeId:`topic:${o}`,label:o,level:1},o)),e.jsx(b,{nodeId:"components",label:"Components",hasChildren:!1}),e.jsx(b,{nodeId:"conductor",label:"Conductor",hasChildren:!1}),e.jsx(b,{nodeId:"performance",label:"Performance",hasChildren:!1}),e.jsx(b,{nodeId:"sequence-player",label:"Sequence Player",hasChildren:!1}),e.jsx(b,{nodeId:"log-converter",label:"Log Converter",hasChildren:!1})]})]})},Z=({data:s,title:t,collapsible:r=!0,defaultExpanded:n=!0,maxHeight:a="400px"})=>{const[i,l]=m.useState(n),[d,c]=m.useState(!1),p=async()=>{try{const u=JSON.stringify(s,null,2);await navigator.clipboard.writeText(u),c(!0),setTimeout(()=>c(!1),2e3)}catch(u){console.error("Failed to copy:",u)}},h=JSON.stringify(s,null,2);return e.jsxs("div",{className:"json-viewer",children:[t&&e.jsxs("div",{className:"json-viewer-header",children:[r&&e.jsx("button",{className:"json-viewer-toggle",onClick:()=>l(!i),"aria-label":i?"Collapse":"Expand",children:i?"▼":"▶"}),e.jsx("span",{className:"json-viewer-title",children:t}),e.jsx("button",{className:"json-viewer-copy",onClick:p,"aria-label":"Copy to clipboard",title:"Copy to clipboard",children:d?e.jsx(Ls,{size:14}):e.jsx(Os,{size:14})})]}),(!r||i)&&e.jsx("div",{className:"json-viewer-content",style:{maxHeight:a},children:e.jsx("pre",{className:"json-viewer-pre",children:e.jsx("code",{className:"json-viewer-code",children:h})})})]})},he=({icon:s,label:t,onClick:r,variant:n="secondary",disabled:a=!1,loading:i=!1,size:l="medium"})=>e.jsxs("button",{className:`action-button action-button-${n} action-button-${l}`,onClick:r,disabled:a||i,"aria-label":t,children:[i?e.jsx("span",{className:"action-button-spinner"}):s&&e.jsx(s,{size:l==="small"?14:l==="large"?20:16}),e.jsx("span",{className:"action-button-label",children:t})]}),bt=({timestamp:s,updateInterval:t=6e4})=>{const[,r]=m.useState(0);m.useEffect(()=>{const c=setInterval(()=>{r(p=>p+1)},t);return()=>clearInterval(c)},[t]);const n=c=>{const h=new Date().getTime()-c.getTime(),u=Math.floor(h/1e3),g=Math.floor(u/60),x=Math.floor(g/60),j=Math.floor(x/24);return u<60?"just now":g<60?`${g} minute${g!==1?"s":""} ago`:x<24?`${x} hour${x!==1?"s":""} ago`:j<7?`${j} day${j!==1?"s":""} ago`:c.toLocaleDateString()},a=c=>c.toLocaleString(),i=new Date(s),l=n(i),d=a(i);return e.jsx("span",{className:"relative-time",title:d,children:l})},Y=({title:s,children:t,defaultExpanded:r=!0,badge:n,icon:a})=>{const[i,l]=m.useState(r);return e.jsxs("div",{className:"collapsible-section",children:[e.jsxs("button",{className:"collapsible-section-header",onClick:()=>l(!i),"aria-expanded":i,children:[e.jsx("span",{className:"collapsible-section-toggle",children:i?"▼":"▶"}),a&&e.jsx("span",{className:"collapsible-section-icon",children:a}),e.jsx("span",{className:"collapsible-section-title",children:s}),n!==void 0&&e.jsx("span",{className:"collapsible-section-badge",children:n})]}),i&&e.jsx("div",{className:"collapsible-section-content",children:t})]})},Nt=({plugin:s,onAction:t})=>{if(!s)return e.jsx("div",{className:"plugin-info-inspector",children:e.jsx("p",{children:"No plugin data available"})});const r=x=>{t?t(x,{pluginId:s.id}):console.log(`Action: ${x}`,{pluginId:s.id})},n=s.id||"Unknown Plugin",a=s.version||"1.0.0",i=s.status||"loaded",l=s.loadTime||s.loading?.loadTime,d=s.description||`Plugin: ${n}`,c=s.metrics?.memoryUsage||s.memoryUsage||"0 MB",p=s.metrics?.lastActivity||s.lastActivity||Date.now(),h=s.metrics?.elementsCreated||s.elementsCreated||0,u=s.metrics?.avgResponse||s.avgResponse||0,g=x=>{switch(x.toLowerCase()){case"loaded":case"active":return"var(--success-color, #28a745)";case"loading":return"var(--warning-color, #ffc107)";case"failed":case"error":return"var(--danger-color, #dc3545)";default:return"var(--text-secondary, #999)"}};return e.jsxs("div",{className:"plugin-info-inspector",children:[e.jsxs("div",{className:"plugin-info-header",children:[e.jsx("div",{className:"plugin-info-header-icon",children:e.jsx(we,{size:32})}),e.jsxs("div",{className:"plugin-info-header-content",children:[e.jsx("h2",{className:"plugin-info-title",children:n}),e.jsxs("div",{className:"plugin-info-meta",children:[e.jsxs("span",{className:"plugin-info-version",children:["v",a]}),e.jsx("span",{className:"plugin-info-separator",children:"•"}),e.jsx("span",{className:"plugin-info-status",style:{color:g(i)},children:i}),l&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"plugin-info-separator",children:"•"}),e.jsxs("span",{className:"plugin-info-load-time",children:[l,"ms load time"]})]})]})]})]}),e.jsxs("div",{className:"plugin-info-section",children:[e.jsx("h3",{className:"plugin-info-section-title",children:"Overview"}),e.jsx("p",{className:"plugin-info-description",children:d})]}),e.jsxs("div",{className:"plugin-info-section",children:[e.jsxs("h3",{className:"plugin-info-section-title",children:[e.jsx(fe,{size:16}),"Quick Stats"]}),e.jsxs("div",{className:"plugin-info-stats",children:[e.jsxs("div",{className:"plugin-info-stat",children:[e.jsx(Be,{size:16,className:"plugin-info-stat-icon"}),e.jsxs("div",{className:"plugin-info-stat-content",children:[e.jsx("div",{className:"plugin-info-stat-label",children:"Memory"}),e.jsx("div",{className:"plugin-info-stat-value",children:c})]})]}),e.jsxs("div",{className:"plugin-info-stat",children:[e.jsx(Fe,{size:16,className:"plugin-info-stat-icon"}),e.jsxs("div",{className:"plugin-info-stat-content",children:[e.jsx("div",{className:"plugin-info-stat-label",children:"Last Activity"}),e.jsx("div",{className:"plugin-info-stat-value",children:e.jsx(bt,{timestamp:p})})]})]}),h>0&&e.jsxs("div",{className:"plugin-info-stat",children:[e.jsx(we,{size:16,className:"plugin-info-stat-icon"}),e.jsxs("div",{className:"plugin-info-stat-content",children:[e.jsx("div",{className:"plugin-info-stat-label",children:"Elements Created"}),e.jsx("div",{className:"plugin-info-stat-value",children:h.toLocaleString()})]})]}),u>0&&e.jsxs("div",{className:"plugin-info-stat",children:[e.jsx(fe,{size:16,className:"plugin-info-stat-icon"}),e.jsxs("div",{className:"plugin-info-stat-content",children:[e.jsx("div",{className:"plugin-info-stat-label",children:"Avg Response"}),e.jsxs("div",{className:"plugin-info-stat-value",children:[u,"ms"]})]})]})]})]}),e.jsxs("div",{className:"plugin-info-section",children:[e.jsx("h3",{className:"plugin-info-section-title",children:"Actions"}),e.jsxs("div",{className:"plugin-info-actions",children:[e.jsx(he,{icon:fe,label:"Test Plugin",onClick:()=>r("test"),variant:"primary"}),e.jsx(he,{icon:lt,label:"Reload",onClick:()=>r("reload"),variant:"secondary"}),e.jsx(he,{icon:$s,label:"View Docs",onClick:()=>r("docs"),variant:"secondary"}),e.jsx(he,{icon:ze,label:"Config",onClick:()=>r("config"),variant:"secondary"})]})]}),s.ui&&e.jsx(Y,{title:"UI Configuration",defaultExpanded:!1,children:e.jsx(Z,{data:s.ui})}),s.runtime&&e.jsx(Y,{title:"Runtime Configuration",defaultExpanded:!1,children:e.jsx(Z,{data:s.runtime})}),s.topics&&e.jsx(Y,{title:"Topics",badge:(s.topics.subscribes?.length||0)+(s.topics.publishes?.length||0),defaultExpanded:!1,children:e.jsx(Z,{data:s.topics})}),s.sequences&&s.sequences.length>0&&e.jsx(Y,{title:"Sequences",badge:s.sequences.length,defaultExpanded:!1,children:e.jsx(Z,{data:s.sequences})}),s.permissions&&e.jsx(Y,{title:"Permissions",defaultExpanded:!1,children:e.jsx(Z,{data:s.permissions})}),s.configuration&&e.jsx(Y,{title:"Configuration",defaultExpanded:!1,children:e.jsx(Z,{data:s.configuration})}),s.metrics&&e.jsx(Y,{title:"Metrics",defaultExpanded:!1,children:e.jsx(Z,{data:s.metrics})}),s.dependencies&&e.jsx(Y,{title:"Dependencies",defaultExpanded:!1,children:e.jsx(Z,{data:s.dependencies})})]})},wt=({selectedNode:s,nodeData:t,onNavigate:r,onAction:n})=>{const i=(d=>{if(!d)return null;if(d.startsWith("plugin:")){const c=d.split(":");if(c.length===2)return"plugin";if(c.length===3)switch(c[2]){case"info":return"plugin-info";case"ui":return"ui-config";case"runtime":return"runtime";case"topics":return"topics";case"routes":return"routes";case"sequences":return"sequences";case"permissions":return"permission";case"configuration":return"configuration";case"metrics":return"metrics";case"dependencies":return"dependency";default:return null}}return d==="plugins"?"plugin":d==="routes"?"routes":d==="topics"?"topics":d.startsWith("route:")?"route":d.startsWith("topic:")?"topic":d.startsWith("sequence:")?"sequence":d.startsWith("execution:")?"execution":null})(s);if(!s||!i)return e.jsxs("div",{className:"inspection-panel-empty",children:[e.jsx("div",{className:"inspection-panel-empty-icon",children:e.jsx(mt,{size:48})}),e.jsx("h3",{className:"inspection-panel-empty-title",children:"No Node Selected"}),e.jsx("p",{className:"inspection-panel-empty-text",children:"Select a plugin or node from the tree to view detailed information"})]});const l=()=>{switch(i){case"plugin-info":return e.jsx(Nt,{plugin:t,onAction:n});case"plugin":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Plugin Overview"}),e.jsxs("p",{children:["Plugin: ",s]}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"ui-config":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"UI Configuration"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"runtime":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Runtime Configuration"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"topics":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Topics"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"routes":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Routes"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"sequences":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Sequences"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"permission":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Permissions"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"configuration":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Configuration"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"metrics":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Metrics"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"dependency":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Dependencies"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"route":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Route Details"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"topic":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Topic Details"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"sequence":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Sequence Details"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});case"execution":return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Execution Details"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]});default:return e.jsxs("div",{className:"inspection-panel-content",children:[e.jsx("h3",{children:"Unknown Node Type"}),e.jsxs("p",{children:["Node: ",s]}),e.jsxs("p",{children:["Type: ",i]})]})}};return e.jsx("div",{className:"inspection-panel",children:l()})},St=({percentage:s,color:t="blue"})=>{const i=50*Math.PI,l=i-s/100*i;return e.jsxs("svg",{height:56,width:56,className:`ring ring-${t}`,children:[e.jsx("circle",{className:"ring-track",stroke:"var(--border-color)",fill:"transparent",strokeWidth:6,r:25,cx:28,cy:28}),e.jsx("circle",{className:"ring-progress",stroke:"currentColor",fill:"transparent",strokeWidth:6,strokeLinecap:"round",strokeDasharray:`${i} ${i}`,style:{strokeDashoffset:l},r:25,cx:28,cy:28}),e.jsxs("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"ring-label",children:[s,"%"]})]})},ye=({title:s,value:t,subtitle:r,percentage:n,color:a="blue",showProgressRing:i=!1})=>e.jsxs("div",{className:"metric-card",children:[e.jsx("h3",{className:"metric-title",children:s}),i&&n!==void 0&&e.jsx("div",{className:"progress-ring",children:e.jsx(St,{percentage:n,color:a})}),e.jsx("div",{className:"metric-value",children:t}),r&&e.jsx("div",{className:"metric-subtitle",children:r})]}),me=({label:s,value:t})=>e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:s}),e.jsx("div",{className:"metric-strong",children:t})]}),Ct=({loadedPluginsCount:s,totalPluginsCount:t,failedPluginsCount:r,routeCount:n,topicCount:a})=>{const l=((p,h)=>h>0?Math.round(p/h*100):0)(s,t),d=t>0?Math.round((t-r)/t*100):0,c=s>0?100:0;return e.jsxs("div",{className:"control-panel",children:[e.jsx("h2",{children:"System Statistics"}),e.jsx("div",{className:"stats-enhanced",children:e.jsxs("div",{className:"stats-dashboard",children:[e.jsxs("div",{className:"metric-grid-top",children:[e.jsx(ye,{title:"Loading Progress",value:`${s} / ${t}`,subtitle:"Successfully Loaded",percentage:l,color:"blue",showProgressRing:!0}),e.jsx(ye,{title:"Success Rate",value:`${d}%`,subtitle:`${r} failed`,percentage:d,color:"green",showProgressRing:!0}),e.jsx(ye,{title:"System Status",value:s>0?"Ready":"Loading",subtitle:`${s} plugins active`,percentage:c,color:"green",showProgressRing:!0})]}),e.jsxs("div",{className:"metric-grid-bottom",children:[e.jsx(me,{label:"Total Plugins",value:t}),e.jsx(me,{label:"Loaded",value:s}),e.jsx(me,{label:"Failed",value:r}),e.jsx(me,{label:"Routes",value:n}),e.jsx(me,{label:"Topics",value:a})]})]})})]})},kt=({plugins:s,loadedPluginIds:t,searchTerm:r})=>{const n=s.filter(a=>!r||a.id.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Available Plugins"}),e.jsx("span",{className:"panel-badge",children:n.length})]}),e.jsx("div",{className:"panel-content",children:n.map(a=>e.jsxs("div",{className:"plugin-item",children:[e.jsxs("div",{className:"plugin-header",children:[e.jsx("h4",{className:"plugin-name",children:a.id}),e.jsx("div",{className:"plugin-actions",children:e.jsx("span",{className:`plugin-status ${t.has(a.id)?"status-loaded":"status-unloaded"}`,children:t.has(a.id)?"Loaded":"Unloaded"})})]}),e.jsxs("div",{className:"plugin-details",children:[a.ui&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"UI:"}),e.jsx("span",{className:"code",children:a.ui.slot})," →",e.jsxs("span",{className:"code",children:[a.ui.module,"#",a.ui.export]})]}),a.runtime&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Runtime:"}),e.jsxs("span",{className:"code",children:[a.runtime.module,"#",a.runtime.export]})]}),!a.ui&&!a.runtime&&e.jsx("div",{className:"detail-row",style:{color:"var(--text-muted)"},children:"No UI or runtime configuration"})]})]},a.id))})]})},It=({topicsMap:s,searchTerm:t,expandedItems:r,loading:n,conductor:a,onToggleExpanded:i,onTestTopic:l})=>{const c=Array.from(s.entries()).filter(([p])=>!t||p.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Topics"}),e.jsx("span",{className:"panel-badge",children:c.length})]}),e.jsx("div",{className:"panel-content",children:c.map(([p,h])=>e.jsxs("div",{className:"topic-item",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{className:`topic-name expandable ${r.has(p)?"expanded":""}`,onClick:()=>i(p),style:{flex:1},children:p}),e.jsx("button",{className:"btn btn-primary",onClick:()=>l(p),disabled:n||!a,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:"Test"})]}),e.jsxs("div",{className:"topic-routes",children:[h.routes.length," route(s) • ",h.visibility||"public"]}),e.jsxs("div",{className:`expandable-content ${r.has(p)?"expanded":""}`,children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Routes:"}),h.routes.map((u,g)=>e.jsxs("div",{style:{marginLeft:"1rem",fontSize:"0.8125rem"},children:["→ ",e.jsx("span",{className:"code",children:u.pluginId})," / ",e.jsx("span",{className:"code",children:u.sequenceId})]},g))]}),h.notes&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Notes:"})," ",h.notes]}),h.perf&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Performance:"}),h.perf.throttleMs&&` throttle: ${h.perf.throttleMs}ms`,h.perf.debounceMs&&` debounce: ${h.perf.debounceMs}ms`,h.perf.dedupeWindowMs&&` dedupe: ${h.perf.dedupeWindowMs}ms`]}),h.payloadSchema&&e.jsxs("div",{children:[e.jsx("strong",{children:"Payload Schema:"}),e.jsx("pre",{style:{fontSize:"0.75rem",background:"var(--bg-tertiary)",padding:"0.5rem",borderRadius:"4px",overflow:"auto",maxHeight:"200px"},children:JSON.stringify(h.payloadSchema,null,2)})]})]})]},p))})]})},qt=({routes:s,routeCount:t,searchTerm:r,loading:n,conductor:a,onTestInteraction:i})=>{const l=s?.filter(d=>!r||d.route.toLowerCase().includes(r.toLowerCase()))||[];return e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Interaction Routes"}),e.jsx("span",{className:"panel-badge",children:t})]}),e.jsx("div",{className:"panel-content",children:l.map((d,c)=>e.jsx("div",{className:"route-item",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:"route-name",children:d.route}),e.jsxs("div",{className:"route-target",children:["→ ",e.jsx("span",{className:"code",children:d.pluginId})," / ",e.jsx("span",{className:"code",children:d.sequenceId})]})]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>i(d.route),disabled:n||!a,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:"Test"})]})},c))})]})},$t=({components:s,searchTerm:t})=>{const r=s.filter(n=>!t||n.id?.toLowerCase().includes(t.toLowerCase())||n.metadata?.name?.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Components"}),e.jsx("span",{className:"panel-badge",children:s.length})]}),e.jsx("div",{className:"panel-content",children:r.map(n=>e.jsxs("div",{className:"plugin-item",children:[e.jsx("div",{className:"plugin-header",children:e.jsx("h4",{className:"plugin-name",children:n.id})}),e.jsxs("div",{className:"plugin-details",children:[n.metadata?.name&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Name:"})," ",n.metadata.name]}),n.metadata?.description&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Description:"})," ",n.metadata.description]}),n.metadata?.type&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Type:"})," ",e.jsx("span",{className:"code",children:n.metadata.type})]})]})]},n.id))})]})},Et=({introspection:s})=>s?e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h3",{className:"panel-title",children:"Conductor Introspection"})}),e.jsxs("div",{className:"panel-content",children:[e.jsxs("div",{className:"plugin-item",children:[e.jsx("h4",{className:"plugin-name",children:"Mounted Plugin IDs"}),e.jsx("div",{className:"plugin-details",children:s.mountedPluginIds.length>0?s.mountedPluginIds.map(t=>e.jsx("div",{className:"detail-row",children:e.jsx("span",{className:"code",children:t})},t)):e.jsx("div",{className:"detail-row",style:{color:"var(--text-muted)"},children:"No plugins mounted"})})]}),e.jsxs("div",{className:"plugin-item",children:[e.jsx("h4",{className:"plugin-name",children:"Runtime Mounted Sequence IDs"}),e.jsx("div",{className:"plugin-details",children:s.runtimeMountedSeqIds.length>0?s.runtimeMountedSeqIds.map(t=>e.jsx("div",{className:"detail-row",children:e.jsx("span",{className:"code",children:t})},t)):e.jsx("div",{className:"detail-row",style:{color:"var(--text-muted)"},children:"No sequences mounted"})})]}),e.jsxs("div",{className:"plugin-item",children:[e.jsx("h4",{className:"plugin-name",children:"Sequence Catalog Directories"}),e.jsx("div",{className:"plugin-details",children:s.sequenceCatalogDirs.length>0?s.sequenceCatalogDirs.map(t=>e.jsx("div",{className:"detail-row",children:e.jsx("span",{className:"code",children:t})},t)):e.jsx("div",{className:"detail-row",style:{color:"var(--text-muted)"},children:"No catalog directories"})})]})]})]}):e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h3",{className:"panel-title",children:"Conductor Introspection"})}),e.jsx("div",{className:"panel-content",children:e.jsx("div",{style:{color:"var(--text-muted)"},children:"No introspection data available"})})]}),Mt=({conductor:s,performanceMetrics:t,interactionStatsLoaded:r,topicsStatsLoaded:n,logs:a})=>{const i=a.filter(c=>c.level==="error").length,l=a.length>0?Math.round(i/a.length*100):0,d=[r,n].filter(Boolean).length;return e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Performance Metrics"}),e.jsx("span",{className:"panel-badge",children:Object.keys(t).length})]}),e.jsxs("div",{className:"panel-content",children:[e.jsxs("div",{className:"plugin-item",children:[e.jsx("h4",{className:"plugin-name",children:"System Health"}),e.jsxs("div",{className:"plugin-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Conductor Status:"}),e.jsx("span",{className:"code",style:{color:s?"var(--success-color)":"var(--danger-color)"},children:s?"Connected":"Disconnected"})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Manifests Loaded:"}),e.jsxs("span",{className:"code",style:{color:"var(--success-color)"},children:[d,"/2"]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Active Logs:"}),e.jsx("span",{className:"code",children:a.length})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Error Rate:"}),e.jsxs("span",{className:"code",style:{color:i>0?"var(--danger-color)":"var(--success-color)"},children:[l,"%"]})]})]})]}),Object.keys(t).length>0&&e.jsxs("div",{className:"plugin-item",children:[e.jsx("h4",{className:"plugin-name",children:"Test Execution Times"}),e.jsx("div",{className:"plugin-details",children:Object.entries(t).sort(([,c],[,p])=>p-c).map(([c,p])=>e.jsxs("div",{className:"detail-row",children:[e.jsxs("span",{className:"detail-label",children:[c.replace(/_/g," "),":"]}),e.jsxs("span",{className:"code",style:{color:p>1e3?"var(--danger-color)":p>500?"var(--warning-color)":"var(--success-color)"},children:[p,"ms"]})]},c))})]})]})]})},Tt=({logs:s})=>e.jsxs("div",{className:"logs-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"System Logs"}),e.jsx("span",{className:"panel-badge",children:s.length})]}),e.jsxs("div",{className:"logs-content",children:[s.map((t,r)=>e.jsxs("div",{className:"log-entry",children:[e.jsxs("span",{className:"log-timestamp",children:["[",t.timestamp,"]"]})," ",e.jsx("span",{className:`log-level-${t.level}`,children:t.level.toUpperCase()})," ",t.message,t.data&&e.jsx("div",{style:{marginLeft:"1rem",color:"#569cd6"},children:typeof t.data=="string"?t.data:JSON.stringify(t.data)})]},r)),s.length===0&&e.jsx("div",{style:{color:"var(--text-muted)"},children:"No logs yet..."})]})]}),Rt=({selectedNodePath:s,loadedPluginsCount:t,totalPluginsCount:r,routeCount:n,topicCount:a,logs:i,onExport:l,onRefresh:d})=>{const c=i.filter(p=>p.level==="error").length;return e.jsxs("footer",{className:"footer-panel",children:[e.jsxs("div",{className:"footer-section",children:[e.jsx("strong",{children:"Selected:"})," ",s||"None"]}),e.jsxs("div",{className:"footer-section footer-stats",children:[e.jsxs("span",{className:"footer-stat",children:[e.jsx("span",{className:"footer-stat-label",children:"Plugins:"}),e.jsxs("span",{className:"footer-stat-value",children:[t,"/",r]})]}),e.jsxs("span",{className:"footer-stat",children:[e.jsx("span",{className:"footer-stat-label",children:"Routes:"}),e.jsx("span",{className:"footer-stat-value",children:n})]}),e.jsxs("span",{className:"footer-stat",children:[e.jsx("span",{className:"footer-stat-label",children:"Topics:"}),e.jsx("span",{className:"footer-stat-value",children:a})]}),e.jsxs("span",{className:"footer-stat",children:[e.jsx("span",{className:"footer-stat-label",children:"Errors:"}),e.jsx("span",{className:"footer-stat-value",style:{color:c>0?"var(--danger-color)":"var(--success-color)"},children:c})]})]}),e.jsxs("div",{className:"footer-section footer-actions",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:l,title:"Export diagnostics report",children:"📊 Export"}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:d,title:"Refresh statistics",children:"🔄 Refresh"})]})]})},_t=({loading:s,onRefresh:t,onExport:r,onClearLogs:n})=>e.jsx("div",{className:"toolbar",children:e.jsxs("div",{className:"toolbar-section",children:[e.jsxs("button",{className:"btn btn-secondary btn-icon btn-sm",onClick:t,disabled:s,children:[e.jsx("span",{className:"icon",children:"🔄"}),"Refresh Stats"]}),e.jsxs("button",{className:"btn btn-warning btn-icon btn-sm",onClick:r,children:[e.jsx("span",{className:"icon",children:"📊"}),"Export Logs"]}),e.jsxs("button",{className:"btn btn-danger btn-icon btn-sm",onClick:n,children:[e.jsx("span",{className:"icon",children:"🗑️"}),"Clear Logs"]})]})});async function Ue(){try{const s=await fetch("/plugins/plugin-manifest.json");return s.ok?await s.json():(console.warn("Failed to load plugin manifest:",s.statusText),null)}catch(s){return console.error("Error loading plugin manifest:",s),null}}function Lt(s){return{CanvasComponentPlugin:"canvas-component",LibraryPlugin:"library",LibraryComponentPlugin:"library-component",ControlPanelPlugin:"control-panel",HeaderTitlePlugin:"header",HeaderControlsPlugin:"header",HeaderThemePlugin:"header",CanvasPlugin:"canvas"}[s]||s}async function Je(s){try{const t=Lt(s),r=await fetch(`/json-sequences/${t}/index.json`);if(!r.ok)return[];const n=await r.json(),a=[];if(Array.isArray(n.sequences))for(const i of n.sequences)try{const l=i.file||i,d=await fetch(`/json-sequences/${t}/${l}`);if(d.ok){const c=await d.json(),p=[];if(Array.isArray(c.movements)){for(const h of c.movements)if(Array.isArray(h.beats))for(const u of h.beats)u.handler&&!p.find(g=>g.name===u.handler)&&p.push({name:u.handler})}a.push({id:c.id||l.replace(".json",""),name:c.name||c.id||l.replace(".json",""),description:c.description,handlers:p.length>0?p:void 0,movements:c.movements?.map(h=>({from:h.id||"start",to:h.id||"end"})),parameters:c.parameters,returns:c.returns})}}catch(l){console.warn(`Failed to load sequence ${i}:`,l)}return a}catch(t){return console.warn(`Failed to load sequences for plugin ${s}:`,t),[]}}function Pt(s){let t=s.ui;return s.ui&&!s.ui.dependencies&&!s.ui.props&&!s.ui.events&&s.id==="LibraryPlugin"&&(t={...s.ui,dependencies:[{name:"react",version:"18.2.0",size:"42.3 KB",license:"MIT"},{name:"lucide-react",version:"0.263.1",size:"156 KB",license:"ISC"}],props:{theme:{type:"string",default:"light",required:!1,validation:{enum:["light","dark"]}},onComponentSelect:{type:"function",required:!0}},events:[{name:"component.selected",payloadSchema:{componentId:"string"},frequency:"on-demand",subscribers:["ControlPanelPlugin"]}],styling:{cssClasses:["library-panel","scrollable"],themeVariables:{"--library-bg":"#ffffff","--library-border":"#e0e0e0"}},lifecycleHooks:{onMount:"initializeLibrary",onUpdate:"refreshComponents",onUnmount:"cleanup"}}),{...s,ui:t}}async function Dt(s){let t=s.runtime;if(s.runtime){const r=await Je(s.id);t={...s.runtime,sequences:r.length>0?r:void 0}}return{...s,runtime:t}}async function Ot(s){let t=Pt(s);return t=await Dt(t),{...t,version:t.version||"1.0.0",status:t.status||"loaded",topics:t.topics||{subscribes:[],publishes:[]},sequences:t.sequences||[]}}async function At(s){return Promise.all(s.map(t=>Ot(t)))}function He(s){try{return{mountedPluginIds:s?.getMountedPluginIds?.()||[],discoveredPlugins:s?._discoveredPlugins||[],runtimeMountedSeqIds:Array.from(s?._runtimeMountedSeqIds||[]),sequenceCatalogDirs:s?._sequenceCatalogDirsFromManifest||[]}}catch(t){return console.warn("Failed to introspect conductor:",t),{mountedPluginIds:[],discoveredPlugins:[],runtimeMountedSeqIds:[],sequenceCatalogDirs:[]}}}async function Ft(){try{const s=await fetch("/interaction-manifest.json");let t=null;s.ok&&(t=await s.json());const r=Ne();let n=[];t&&t.routes&&(n=Object.entries(t.routes).map(([i,l])=>({route:i,pluginId:l.pluginId,sequenceId:l.sequenceId})));const a=[];if(r.totalInteractions>0)try{const i=["component.create","component.select","component.update"];for(const l of i)try{const d=Ce(l);d&&a.push({id:l,...d})}catch{}}catch(i){console.warn("Failed to load detailed interactions:",i)}return{...r,routes:n,interactions:a}}catch(s){return console.warn("Failed to load interaction manifest data:",s),Ne()}}function Bt(){return De()}async function zt(){return Le()}async function Ut(){try{return await Pe()}catch(s){return console.warn("Failed to load components:",s),[]}}async function Jt(){const[s,t,r,n]=await Promise.all([Ft(),Promise.resolve(Bt()),zt(),Ut()]);return{interactionStats:s,topicsStats:t,pluginStats:r,components:n}}function Ht(s){try{return s.format==="json"?Vt(s.content):Xt(s.content)}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown parsing error"}}}function Vt(s){try{let t=JSON.parse(s);if(Array.isArray(t)){if(t.length===0)return{success:!1,error:"Empty execution array"};t=t[0]}if(!t.sequenceId||!t.pluginId||!t.requestId)return{success:!1,error:"Missing required fields: sequenceId, pluginId, or requestId"};const r=[];let n=0,a=!1;if(Array.isArray(t.movements))for(const l of t.movements){const d=Kt(l);r.push(d),n+=d.duration,d.status==="error"&&(a=!0)}return{success:!0,execution:{sequenceId:t.sequenceId,sequenceName:t.sequenceName||t.sequenceId,pluginId:t.pluginId,requestId:t.requestId,movements:r,totalDuration:t.totalDuration||n,status:a?"error":"success",startTime:t.startTime,endTime:t.endTime,error:t.error}}}catch(t){return{success:!1,error:`JSON parsing failed: ${t instanceof Error?t.message:"Unknown error"}`}}}function Xt(s){try{const t=s.split(`
`).filter(u=>u.trim());let r="",n="",a="",i="";const l=[];let d=null,c=0,p=!1;for(const u of t){const g=u.match(/sequenceId[:\s]+([^\s,]+)/i);g&&(r=g[1]);const x=u.match(/sequenceName[:\s]+([^\s,]+)/i);x&&(n=x[1]);const j=u.match(/pluginId[:\s]+([^\s,]+)/i);j&&(a=j[1]);const y=u.match(/requestId[:\s]+([^\s,]+)/i);y&&(i=y[1]);const S=u.match(/movement[:\s]+([^\s,]+)/i);S&&(d&&d.name&&l.push(d),d={name:S[1],beats:[],duration:0,status:"success"});const f=u.match(/beat[:\s]+(\d+)[,\s]+event[:\s]+([^\s,]+)[,\s]+duration[:\s]+(\d+)/i);if(f&&d){const N={number:parseInt(f[1],10),event:f[2],duration:parseInt(f[3],10),status:"success"};d.beats=d.beats||[],d.beats.push(N),d.duration=(d.duration||0)+N.duration}u.toLowerCase().includes("error")&&(p=!0,d&&(d.status="error"))}return d&&d.name&&l.push(d),c=l.reduce((u,g)=>u+g.duration,0),!r||!a||!i?{success:!1,error:"Could not extract required fields from text log"}:{success:!0,execution:{sequenceId:r,sequenceName:n||r,pluginId:a,requestId:i,movements:l,totalDuration:c,status:p?"error":"success"}}}catch(t){return{success:!1,error:`Text parsing failed: ${t instanceof Error?t.message:"Unknown error"}`}}}function Kt(s){const t=[];let r=0,n=!1;if(Array.isArray(s.beats))for(const a of s.beats){const i={number:a.number||0,event:a.event||"",duration:a.duration||0,dataBaton:a.dataBaton,timestamp:a.timestamp,status:a.status||"success",error:a.error};t.push(i),r+=i.duration,i.status==="error"&&(n=!0)}return{name:s.name||"unknown",beats:t,duration:s.duration||r,status:n?"error":s.status||"success"}}function pe(s){let t=0,r=0,n=0,a;for(const l of s.movements)for(const d of l.beats)t++,d.status==="error"?n++:r++,(!a||d.duration>a.duration)&&(a={movement:l.name,beat:d.number,duration:d.duration});const i=t>0?s.totalDuration/t:0;return{totalMovements:s.movements.length,totalBeats:t,totalDuration:s.totalDuration,avgBeatDuration:Math.round(i),slowestBeat:a,successfulBeats:r,failedBeats:n}}function Wt(s){return JSON.stringify(s,null,2)}function Ve(s){const t=s.split(`
`).map((a,i)=>({lineNumber:i+1,content:a.trim()})).filter(a=>a.content.length>0),r=new Map;let n=null;for(const a of t){Qt(a,r,n);const i=a.content.match(/PluginInterfaceFacade\.play\(\):\s*(\w+)\s*->/);i&&(n=i[1])}return Array.from(r.values()).map(a=>Zt(a))}function Qt(s,t,r){const n=s.content,a=n.match(/SequenceOrchestrator.*Recording sequence execution:\s*(\S+)/);if(a){const j=a[1];t.set(j,{executionId:j,sequenceId:"",sequenceName:"",pluginId:r||"",requestId:"",movements:new Map});return}const i=n.match(/Sequence:\s*(.+?)(?:\s*$|🆔)/);if(i){const j=i[1].trim(),y=G(t);y&&(y.sequenceName=j,y.sequenceId=Yt(j));return}const l=n.match(/PluginInterfaceFacade\.play\(\):\s*(\w+)\s*->/);if(l){const j=l[1],y=G(t);y&&(y.pluginId=j);return}const d=n.match(/Request ID:\s*(\S+)/);if(d){const j=d[1],y=G(t);y&&(y.requestId=j);return}const c=n.match(/Movement Started:\s*(.+?)\s*\((\d+)\s*beats?\)/);if(c){const j=c[1].trim();parseInt(c[2],10);const y=G(t);y&&(y.currentMovement=j,y.movements.set(j,{name:j,beats:[],status:"pending"}));return}const p=n.match(/Beat (\d+) Started:\s*(.+?)\s*\(([^)]+)\)/);if(p){const j=parseInt(p[1],10);p[2].trim();const y=p[3].trim(),S=G(t);if(S&&S.currentMovement){const f=S.movements.get(S.currentMovement);f&&f.beats.push({number:j,event:y,status:"pending"})}return}const h=n.match(/Beat (\d+) completed in ([\d.]+)ms/);if(h){const j=parseInt(h[1],10),y=parseFloat(h[2]),S=G(t);if(S&&S.currentMovement){const f=S.movements.get(S.currentMovement);if(f){const N=f.beats.find(q=>q.number===j);N&&(N.duration=y,N.status="success")}}return}const u=n.match(/🎽 DataBaton:.*preview=(\{.+\})$/);if(u){try{const j=u[1],y=JSON.parse(j),S=G(t);if(S&&S.currentMovement){const f=S.movements.get(S.currentMovement);if(f&&f.beats.length>0){const N=f.beats[f.beats.length-1];N.dataBaton||(N.dataBaton=y)}}}catch{}return}const g=n.match(/Movement completed in ([\d.]+)ms/);if(g){const j=parseFloat(g[1]),y=G(t);if(y&&y.currentMovement){const S=y.movements.get(y.currentMovement);S&&(S.duration=j,S.status="success")}return}const x=n.match(/Sequence "(.+?)" completed in (\d+)ms/);if(x){const j=x[1];parseInt(x[2],10);for(const[y,S]of t.entries())if(S.sequenceName===j&&!S.startTime)break;return}}function G(s){const t=Array.from(s.values());return t[t.length-1]}function Zt(s){const t=Array.from(s.movements.values()).map(n=>({name:n.name,beats:n.beats.map(a=>({number:a.number,event:a.event,duration:a.duration||0,status:a.status,timestamp:a.startTime||new Date().toISOString(),dataBaton:a.dataBaton})),duration:n.duration||n.beats.reduce((a,i)=>a+(i.duration||0),0),status:n.status})),r=t.reduce((n,a)=>n+a.duration,0);return{sequenceId:s.sequenceId||"unknown",sequenceName:s.sequenceName||"Unknown Sequence",pluginId:s.pluginId||"UnknownPlugin",requestId:s.requestId||s.executionId,movements:t,totalDuration:r,status:t.every(n=>n.status==="success")?"success":t.some(n=>n.status==="error")?"error":"pending",startTime:s.startTime||new Date().toISOString(),endTime:s.endTime||new Date().toISOString()}}function Yt(s){return s.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}function Xe(){const s=globalThis.RenderX?.conductor;if(!s)throw new Error("Conductor not initialized");return s}function Ke(){return!!globalThis.RenderX?.conductor}async function Gt(){try{const s=Xe(),t=await Ue();if(!t)return console.warn("Failed to load manifest, returning empty sequence list"),[];const r=He(s),n=[];for(const a of t.plugins){const i=await Je(a.id);for(const l of i){const d=l.id,c=r.runtimeMountedSeqIds.includes(d);n.push({sequenceId:d,sequenceName:l.name||d,pluginId:a.id,description:l.description,parameters:l.parameters,isMounted:c})}}return n}catch(s){return console.error("Failed to get available sequences:",s),[]}}async function en(s,t,r){try{const n=Xe(),a=We(t);return await n.play(s,t,r),a}catch(n){throw console.error("Failed to execute sequence:",n),n}}function We(s){const t=Date.now(),r=Math.random().toString(36).substr(2,9);return`${s}-symphony-${t}-${r}`}function Se(s){if(!s.trim())return{valid:!0,data:{}};try{const t=JSON.parse(s);return typeof t!="object"||t===null||Array.isArray(t)?{valid:!1,error:"Parameters must be a JSON object"}:{valid:!0,data:t}}catch(t){return{valid:!1,error:t instanceof Error?t.message:"Invalid JSON"}}}function sn(s,t){s.beats.filter(n=>n.status==="success").length;const r=s.totalDuration||(s.endTime&&s.startTime?new Date(s.endTime).getTime()-new Date(s.startTime).getTime():0);return{sequenceId:s.sequenceId,sequenceName:t,pluginId:s.pluginId,requestId:s.requestId,status:s.status==="success"?"success":"error",startTime:s.startTime,endTime:s.endTime||new Date().toISOString(),totalDuration:r,beatCount:s.beats.length,parameters:s.parameters,error:s.error,execution:s}}function tn(s,t){const[r,n]=m.useState(null),[a,i]=m.useState(null),[l,d]=m.useState(null),[c,p]=m.useState(null),[h,u]=m.useState([]),[g,x]=m.useState(!1),[j,y]=m.useState(null),S=m.useCallback(async()=>{x(!0),y(null);try{t?.("info","Loading plugin manifest...");const N=await Ue();if(!N){t?.("warn","Failed to load plugin manifest");return}t?.("info","Enriching plugin data with sequence information...");const q=await At(N.plugins||[]),z={...N,plugins:q};n(z),t?.("info",`Loaded ${q.length} plugins from manifest`),t?.("info","Loading statistics...");const J=await Jt();i(J.interactionStats),d(J.topicsStats),p(J.pluginStats),u(J.components),t?.("info","Diagnostics data loaded successfully")}catch(N){const q=N instanceof Error?N.message:"Unknown error";y(N instanceof Error?N:new Error(q)),t?.("error","Failed to load diagnostics data",N)}finally{x(!1)}},[t]),f=m.useCallback(async()=>{await S()},[S]);return m.useEffect(()=>{S()},[S]),{manifest:r,interactionStats:a,topicsStats:l,pluginStats:c,components:h,loading:g,error:j,refresh:f}}function nn(s){const[t,r]=m.useState(null),n=m.useCallback(()=>{if(s){const a=He(s);r(a)}},[s]);return m.useEffect(()=>{n()},[n]),{introspection:t,refresh:n}}function rn(s,t){m.useEffect(()=>{if(!s)return;const r=[];return["plugin.mounted","plugin.unmounted","sequence.executed","sequence.failed","component.created","component.updated","component.deleted","error.occurred"].forEach(a=>{try{const i=xe.subscribe(a,l=>{const d=a.includes("failed")||a.includes("error")?"error":"info";t(d,`Event: ${a}`,l)});r.push(i)}catch(i){console.warn(`Failed to subscribe to topic: ${a}`,i)}}),()=>{r.forEach(a=>{try{a()}catch(i){console.warn("Failed to unsubscribe from topic",i)}})}},[s,t])}function an(){const[s,t]=m.useState({}),r=m.useCallback((i,l)=>{t(d=>({...d,[i]:l}))},[]),n=m.useCallback(()=>{t({})},[]),a=m.useCallback(i=>s[i],[s]);return{metrics:s,trackMetric:r,clearMetrics:n,getMetric:a}}function on(){const[s,t]=m.useState({totalPlugins:0,loadedPlugins:0,failedPlugins:0,loadingTime:0}),r=m.useCallback(a=>{t(i=>({...i,...a}))},[]),n=m.useCallback(()=>{t({totalPlugins:0,loadedPlugins:0,failedPlugins:0,loadingTime:0})},[]);return{stats:s,updateStats:r,resetStats:n}}function ln(){const[s,t]=m.useState([]),r=m.useCallback((a,i,l)=>{const d={timestamp:new Date().toLocaleTimeString(),level:a,message:i,data:l};t(c=>[...c.slice(-99),d])},[]),n=m.useCallback(()=>{t([])},[]);return{logs:s,addLog:r,clearLogs:n}}function cn(){const[s,t]=m.useState(null),[r,n]=m.useState(null),[a,i]=m.useState(null),[l,d]=m.useState(!1),[c,p]=m.useState(!1),[h,u]=m.useState([]),[g,x]=m.useState(0),j=m.useCallback(L=>{d(!0),i(null),p(!1),x(0);try{if(L.format==="json")try{const F=JSON.parse(L.content);if(Array.isArray(F)&&F.length>0){const P=[];for(const R of F)R.sequenceId&&R.pluginId&&R.requestId&&P.push(R);if(P.length>0){u(P),t(P[0]),n(pe(P[0])),i(null),d(!1);return}}}catch{}const O=Ht(L);if(O.success&&O.execution)u([O.execution]),t(O.execution),n(pe(O.execution)),i(null);else{try{const F=Ve(L.content);if(F.length>0){u(F),t(F[0]),n(pe(F[0])),i(null),p(!0);return}}catch{}u([]),t(null),n(null),i(O.error||"Unknown parsing error")}}catch(O){u([]),t(null),n(null),i(O instanceof Error?O.message:"Unexpected error")}finally{d(!1)}},[]),y=m.useCallback(L=>{j({content:L,format:"json"})},[j]),S=m.useCallback(L=>{j({content:L,format:"text"})},[j]),f=m.useCallback(L=>{L>=0&&L<h.length&&(x(L),t(h[L]),n(pe(h[L])))},[h]),N=m.useCallback(()=>{g<h.length-1&&f(g+1)},[g,h.length,f]),q=m.useCallback(()=>{g>0&&f(g-1)},[g,f]),z=m.useCallback(()=>{t(null),n(null),i(null),p(!1),u([]),x(0)},[]),J=m.useCallback(()=>s?Wt(s):null,[s]);return{execution:s,stats:r,error:a,isLoading:l,autoConverted:c,allExecutions:h,currentIndex:g,totalSequences:h.length,hasMultipleSequences:h.length>1,parse:j,parseJson:y,parseText:S,clear:z,exportJson:J,goToSequence:f,nextSequence:N,prevSequence:q}}function dn(){const[s,t]=m.useState([]),[r,n]=m.useState(!1),[a,i]=m.useState(null),[l,d]=m.useState(""),[c,p]=m.useState("all"),[h,u]=m.useState(!1),g=m.useCallback(async()=>{if(!Ke()){i("Conductor not available");return}n(!0),i(null);try{const f=await Gt();t(f)}catch(f){i(f instanceof Error?f.message:"Failed to load sequences"),console.error("Failed to load sequences:",f)}finally{n(!1)}},[]);m.useEffect(()=>{g()},[g]);const x=m.useMemo(()=>{let f=s;if(l.trim()){const N=l.toLowerCase();f=f.filter(q=>q.sequenceName.toLowerCase().includes(N)||q.sequenceId.toLowerCase().includes(N)||q.pluginId.toLowerCase().includes(N)||q.description?.toLowerCase().includes(N))}return c!=="all"&&(f=f.filter(N=>N.pluginId===c)),h&&(f=f.filter(N=>N.isMounted)),f},[s,l,c,h]),j=m.useMemo(()=>{const f={};return x.forEach(N=>{f[N.pluginId]||(f[N.pluginId]=[]),f[N.pluginId].push(N)}),f},[x]),y=m.useMemo(()=>{const f=new Set(s.map(N=>N.pluginId));return Array.from(f).sort()},[s]),S=m.useMemo(()=>{const f=s.length,N=s.filter(z=>z.isMounted).length,q=x.length;return{total:f,mounted:N,unmounted:f-N,filtered:q,pluginCount:y.length}},[s,x,y]);return{sequences:x,groupedSequences:j,pluginIds:y,stats:S,isLoading:r,error:a,searchQuery:l,setSearchQuery:d,filterPlugin:c,setFilterPlugin:p,showMountedOnly:h,setShowMountedOnly:u,refresh:g}}function un(){const[s,t]=m.useState(null),[r,n]=m.useState(!1),[a,i]=m.useState(null),l=m.useRef(null),d=m.useCallback(async(h,u)=>{n(!0),i(null);try{const g=We(h.sequenceId);l.current=g;const x={sequenceId:h.sequenceId,pluginId:h.pluginId,requestId:g,status:"running",startTime:new Date().toISOString(),beats:[],parameters:u};t(x),await en(h.pluginId,h.sequenceId,u),setTimeout(()=>{l.current===g&&(t(j=>j?{...j,status:"success",endTime:new Date().toISOString(),totalDuration:j.startTime?new Date().getTime()-new Date(j.startTime).getTime():0}:null),n(!1))},1e3)}catch(g){i(g instanceof Error?g.message:"Failed to execute sequence"),t(x=>x?{...x,status:"error",endTime:new Date().toISOString(),error:g instanceof Error?g.message:"Unknown error"}:null),n(!1),console.error("Failed to execute sequence:",g)}},[]),c=m.useCallback(()=>{t(null),i(null),n(!1),l.current=null},[]),p=m.useCallback(()=>{r&&(t(h=>h?{...h,status:"error",endTime:new Date().toISOString(),error:"Cancelled by user"}:null),n(!1),l.current=null)},[r]);return m.useEffect(()=>()=>{l.current=null},[]),{liveExecution:s,isExecuting:r,error:a,execute:d,clear:c,cancel:p}}const mn=20;function hn(){const[s,t]=m.useState([]),[r,n]=m.useState({status:"all",pluginId:"all",searchQuery:""}),a=m.useCallback(u=>{const g=sn(u);t(x=>[g,...x].slice(0,mn))},[]),i=m.useCallback(()=>{t([])},[]),l=m.useCallback(u=>{t(g=>g.filter(x=>x.id!==u))},[]),d=m.useCallback(()=>s.filter(u=>{if(r.status!=="all"&&u.status!==r.status||r.pluginId!=="all"&&u.pluginId!==r.pluginId)return!1;if(r.searchQuery){const g=r.searchQuery.toLowerCase();return u.sequenceId.toLowerCase().includes(g)||u.pluginId.toLowerCase().includes(g)||u.error&&u.error.toLowerCase().includes(g)}return!0}),[s,r]),c=m.useCallback(()=>{const u=d();return{total:s.length,success:s.filter(g=>g.status==="success").length,error:s.filter(g=>g.status==="error").length,filtered:u.length,avgDuration:s.length>0?s.reduce((g,x)=>g+(x.totalDuration||0),0)/s.length:0}},[s,d]),p=m.useCallback(()=>{const u=new Set(s.map(g=>g.pluginId));return Array.from(u).sort()},[s]),h=m.useCallback(u=>s.find(g=>g.id===u),[s]);return{history:s,filteredHistory:d(),filter:r,setFilter:n,stats:c(),pluginIds:p(),addToHistory:a,clearHistory:i,removeFromHistory:l,findById:h}}const pn=({onParse:s,isLoading:t,error:r})=>{const[n,a]=m.useState(""),[i,l]=m.useState("json"),d=()=>{n.trim()&&s({content:n,format:i})},c=h=>{const u=h.target.files?.[0];if(!u)return;const g=new FileReader;g.onload=x=>{const j=x.target?.result;a(j),u.name.endsWith(".json")||j.trim().startsWith("{")?l("json"):l("text")},g.readAsText(u)},p=()=>{a("")};return e.jsxs("div",{className:"log-parser",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h3",{className:"panel-title",children:"Log Input"})}),e.jsxs("div",{className:"log-parser-content",children:[e.jsxs("div",{className:"log-parser-controls",children:[e.jsxs("div",{className:"format-selector",children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"json",checked:i==="json",onChange:h=>l(h.target.value)}),"JSON"]}),e.jsxs("label",{style:{marginLeft:"1rem"},children:[e.jsx("input",{type:"radio",value:"text",checked:i==="text",onChange:h=>l(h.target.value)}),"Text"]})]}),e.jsxs("div",{className:"file-upload",children:[e.jsx("input",{type:"file",accept:".json,.txt,.log",onChange:c,style:{display:"none"},id:"log-file-input"}),e.jsx("label",{htmlFor:"log-file-input",className:"button-secondary",children:"Upload File"})]})]}),e.jsx("textarea",{className:"log-input-area",value:n,onChange:h=>a(h.target.value),placeholder:`Paste ${i.toUpperCase()} log content here...`,rows:10,style:{width:"100%",fontFamily:"monospace",fontSize:"0.9rem",padding:"0.5rem",marginTop:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px"}}),r&&e.jsxs("div",{className:"error-message",style:{color:"var(--error-color)",marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"rgba(255, 0, 0, 0.1)",borderRadius:"4px"},children:["❌ ",r]}),e.jsxs("div",{className:"log-parser-actions",style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:d,disabled:!n.trim()||t,className:"button-primary",style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-color)",color:"white",border:"none",borderRadius:"4px",cursor:n.trim()&&!t?"pointer":"not-allowed",opacity:n.trim()&&!t?1:.5},children:t?"Parsing...":"Parse Log"}),e.jsx("button",{onClick:p,disabled:!n,className:"button-secondary",style:{padding:"0.5rem 1rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",cursor:n?"pointer":"not-allowed",opacity:n?1:.5},children:"Clear"})]})]})]})},gn=({execution:s})=>{const t=n=>{switch(n){case"success":return"✅";case"error":return"❌";case"pending":return"⏳";default:return"✅"}},r=n=>{switch(n){case"success":return"#4caf50";case"error":return"#f44336";case"pending":return"#ff9800";default:return"#4caf50"}};return e.jsxs("div",{className:"sequence-timeline",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Execution Timeline"}),e.jsxs("span",{className:"panel-badge",style:{backgroundColor:r(s.status)},children:[t(s.status)," ",s.status]})]}),e.jsxs("div",{className:"timeline-metadata",style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"4px",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Sequence:"})," ",s.sequenceName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Plugin:"})," ",s.pluginId]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Request ID:"})," ",s.requestId]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Total Duration:"})," ",s.totalDuration,"ms"]}),s.startTime&&e.jsxs("div",{children:[e.jsx("strong",{children:"Start Time:"})," ",s.startTime]}),s.endTime&&e.jsxs("div",{children:[e.jsx("strong",{children:"End Time:"})," ",s.endTime]}),s.error&&e.jsxs("div",{style:{color:"var(--error-color)",marginTop:"0.5rem"},children:[e.jsx("strong",{children:"Error:"})," ",s.error]})]}),e.jsx("div",{className:"timeline-movements",children:s.movements.map((n,a)=>e.jsx(fn,{movement:n},a))})]})},fn=({movement:s})=>{const t=n=>{switch(n){case"success":return"✅";case"error":return"❌";case"pending":return"⏳";default:return"✅"}},r=n=>{switch(n){case"success":return"#4caf50";case"error":return"#f44336";case"pending":return"#ff9800";default:return"#4caf50"}};return e.jsxs("div",{className:"movement",style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",borderLeft:`4px solid ${r(s.status)}`},children:[e.jsxs("div",{className:"movement-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem",fontWeight:"bold"},children:[e.jsxs("span",{children:[t(s.status)," ",s.name]}),e.jsxs("span",{children:[s.duration,"ms"]})]}),e.jsx("div",{className:"movement-beats",children:s.beats.map((n,a)=>e.jsx(xn,{beat:n},a))})]})},xn=({beat:s})=>{const[t,r]=K.useState(!1),n=a=>{switch(a){case"success":return"✅";case"error":return"❌";case"pending":return"⏳";default:return"✅"}};return e.jsxs("div",{className:"beat",style:{padding:"0.5rem",marginBottom:"0.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"4px",fontSize:"0.9rem"},children:[e.jsxs("div",{className:"beat-header",style:{display:"flex",justifyContent:"space-between",cursor:s.dataBaton?"pointer":"default"},onClick:()=>s.dataBaton&&r(!t),children:[e.jsxs("span",{children:[n(s.status)," Beat ",s.number,": ",s.event]}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[s.duration,"ms"]})]}),s.timestamp&&e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:s.timestamp}),s.error&&e.jsxs("div",{style:{color:"var(--error-color)",marginTop:"0.25rem",fontSize:"0.85rem"},children:["Error: ",s.error]}),s.dataBaton&&e.jsxs("div",{style:{marginTop:"0.5rem"},children:[e.jsxs("button",{onClick:()=>r(!t),style:{fontSize:"0.8rem",padding:"0.25rem 0.5rem",backgroundColor:"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"4px",cursor:"pointer",color:"var(--text-primary)"},children:[t?"▼":"▶"," Data Baton"]}),t&&e.jsx("pre",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"var(--bg-primary)",borderRadius:"4px",overflow:"auto",fontSize:"0.8rem",maxHeight:"200px"},children:JSON.stringify(s.dataBaton,null,2)})]})]})},vn=({stats:s,onExport:t})=>{const r=s.totalBeats>0?Math.round(s.successfulBeats/s.totalBeats*100):0;return e.jsxs("div",{className:"execution-stats",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{className:"panel-title",children:"Performance Stats"}),t&&e.jsx("button",{onClick:t,className:"button-secondary",style:{padding:"0.25rem 0.75rem",fontSize:"0.85rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",cursor:"pointer"},children:"Export JSON"})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsx(se,{label:"Total Movements",value:s.totalMovements,icon:"🎬"}),e.jsx(se,{label:"Total Beats",value:s.totalBeats,icon:"🥁"}),e.jsx(se,{label:"Total Duration",value:`${s.totalDuration}ms`,icon:"⏱️"}),e.jsx(se,{label:"Avg Beat Duration",value:`${s.avgBeatDuration}ms`,icon:"📊"}),e.jsx(se,{label:"Success Rate",value:`${r}%`,icon:r===100?"✅":r>50?"⚠️":"❌",color:r===100?"#4caf50":r>50?"#ff9800":"#f44336"}),e.jsx(se,{label:"Successful Beats",value:s.successfulBeats,icon:"✅",color:"#4caf50"}),e.jsx(se,{label:"Failed Beats",value:s.failedBeats,icon:"❌",color:s.failedBeats>0?"#f44336":void 0})]}),s.slowestBeat&&e.jsxs("div",{className:"slowest-beat",style:{padding:"1rem",margin:"0 1rem 1rem 1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"4px",borderLeft:"4px solid #ff9800"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:"🐌 Slowest Beat"}),e.jsxs("div",{style:{fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Movement:"})," ",s.slowestBeat.movement]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Beat:"})," ",s.slowestBeat.beat]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Duration:"})," ",s.slowestBeat.duration,"ms"]})]})]})]})},se=({label:s,value:t,icon:r,color:n})=>e.jsxs("div",{className:"stat-card",style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"4px",textAlign:"center",borderLeft:n?`4px solid ${n}`:void 0},children:[r&&e.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:r}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:n||"var(--text-primary)",marginBottom:"0.25rem"},children:t}),e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:s})]}),jn=({groupedSequences:s,searchQuery:t,onSearchChange:r,filterPlugin:n,onFilterChange:a,showMountedOnly:i,onMountedFilterChange:l,pluginIds:d,stats:c,onTriggerSequence:p,isLoading:h,error:u})=>{const[g,x]=K.useState(new Set),j=y=>{x(S=>{const f=new Set(S);return f.has(y)?f.delete(y):f.add(y),f})};return K.useEffect(()=>{Object.keys(s).length<=3&&x(new Set(Object.keys(s)))},[s]),u?e.jsxs("div",{className:"sequence-list-error",children:[e.jsx("span",{className:"error-icon",children:"⚠️"}),e.jsx("span",{children:u})]}):e.jsxs("div",{className:"sequence-list-container",children:[e.jsxs("div",{className:"sequence-list-header",children:[e.jsxs("h3",{className:"sequence-list-title",children:["Available Sequences (",c.filtered,")"]}),e.jsxs("div",{className:"sequence-list-stats",children:[e.jsxs("span",{className:"stat-badge",children:[c.total," total"]}),e.jsxs("span",{className:"stat-badge stat-badge-success",children:[c.mounted," mounted"]}),c.unmounted>0&&e.jsxs("span",{className:"stat-badge stat-badge-warning",children:[c.unmounted," unmounted"]})]})]}),e.jsxs("div",{className:"sequence-list-filters",children:[e.jsx("input",{type:"text",className:"sequence-search-input",placeholder:"Search sequences...",value:t,onChange:y=>r(y.target.value)}),e.jsxs("div",{className:"sequence-filter-row",children:[e.jsxs("select",{className:"sequence-filter-select",value:n,onChange:y=>a(y.target.value),children:[e.jsxs("option",{value:"all",children:["All Plugins (",c.pluginCount,")"]}),d.map(y=>e.jsx("option",{value:y,children:y},y))]}),e.jsxs("label",{className:"sequence-filter-checkbox",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:y=>l(y.target.checked)}),e.jsx("span",{children:"Mounted only"})]})]})]}),h&&e.jsx("div",{className:"sequence-list-loading",children:e.jsx("span",{children:"Loading sequences..."})}),!h&&Object.keys(s).length===0&&e.jsxs("div",{className:"sequence-list-empty",children:[e.jsx("span",{className:"empty-icon",children:"🔍"}),e.jsx("span",{children:"No sequences found"}),t&&e.jsx("button",{className:"button-link",onClick:()=>r(""),children:"Clear search"})]}),!h&&Object.keys(s).length>0&&e.jsx("div",{className:"sequence-list-groups",children:Object.entries(s).map(([y,S])=>e.jsxs("div",{className:"sequence-group",children:[e.jsxs("button",{className:"sequence-group-header",onClick:()=>j(y),children:[e.jsx("span",{className:"sequence-group-icon",children:g.has(y)?"▼":"▶"}),e.jsx("span",{className:"sequence-group-name",children:y}),e.jsxs("span",{className:"sequence-group-count",children:["(",S.length,")"]})]}),g.has(y)&&e.jsx("div",{className:"sequence-group-items",children:S.map(f=>e.jsxs("div",{className:`sequence-item ${f.isMounted?"":"sequence-item-unmounted"}`,children:[e.jsxs("div",{className:"sequence-item-info",children:[e.jsx("div",{className:"sequence-item-name",children:f.sequenceName}),e.jsx("div",{className:"sequence-item-id",children:f.sequenceId}),f.description&&e.jsx("div",{className:"sequence-item-description",children:f.description}),!f.isMounted&&e.jsx("div",{className:"sequence-item-warning",children:"⚠️ Not mounted"})]}),e.jsx("button",{className:"sequence-play-button",onClick:()=>p(f),disabled:!f.isMounted,title:f.isMounted?"Trigger sequence":"Sequence not mounted",children:"▶ Play"})]},f.sequenceId))})]},y))})]})},yn=({value:s,onChange:t,disabled:r,placeholder:n=`{
  "key": "value"
}`})=>{const[a,i]=m.useState(null),l=m.useCallback(c=>{if(t(c),c.trim()){const p=Se(c);i(p.valid?null:p.error||"Invalid JSON")}else i(null)},[t]),d=m.useCallback(()=>{if(s.trim()){const c=Se(s);i(c.valid?null:c.error||"Invalid JSON")}},[s]);return e.jsxs("div",{className:"parameter-editor",children:[e.jsx("label",{className:"parameter-editor-label",children:"Parameters (JSON)"}),e.jsx("textarea",{className:`parameter-editor-textarea ${a?"parameter-editor-error":""}`,value:s,onChange:c=>l(c.target.value),onBlur:d,disabled:r,placeholder:n,rows:6,spellCheck:!1}),a&&e.jsxs("div",{className:"parameter-editor-error-message",children:["⚠️ ",a]}),e.jsx("div",{className:"parameter-editor-hint",children:"Leave empty for no parameters, or enter a JSON object"})]})},bn=({sequence:s,isExecuting:t,onTrigger:r,onCancel:n})=>{const[a,i]=m.useState(""),[l,d]=m.useState(null),c=m.useCallback(()=>{if(!s)return;const h=Se(a);if(!h.valid){d(h.error||"Invalid parameters");return}d(null),r(s,h.data)},[s,a,r]),p=m.useCallback(()=>{i(""),d(null),n()},[n]);return s?e.jsxs("div",{className:"sequence-trigger-container",children:[e.jsxs("div",{className:"sequence-trigger-header",children:[e.jsx("h3",{className:"sequence-trigger-title",children:"Trigger Sequence"}),e.jsx("button",{className:"button-secondary",onClick:p,disabled:t,children:"Cancel"})]}),e.jsxs("div",{className:"sequence-trigger-info",children:[e.jsxs("div",{className:"sequence-trigger-info-row",children:[e.jsx("span",{className:"sequence-trigger-label",children:"Sequence:"}),e.jsx("span",{className:"sequence-trigger-value",children:s.sequenceName})]}),e.jsxs("div",{className:"sequence-trigger-info-row",children:[e.jsx("span",{className:"sequence-trigger-label",children:"ID:"}),e.jsx("span",{className:"sequence-trigger-value sequence-trigger-id",children:s.sequenceId})]}),e.jsxs("div",{className:"sequence-trigger-info-row",children:[e.jsx("span",{className:"sequence-trigger-label",children:"Plugin:"}),e.jsx("span",{className:"sequence-trigger-value",children:s.pluginId})]}),s.description&&e.jsxs("div",{className:"sequence-trigger-info-row",children:[e.jsx("span",{className:"sequence-trigger-label",children:"Description:"}),e.jsx("span",{className:"sequence-trigger-value",children:s.description})]})]}),e.jsx(yn,{value:a,onChange:i,disabled:t}),l&&e.jsxs("div",{className:"sequence-trigger-error",children:["⚠️ ",l]}),e.jsxs("div",{className:"sequence-trigger-actions",children:[e.jsx("button",{className:"sequence-trigger-button",onClick:c,disabled:t||!s.isMounted,children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner",children:"⏳"}),e.jsx("span",{children:"Executing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"▶"}),e.jsx("span",{children:"Trigger Sequence"})]})}),!s.isMounted&&e.jsx("div",{className:"sequence-trigger-warning",children:"⚠️ This sequence is not mounted and cannot be triggered"})]})]}):e.jsxs("div",{className:"sequence-trigger-empty",children:[e.jsx("span",{className:"empty-icon",children:"🎯"}),e.jsx("span",{children:"Select a sequence from the list to trigger it"})]})},Nn=({execution:s,isExecuting:t})=>{if(!s)return e.jsxs("div",{className:"live-monitor-empty",children:[e.jsx("span",{className:"empty-icon",children:"📊"}),e.jsx("span",{children:"No execution in progress"})]});const r=c=>{switch(c){case"success":return"✅";case"error":return"❌";case"running":return"⏳";case"pending":return"⏸️";default:return"⏳"}},n=c=>{switch(c){case"success":return"#4caf50";case"error":return"#f44336";case"running":return"#2196f3";case"pending":return"#ff9800";default:return"#2196f3"}},a=()=>s.beats.length===0?0:s.beats.filter(p=>p.status==="success"||p.status==="error").length/s.beats.length*100,i=()=>s.totalDuration?s.totalDuration:s.endTime&&s.startTime?new Date(s.endTime).getTime()-new Date(s.startTime).getTime():s.startTime?Date.now()-new Date(s.startTime).getTime():0,l=a(),d=i();return e.jsxs("div",{className:"live-monitor-container",children:[e.jsxs("div",{className:"live-monitor-header",children:[e.jsx("h3",{className:"live-monitor-title",children:"Live Execution Monitor"}),e.jsxs("span",{className:"live-monitor-status-badge",style:{backgroundColor:n(s.status)},children:[r(s.status)," ",s.status]})]}),e.jsxs("div",{className:"live-monitor-info",children:[e.jsxs("div",{className:"live-monitor-info-row",children:[e.jsx("span",{className:"live-monitor-label",children:"Sequence:"}),e.jsx("span",{className:"live-monitor-value",children:s.sequenceId})]}),e.jsxs("div",{className:"live-monitor-info-row",children:[e.jsx("span",{className:"live-monitor-label",children:"Plugin:"}),e.jsx("span",{className:"live-monitor-value",children:s.pluginId})]}),e.jsxs("div",{className:"live-monitor-info-row",children:[e.jsx("span",{className:"live-monitor-label",children:"Duration:"}),e.jsxs("span",{className:"live-monitor-value",children:[d.toFixed(0),"ms"]})]}),e.jsxs("div",{className:"live-monitor-info-row",children:[e.jsx("span",{className:"live-monitor-label",children:"Beats:"}),e.jsxs("span",{className:"live-monitor-value",children:[s.beats.filter(c=>c.status==="success"||c.status==="error").length," / ",s.beats.length||"?"]})]})]}),s.beats.length>0&&e.jsxs("div",{className:"live-monitor-progress",children:[e.jsxs("div",{className:"live-monitor-progress-label",children:["Progress: ",l.toFixed(0),"%"]}),e.jsx("div",{className:"live-monitor-progress-bar",children:e.jsx("div",{className:"live-monitor-progress-fill",style:{width:`${l}%`,backgroundColor:n(s.status)}})})]}),s.beats.length>0&&e.jsxs("div",{className:"live-monitor-beats",children:[e.jsx("h4",{className:"live-monitor-beats-title",children:"Beats"}),e.jsx("div",{className:"live-monitor-beats-list",children:s.beats.map((c,p)=>e.jsx(wn,{beat:c},p))})]}),s.error&&e.jsxs("div",{className:"live-monitor-error",children:[e.jsx("span",{className:"error-icon",children:"❌"}),e.jsx("span",{children:s.error})]}),t&&s.status==="running"&&e.jsxs("div",{className:"live-monitor-loading",children:[e.jsx("span",{className:"spinner",children:"⏳"}),e.jsx("span",{children:"Execution in progress..."})]})]})},wn=({beat:s})=>{const t=n=>{switch(n){case"success":return"✅";case"error":return"❌";case"running":return"⏳";case"pending":return"⏸️";default:return"⏳"}},r=n=>{switch(n){case"success":return"#4caf50";case"error":return"#f44336";case"running":return"#2196f3";case"pending":return"#888";default:return"#2196f3"}};return e.jsxs("div",{className:`live-monitor-beat live-monitor-beat-${s.status}`,style:{borderLeftColor:r(s.status)},children:[e.jsxs("div",{className:"live-monitor-beat-header",children:[e.jsx("span",{className:"live-monitor-beat-icon",children:t(s.status)}),e.jsxs("span",{className:"live-monitor-beat-number",children:["Beat ",s.number]}),e.jsx("span",{className:"live-monitor-beat-event",children:s.event}),s.duration!==void 0&&e.jsxs("span",{className:"live-monitor-beat-duration",children:[s.duration.toFixed(1),"ms"]})]}),s.error&&e.jsx("div",{className:"live-monitor-beat-error",children:s.error})]})},Sn=({history:s,filter:t,onFilterChange:r,stats:n,pluginIds:a,onSelectItem:i,onClearHistory:l,onRemoveItem:d})=>{const c=u=>{switch(u){case"success":return"✅";case"error":return"❌";case"running":return"⏳";case"pending":return"⏸️";default:return"⏳"}},p=u=>new Date(u).toLocaleString(),h=u=>u===void 0?"N/A":`${u.toFixed(0)}ms`;return e.jsxs("div",{className:"execution-history-container",children:[e.jsxs("div",{className:"execution-history-header",children:[e.jsxs("h3",{className:"execution-history-title",children:["Execution History (",n.filtered,")"]}),e.jsxs("div",{className:"execution-history-stats",children:[e.jsxs("span",{className:"stat-badge",children:[n.total," total"]}),e.jsxs("span",{className:"stat-badge stat-badge-success",children:[n.success," success"]}),n.error>0&&e.jsxs("span",{className:"stat-badge stat-badge-error",children:[n.error," error"]}),n.avgDuration>0&&e.jsxs("span",{className:"stat-badge",children:["avg: ",n.avgDuration.toFixed(0),"ms"]})]}),n.total>0&&e.jsx("button",{className:"button-secondary",onClick:l,title:"Clear all history",children:"Clear All"})]}),e.jsxs("div",{className:"execution-history-filters",children:[e.jsx("input",{type:"text",className:"execution-history-search",placeholder:"Search history...",value:t.searchQuery||"",onChange:u=>r({...t,searchQuery:u.target.value})}),e.jsxs("div",{className:"execution-history-filter-row",children:[e.jsxs("select",{className:"execution-history-filter-select",value:t.status||"all",onChange:u=>r({...t,status:u.target.value}),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"error",children:"Error"}),e.jsx("option",{value:"running",children:"Running"})]}),e.jsxs("select",{className:"execution-history-filter-select",value:t.pluginId||"all",onChange:u=>r({...t,pluginId:u.target.value}),children:[e.jsx("option",{value:"all",children:"All Plugins"}),a.map(u=>e.jsx("option",{value:u,children:u},u))]})]})]}),s.length===0&&e.jsxs("div",{className:"execution-history-empty",children:[e.jsx("span",{className:"empty-icon",children:"📜"}),e.jsx("span",{children:"No execution history"}),t.searchQuery&&e.jsx("button",{className:"button-link",onClick:()=>r({...t,searchQuery:""}),children:"Clear search"})]}),s.length>0&&e.jsx("div",{className:"execution-history-list",children:s.map(u=>e.jsxs("div",{className:`execution-history-item execution-history-item-${u.status}`,onClick:()=>i(u),children:[e.jsxs("div",{className:"execution-history-item-header",children:[e.jsx("span",{className:"execution-history-item-icon",children:c(u.status)}),e.jsxs("div",{className:"execution-history-item-info",children:[e.jsx("div",{className:"execution-history-item-sequence",children:u.sequenceId}),e.jsx("div",{className:"execution-history-item-plugin",children:u.pluginId})]}),e.jsxs("div",{className:"execution-history-item-meta",children:[e.jsx("div",{className:"execution-history-item-duration",children:h(u.totalDuration)}),e.jsx("div",{className:"execution-history-item-timestamp",children:p(u.startTime)})]}),e.jsx("button",{className:"execution-history-item-remove",onClick:g=>{g.stopPropagation(),d(u.id)},title:"Remove from history",children:"×"})]}),u.error&&e.jsxs("div",{className:"execution-history-item-error",children:["⚠️ ",u.error]})]},u.id))})]})},Cn=()=>{const[s,t]=m.useState("log-replay"),[r]=m.useState(()=>Ke()),{execution:n,stats:a,error:i,isLoading:l,autoConverted:d,allExecutions:c,currentIndex:p,totalSequences:h,hasMultipleSequences:u,parse:g,clear:x,exportJson:j,goToSequence:y,nextSequence:S,prevSequence:f}=cn(),{groupedSequences:N,searchQuery:q,setSearchQuery:z,filterPlugin:J,setFilterPlugin:L,showMountedOnly:O,setShowMountedOnly:F,pluginIds:P,stats:R,isLoading:le,error:D}=dn(),{liveExecution:W,isExecuting:ne,execute:ce}=un(),{filteredHistory:M,filter:re,setFilter:ae,stats:X,pluginIds:ee,addToHistory:b,clearHistory:o,removeFromHistory:A}=hn(),[B,w]=m.useState(null),$=K.useMemo(()=>{if(c.length===0)return null;const T=c.reduce((U,Qe)=>U+Qe.totalDuration,0),H=c.filter(U=>U.status==="success").length,ie=c.filter(U=>U.status==="error").length;return{totalSequences:c.length,totalDuration:T,successCount:H,errorCount:ie,successRate:Math.round(H/c.length*100)}},[c]),C=()=>{const T=j();if(!T)return;const H=new Blob([T],{type:"application/json"}),ie=URL.createObjectURL(H),U=document.createElement("a");U.href=ie,U.download=`execution-${n?.requestId||"export"}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(ie)},v=T=>{w(T)},I=async(T,H)=>{await ce(T,H),setTimeout(()=>{W&&b(W)},1500)},k=()=>{w(null)},_=T=>{console.log("Selected history item:",T)};return e.jsxs("div",{className:"sequence-player",style:{display:"flex",flexDirection:"column",gap:"1rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{className:"sequence-player-tabs",children:[e.jsx("button",{className:`sequence-player-tab ${s==="log-replay"?"active":""}`,onClick:()=>t("log-replay"),children:"📜 Log Replay"}),e.jsxs("button",{className:`sequence-player-tab ${s==="live-trigger"?"active":""}`,onClick:()=>t("live-trigger"),disabled:!r,title:r?"Trigger sequences live":"Conductor not available",children:["▶️ Live Triggering",!r&&" (Unavailable)"]})]}),s==="log-replay"&&e.jsxs(e.Fragment,{children:[e.jsx(pn,{onParse:g,isLoading:l,error:i}),d&&e.jsxs("div",{style:{padding:"0.75rem 1rem",backgroundColor:"#e8f5e9",border:"1px solid #4caf50",borderRadius:"4px",color:"#2e7d32",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:"✨"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Auto-converted from console log format!"})," ","Your console logs were automatically detected and converted to JSON."]})]}),u&&$&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"aggregate-stats-panel",children:[e.jsx("h3",{className:"aggregate-stats-title",children:"📊 Aggregate Stats (All Sequences)"}),e.jsxs("div",{className:"aggregate-stats-grid",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Total Sequences:"})," ",$.totalSequences]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Total Duration:"})," ",$.totalDuration.toFixed(1),"ms"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Success Rate:"})," ",$.successRate,"% (",$.successCount,"/",$.totalSequences,")"]}),$.errorCount>0&&e.jsxs("div",{style:{color:"#d32f2f"},children:[e.jsx("strong",{children:"Failed:"})," ",$.errorCount]})]})]}),e.jsxs("div",{className:"sequence-navigation",children:[e.jsxs("div",{className:"sequence-navigation-left",children:[e.jsxs("span",{className:"sequence-counter",children:["Showing sequence ",p+1," of ",h]}),e.jsx("select",{value:p,onChange:T=>y(Number(T.target.value)),className:"sequence-selector",children:c.map((T,H)=>e.jsxs("option",{value:H,children:[H+1,". ",T.sequenceName," (",T.totalDuration,"ms)"]},H))})]}),e.jsxs("div",{className:"sequence-navigation-buttons",children:[e.jsx("button",{onClick:f,disabled:p===0,className:"sequence-nav-button",children:"← Previous"}),e.jsx("button",{onClick:S,disabled:p===h-1,className:"sequence-nav-button",children:"Next →"})]})]})]}),n&&a&&e.jsxs(e.Fragment,{children:[e.jsx(vn,{stats:a,onExport:C}),e.jsx(gn,{execution:n}),e.jsx("div",{style:{padding:"1rem",textAlign:"center"},children:e.jsx("button",{onClick:x,className:"button-secondary",style:{padding:"0.5rem 1rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",cursor:"pointer"},children:"Clear Results"})})]}),!n&&!i&&!l&&e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)",backgroundColor:"var(--bg-secondary)",borderRadius:"4px",margin:"1rem"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"🎬"}),e.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"Log Replay Mode"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:"Paste or upload a sequence execution log to visualize what happened"})]})]}),s==="live-trigger"&&e.jsx(e.Fragment,{children:r?e.jsxs("div",{className:"live-trigger-layout",children:[e.jsxs("div",{className:"live-trigger-left",children:[e.jsx(jn,{groupedSequences:N,searchQuery:q,onSearchChange:z,filterPlugin:J,onFilterChange:L,showMountedOnly:O,onMountedFilterChange:F,pluginIds:P,stats:R,onTriggerSequence:v,isLoading:le,error:D}),e.jsx(bn,{sequence:B,isExecuting:ne,onTrigger:I,onCancel:k})]}),e.jsxs("div",{className:"live-trigger-right",children:[e.jsx(Nn,{execution:W,isExecuting:ne}),e.jsx(Sn,{history:M,filter:re,onFilterChange:ae,stats:X,pluginIds:ee,onSelectItem:_,onClearHistory:o,onRemoveItem:A})]})]}):e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)",backgroundColor:"var(--bg-secondary)",borderRadius:"4px",margin:"1rem"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"⚠️"}),e.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"Conductor Not Available"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:"The conductor is not initialized. Live triggering is only available when the application is running."})]})})]})},kn=({onConvert:s})=>{const[t,r]=m.useState(""),[n,a]=m.useState(""),[i,l]=m.useState(null),[d,c]=m.useState(!1),[p,h]=m.useState(0),u=()=>{if(!t.trim()){l("Please paste log content first");return}c(!0),l(null);try{const S=Ve(t),f=JSON.stringify(S,null,2);a(f),h(S.length),s&&s(S)}catch(S){l(S instanceof Error?S.message:"Conversion failed")}finally{c(!1)}},g=()=>{r(""),a(""),l(null),h(0)},x=()=>{navigator.clipboard.writeText(n)},j=()=>{const S=new Blob([n],{type:"application/json"}),f=URL.createObjectURL(S),N=document.createElement("a");N.href=f,N.download=`converted-sequences-${Date.now()}.json`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(f)},y=S=>{const f=S.target.files?.[0];if(!f)return;const N=new FileReader;N.onload=q=>{const z=q.target?.result;r(z)},N.readAsText(f)};return e.jsxs("div",{className:"log-converter",children:[e.jsxs("div",{className:"converter-header",children:[e.jsx("h3",{children:"🔄 Log Converter"}),e.jsx("p",{children:"Convert console logs to JSON format for Sequence Player"})]}),i&&e.jsxs("div",{className:"error-message",style:{padding:"0.75rem",marginBottom:"1rem",backgroundColor:"rgba(255, 0, 0, 0.1)",border:"1px solid rgba(255, 0, 0, 0.3)",borderRadius:"4px",color:"#ff6b6b"},children:["❌ ",i]}),e.jsxs("div",{className:"converter-input-section",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("label",{htmlFor:"log-file-upload",style:{padding:"0.5rem 1rem",backgroundColor:"rgba(100, 100, 255, 0.2)",border:"1px solid rgba(100, 100, 255, 0.4)",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem"},children:"📁 Upload Log File"}),e.jsx("input",{id:"log-file-upload",type:"file",accept:".log,.txt",onChange:y,style:{display:"none"}}),e.jsx("button",{onClick:u,disabled:d||!t.trim(),style:{padding:"0.5rem 1rem",backgroundColor:d?"#666":"rgba(0, 200, 100, 0.2)",border:"1px solid rgba(0, 200, 100, 0.4)",borderRadius:"4px",cursor:d?"not-allowed":"pointer",fontSize:"0.875rem",color:"inherit"},children:d?"⏳ Converting...":"🔄 Convert to JSON"}),e.jsx("button",{onClick:g,style:{padding:"0.5rem 1rem",backgroundColor:"rgba(255, 100, 100, 0.2)",border:"1px solid rgba(255, 100, 100, 0.4)",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem",color:"inherit"},children:"🗑️ Clear"})]}),e.jsx("textarea",{value:t,onChange:S=>r(S.target.value),placeholder:`Paste console log content here...\r
\r
Example:\r
SequenceOrchestrator.ts:464 🎼 SequenceOrchestrator: Recording sequence execution: -2s79fo\r
ExecutionQueue.ts:40 🎼 ExecutionQueue: Enqueued "Canvas Component Resize Move" with priority NORMAL\r
...`,style:{width:"100%",minHeight:"200px",padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",backgroundColor:"rgba(0, 0, 0, 0.2)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"4px",color:"inherit",resize:"vertical"}})]}),n&&e.jsxs("div",{className:"converter-output-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("h4",{children:["✅ Converted JSON (",p," sequence",p!==1?"s":"",")"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:x,style:{padding:"0.5rem 1rem",backgroundColor:"rgba(100, 100, 255, 0.2)",border:"1px solid rgba(100, 100, 255, 0.4)",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem",color:"inherit"},children:"📋 Copy JSON"}),e.jsx("button",{onClick:j,style:{padding:"0.5rem 1rem",backgroundColor:"rgba(100, 200, 100, 0.2)",border:"1px solid rgba(100, 200, 100, 0.4)",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem",color:"inherit"},children:"💾 Download JSON"})]})]}),e.jsx("textarea",{value:n,readOnly:!0,style:{width:"100%",minHeight:"300px",padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",backgroundColor:"rgba(0, 100, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"4px",color:"inherit",resize:"vertical"}}),e.jsx("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"rgba(100, 100, 255, 0.1)",borderRadius:"4px"},children:e.jsxs("p",{style:{margin:0,fontSize:"0.875rem"},children:["💡 ",e.jsx("strong",{children:"Tip:"}),' Copy this JSON and paste it into the Sequence Player (select "JSON" format)']})})]})]})},In=({conductor:s})=>{const{logs:t,addLog:r,clearLogs:n}=ln(),{manifest:a,interactionStats:i,topicsStats:l,pluginStats:d,components:c,loading:p,refresh:h}=tn(s,r),{introspection:u,refresh:g}=nn(s),{metrics:x,trackMetric:j}=an(),{stats:y,updateStats:S}=on();rn(s,r);const f=m.useCallback(async()=>{await h(),g()},[h,g]),[N,q]=m.useState(""),[z,J]=m.useState(new Set),[L]=m.useState(0),[O,F]=m.useState(null),[P,R]=m.useState("overview"),[le,D]=m.useState(null),[W,ne]=m.useState(()=>{const v=localStorage.getItem("diagnostics-left-panel-width");return v?parseInt(v,10):300});m.useEffect(()=>{a?.plugins&&S({totalPlugins:a.plugins.length})},[a,S]);const ce=async v=>{if(!s)return;const I=Date.now();try{r("info",`Testing interaction: ${v}`);const k=Ce(v);r("info",`Resolved to: ${k.pluginId} / ${k.sequenceId}`);const _=await s.play(k.pluginId,k.sequenceId,{test:!0,timestamp:Date.now()}),T=Date.now()-I;j(`interaction_${v}`,T),r("info",`Interaction test completed for ${v} in ${T}ms`,_)}catch(k){const _=Date.now()-I;j(`interaction_${v}_error`,_),r("error",`Interaction test failed for ${v} after ${_}ms`,k)}},M=async v=>{if(s)try{r("info",`Testing topic: ${v}`),await s.publish(v,{test:!0,timestamp:Date.now(),source:"diagnostics-panel-test"},s),r("info",`Topic test completed for ${v}`)}catch(I){r("error",`Topic test failed for ${v}`,I)}},re=()=>{const v={timestamp:new Date().toISOString(),stats:{loading:y,interaction:i,topics:l,plugins:d,conductor:u},logs:t,manifest:a},I=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),k=URL.createObjectURL(I),_=document.createElement("a");_.href=k,_.download=`diagnostics-report-${Date.now()}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(k),r("info","Exported detailed report")},ae=v=>{J(I=>{const k=new Set(I);return k.has(v)?k.delete(v):k.add(v),k})},X=m.useMemo(()=>Ze(),[L]),ee=m.useCallback(v=>{if(F(v),!v){R("overview"),D(null);return}if(v==="plugins")R("plugins"),D(null);else if(v.startsWith("plugin:")){const I=v.split(":");if(I.length===3){const k=I[1];I[2];const _=a?.plugins.find(T=>T.id===k);R("inspection"),D(_)}else{const k=v.substring(7),_=a?.plugins.find(T=>T.id===k);R("plugins"),D(_)}}else if(v==="routes")R("routes"),D(null);else if(v.startsWith("route:")){const I=v.substring(6),k=i?.routes?.find(_=>_.route===I);R("routes"),D(k)}else if(v==="topics")R("topics"),D(null);else if(v.startsWith("topic:")){const I=v.substring(6),k=X[I];R("topics"),D({name:I,def:k})}else v==="components"?(R("components"),D(null)):v==="conductor"?(R("conductor"),D(null)):v==="performance"?(R("performance"),D(null)):v==="sequence-player"?(R("sequence-player"),D(null)):v==="log-converter"?(R("log-converter"),D(null)):(R("overview"),D(null))},[a,i,X]),b=m.useMemo(()=>!a||!N?a?.plugins||[]:a.plugins.filter(v=>v.id.toLowerCase().includes(N.toLowerCase())||v.ui?.slot?.toLowerCase().includes(N.toLowerCase())||v.ui?.module?.toLowerCase().includes(N.toLowerCase())),[a,N]),o=a?.plugins?.length||0,A=m.useMemo(()=>!s||!a?.plugins?new Set:new Set(a.plugins.map(v=>v.id)),[s,a]),B=A.size,w=Math.max(0,o-B),$=i?.routeCount||0,C=l?.topicCount||0;return e.jsxs("div",{className:"inspector-container",children:[e.jsxs("div",{className:"inspector-header",children:[e.jsx("h1",{className:"inspector-title",children:"RenderX Diagnostics Panel"}),e.jsx("p",{className:"inspector-subtitle",children:"Plugin Introspection & System Diagnostics"})]}),e.jsxs("div",{className:"inspector-content",children:[e.jsx(_t,{loading:p,onRefresh:f,onExport:re,onClearLogs:n}),e.jsx(Ct,{loadedPluginsCount:B,totalPluginsCount:o,failedPluginsCount:w,routeCount:$,topicCount:C}),e.jsxs("div",{className:"layout-three-panel",children:[e.jsx("aside",{className:"left-panel",style:{width:`${W}px`},children:e.jsx(yt,{plugins:a?.plugins||[],routes:i?.routes||[],topicsMap:X,onSelectNode:ee})}),e.jsx("div",{className:"resize-handle",onMouseDown:v=>{v.preventDefault();const I=v.clientX,k=W,_=H=>{const ie=H.clientX-I,U=Math.max(250,Math.min(600,k+ie));ne(U)},T=()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",T),localStorage.setItem("diagnostics-left-panel-width",W.toString())};document.addEventListener("mousemove",_),document.addEventListener("mouseup",T)}}),e.jsxs("section",{className:"right-panel",children:[e.jsx("input",{type:"text",className:"search-box",placeholder:`Search ${P}...`,value:N,onChange:v=>q(v.target.value)}),e.jsxs("div",{className:"grid",children:[P==="inspection"&&e.jsx(wt,{selectedNode:O,nodeData:le,onNavigate:v=>ee(v),onAction:(v,I)=>{console.log("Action:",v,I),r("info",`Action: ${v} on ${I.pluginId}`)}}),P==="plugins"&&e.jsx(kt,{plugins:b,loadedPluginIds:A,searchTerm:N}),P==="topics"&&e.jsx(It,{topicsMap:new Map(Object.entries(X)),searchTerm:N,expandedItems:z,loading:p,conductor:s,onToggleExpanded:ae,onTestTopic:M}),P==="routes"&&e.jsx(qt,{routes:i?.routes||[],routeCount:i?.routeCount||0,searchTerm:N,loading:p,conductor:s,onTestInteraction:ce}),P==="components"&&e.jsx($t,{components:c,searchTerm:N}),P==="conductor"&&e.jsx(Et,{introspection:u}),P==="performance"&&e.jsx(Mt,{conductor:s,performanceMetrics:x,interactionStatsLoaded:!!i?.loaded,topicsStatsLoaded:!!l?.loaded,logs:t}),P==="sequence-player"&&e.jsx(Cn,{}),P==="log-converter"&&e.jsx(kn,{})]}),e.jsx(Tt,{logs:t})]}),e.jsx(Rt,{selectedNodePath:O,loadedPluginsCount:B,totalPluginsCount:o,routeCount:$,topicCount:C,logs:t,onExport:re,onRefresh:f})]})]})]})},Te=({isOpen:s,onClose:t,conductor:r})=>{const n=m.useRef(null);m.useEffect(()=>{if(!s)return;const i=l=>{l.key==="Escape"&&t()};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[s,t]);const a=i=>{i.target===n.current&&t()};return s?ls.createPortal(e.jsx("div",{ref:n,className:"diagnostics-overlay",onClick:a,children:e.jsxs("div",{className:"diagnostics-modal",children:[e.jsx("div",{className:"diagnostics-modal-header",children:e.jsx("button",{className:"diagnostics-close-btn",onClick:t,"aria-label":"Close diagnostics",children:"✕"})}),e.jsx("div",{className:"diagnostics-modal-content",children:e.jsx(In,{conductor:r})})]})}),document.body):null};function qn(){const[s,t]=m.useState(!1),[r,n]=m.useState(!1);m.useEffect(()=>{const l=vs(js);return()=>l()},[]),m.useEffect(()=>{if(!Ie("diagnostics.enabled"))return;n(!0);const d=c=>{(c.ctrlKey||c.metaKey)&&c.shiftKey&&c.key==="D"&&(c.preventDefault(),t(p=>!p))};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[]);const a=Ie("ui.layout-manifest"),i=m.useMemo(()=>window.RenderX?.conductor,[]);return a?e.jsxs(e.Fragment,{children:[e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"p-3",children:"Loading Layout…"}),children:e.jsx(xs,{})}),r&&e.jsxs("div",{className:"diagnostics-badge",onClick:()=>t(!0),title:"Open Diagnostics (Ctrl+Shift+D)",children:["🔍",e.jsx("span",{className:"diagnostics-badge-tooltip",children:"Diagnostics (Ctrl+Shift+D)"})]}),e.jsx(Te,{isOpen:s,onClose:()=>t(!1),conductor:i})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"legacy-grid",children:[e.jsx("div",{"data-slot":"library",className:"slot-wrapper",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"p-3",children:"Loading Library…"}),children:e.jsx(te,{slot:"library"})})}),e.jsx("div",{"data-slot":"canvas",className:"slot-wrapper",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"p-3",children:"Loading Canvas…"}),children:e.jsx(te,{slot:"canvas",capabilities:{droppable:!0}})})}),e.jsx("div",{"data-slot":"controlPanel",className:"slot-wrapper",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"p-3",children:"Loading Control Panel…"}),children:e.jsx(te,{slot:"controlPanel"})})})]}),r&&e.jsxs("div",{className:"diagnostics-badge",onClick:()=>t(!0),title:"Open Diagnostics (Ctrl+Shift+D)",children:["🔍",e.jsx("span",{className:"diagnostics-badge-tooltip",children:"Diagnostics (Ctrl+Shift+D)"})]}),e.jsx(Te,{isOpen:s,onClose:()=>t(!1),conductor:i})]})}const oe=new Map;function $n(s){if(oe.clear(),s)for(const[r,n]of Object.entries(s))n!==void 0&&n!==""&&oe.set(r,n);const t={getValue(r){return oe.get(r)},hasValue(r){return oe.has(r)},get(r){return oe.get(r)},has(r){return oe.has(r)}};return typeof window<"u"&&(window.RenderX=window.RenderX||{},window.RenderX.config=t),t}const En="http://localhost:5000";function Mn(){try{const s=globalThis;if(s&&s.__RENDERX_DOTNET_BASE_URL)return String(s.__RENDERX_DOTNET_BASE_URL)}catch{}return En}async function ve(s,t){const r=`${Mn()}${s}`,n=await fetch(r,{...t,headers:{"content-type":"application/json",...t?.headers||{}}});if(!n.ok){const i=await n.text().catch(()=>"");throw new Error(`HTTP ${n.status} ${n.statusText} for ${s}: ${i}`)}if((n.headers.get("content-type")||"").includes("application/json"))return await n.json()}async function ge(s){try{const t={source:s.source||"frontend",timestamp:s.timestamp||new Date().toISOString(),...s};return await ve("/api/telemetry/event",{method:"POST",body:JSON.stringify(t)})}catch(t){return{success:!1,message:String(t||"telemetry_error")}}}async function Re(){return ve("/api/plugins/")}async function Tn(s){return ve(`/api/plugins/${encodeURIComponent(s)}/enable`,{method:"POST"})}async function Rn(s){return ve(`/api/plugins/${encodeURIComponent(s)}/disable`,{method:"POST"})}async function _e(){try{const t=globalThis?.window?.renderxCommunicationSystem?.conductor;if(t)return t}catch{}return await Oe()}const _n={async hasClass(s){return!1},async createClass(s,t,r){const n=await _e();await xe.publish("control.panel.css.create.requested",{id:s,className:t,content:r},n)},async updateClass(s,t,r){const n=await _e();await xe.publish("control.panel.css.edit.requested",{id:s,className:t,content:r},n)}};var be={};(async()=>{const s=await Oe();await Promise.all([Ye(s),Ge(),es()]),window.RenderX=window.RenderX||{};try{const n=s.play?.bind(s);typeof n=="function"&&(s.play=async(a,i,l)=>{const d=Date.now();try{await ge({eventType:"sequence.started",payload:{pluginId:a,sequenceId:i,input:l}})}catch{}try{const c=await n(a,i,l);try{await ge({eventType:"sequence.completed",payload:{pluginId:a,sequenceId:i,durationMs:Date.now()-d}})}catch{}return c}catch(c){try{await ge({eventType:"sequence.failed",payload:{pluginId:a,sequenceId:i,error:String(c)}})}catch{}throw c}})}catch{}window.RenderX.conductor||(window.RenderX.conductor=s),window.RenderX.resolveInteraction||(window.RenderX.resolveInteraction=Ce),window.RenderX.getTopicDef||(window.RenderX.getTopicDef=ke);{const n={...de,async publish(a,i,l){try{ge({eventType:a,payload:i,source:"frontend"})}catch{}return de.publish(a,i,l)}};window.RenderX.EventRouter=n}try{window.addEventListener("message",n=>{const a=n&&n.data||null;if(!a||a.source!=="dotnet-host")return;const i=a.topic||a?.message?.topic,l=a.payload??a?.message?.payload??a?.message;if(typeof i=="string"&&i.length)try{window.RenderX?.EventRouter?.publish?.(i,l)}catch{}})}catch{}window.RenderX.featureFlags||(window.RenderX.featureFlags={isFlagEnabled:ns,getFlagMeta:ts,getAllFlags:ss}),window.RenderX.inventory||(window.RenderX.inventory={listComponents:Pe,getComponentById:as,onInventoryChanged:rs}),window.RenderX.cssRegistry||(window.RenderX.cssRegistry=_n),window.RenderX.plugins||(window.RenderX.plugins={list:Re,enable:Tn,disable:Rn});try{Re().then(n=>{try{console.log("🔌 Plugins discovered via .NET bridge:",n?.plugins?.map(a=>a.id))}catch{}}).catch(()=>{})}catch{}if($n({OPENAI_API_KEY:"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",OPENAI_MODEL:"gpt-3.5-turbo"}),window.RenderX.sequencesReady=!0,window.testEventRouter=function(){console.log("🧪 Testing EventRouter...");const n={id:"test-node-manual",type:"button"};console.log("📤 Publishing control.panel.selection.updated with:",n),window.RenderX.EventRouter.publish("control.panel.selection.updated",n),console.log("✅ Publish complete")},window.testCanvasSelection=function(){console.log("🧪 Testing canvas selection event...");const n={id:"test-node-manual-canvas"};console.log("📤 Publishing canvas.component.selection.changed with:",n),window.RenderX.EventRouter.publish("canvas.component.selection.changed",n),console.log("✅ Canvas selection publish complete")},!(typeof process<"u"&&be?.RENDERX_DISABLE_STARTUP_VALIDATION==="1")){try{const n=Ne(),a=De(),i=await Le();console.log("🧪 Startup validation:",{routes:n.routeCount,topics:a.topicCount,plugins:i.pluginCount});try{const l=s.getMountedPluginIds?.()||[],d={flag:!1,routes:n.routeCount,topics:a.topicCount,plugins:i.pluginCount,mountedCount:l.length,pluginIds:l,libraryComponentsLoaded:!1,when:Date.now()};window.__rx=window.__rx||{},window.__rx.ready=d;try{const p=new URLSearchParams(window.location.search||""),h=p.get("debug")==="1"||typeof process<"u"&&be?.RENDERX_DEBUG_STARTUP==="1",u=p.get("failFast")==="1"||typeof process<"u"&&be?.RENDERX_FAIL_FAST_VALIDATE==="1";if(h){const j=s.getMountedPluginIds?.()||[],y=s._runtimeMountedSeqIds,S=Array.isArray(y)?y:y instanceof Set?Array.from(y):[];console.info("🔎 Startup debug:",{routes:d.routes,topics:d.topics,plugins:d.plugins,mountedCount:d.mountedCount,mountedIds:j,sequenceIds:S});try{let f=null;const N=(...q)=>{try{console.info("🔎 Selection",...q)}catch{}};de.subscribe("canvas.component.select.requested",q=>{N("canvas.component.select.requested",q),f&&clearTimeout(f),f=setTimeout(()=>{N("control.panel.selection.show.requested NOT observed within 300ms after select.requested")},300)}),de.subscribe("canvas.component.selection.changed",q=>{N("canvas.component.selection.changed",q)}),de.subscribe("control.panel.selection.show.requested",q=>{N("control.panel.selection.show.requested",q),f&&(clearTimeout(f),f=null)})}catch{}}const g=["control.panel.ui.render.requested","control.panel.selection.show.requested","library.component.drop.requested","canvas.component.drag.move"],x=[];for(const j of g)ke(j)||x.push(j);if((h||u)&&x.length&&(console.error("❌ Missing required topics:",x),u))throw new Error("Missing required topics: "+x.join(", "))}catch{}window.__rx.markLibraryComponentsLoaded=()=>{if(window.__rx?.ready){window.__rx.ready.libraryComponentsLoaded=!0,window.__rx.ready.flag=!0;try{window.dispatchEvent(new CustomEvent("renderx:ready",{detail:d}))}catch{}}};const c=()=>{const p=document.querySelector('[data-slot="library"]');if(p&&p.querySelectorAll('[draggable="true"], [draggable]').length>0){window.__rx.markLibraryComponentsLoaded();return}setTimeout(c,100)};setTimeout(c,500)}catch{}}catch(n){console.warn("Startup validation failed",n)}is(!0)}if(!document.getElementById("root")){const n=document.createElement("div");n.id="root",document.body.appendChild(n)}os.createRoot(document.getElementById("root")).render(e.jsx(qn,{}))})();
