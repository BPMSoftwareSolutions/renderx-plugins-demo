import"./EventRouter-DUQzZvsb.js";import"./global-CMa2Rm43.js";import{C}from"./chunk-CMHQFAJR-C6rTeyx0.js";import{getCanvasOrThrow as A,createElementWithId as _,applyClasses as w,applyInlineStyle as I,appendTo as j}from"./create.dom.stage-crew-CN049VEG.js";import{attachSelection as E,attachDrag as D,attachSvgNodeClick as V}from"./create.interactions.stage-crew-Dw6EdwPy.js";import{registerInstance as O}from"./create.io-DXpKi8LB.js";import{notifyUi as k}from"./create.notify-DLN_qW9B.js";import{renderReact as x}from"./create.react.stage-crew-bIbKy_6z.js";import{computeInstanceClass as R,computeCssVarBlock as T,computeInlineStyle as B}from"./create.style.stage-crew-DwsKC_sf.js";import{enhanceLine as M}from"./augment.line.stage-crew-DObEWdyr.js";import{resolveTemplate as N}from"./create.arrangement-BI_PH88E.js";import{injectRawCss as b}from"./create.css.stage-crew-9NMo-z0p.js";var p=new C;function P(o,s,c){p.applyContent(o,c,s)}var v=(o,s)=>{var c;const t=s.payload.template,a=s.payload.nodeId,g=A(),e=_(t.tag,a);t.css&&(b(s,t.css),((c=s.payload)._cssQueue||(c._cssQueue=[])).push(t.css));const l=R(t.tag,a),u=t.cssVariables||{},m=T(u);m&&b(s,`.${l} ${m}`);const f=B(o,t),d=Array.from(new Set([...t.classes||[],l]));if(w(e,d),I(e,f),typeof t.text=="string"&&t.text.length&&(e.textContent=String(t.text)),t?.attributes&&typeof t.attributes=="object")for(const[r,i]of Object.entries(t.attributes))try{if(i==null)continue;e.setAttribute(r,String(i))}catch{}if(t?.content&&typeof t.content=="object"){P(e,t.content,t.tag);try{const r=p.getUpdateRulesFor(e)||[];for(const i of r)if(i?.action==="toggleClassVariant"){const n=i.whenAttr,y=t.content[n];y!==void 0&&p.applyUpdate(e,n,y)}}catch{}}if(String(t?.tag).toLowerCase()==="svg"&&d.includes("rx-line"))try{const r=e;r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("viewBox","0 0 100 100"),r.setAttribute("preserveAspectRatio","none");const n=document.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("class","segment"),n.setAttribute("x1","0"),n.setAttribute("y1","50"),n.setAttribute("x2","100"),n.setAttribute("y2","50"),n.setAttribute("vector-effect","non-scaling-stroke"),r.appendChild(n)}catch{}const S=o?.containerId&&document.getElementById(String(o.containerId))||g;j(S,e),t?.attributes?.["data-role"]==="container"&&(e.dataset.role="container",e.style.position="relative"),E(e,a,o?.onSelected),D(e,g,a,{onDragStart:o?.onDragStart,onDragMove:o?.onDragMove,onDragEnd:o?.onDragEnd}),t.tag==="svg"&&e instanceof SVGSVGElement&&V(e,a,s?.conductor),s.payload.createdNode={id:a,tag:t.tag,text:t.text,classes:[...t.classes||[],l],style:f,position:o.position,css:t.css,cssVariables:u,instanceClass:l}},h={resolveTemplate:N,registerInstance:O,createNode:v,renderReact:x,notifyUi:k,enhanceLine:M};const X=Object.freeze(Object.defineProperty({__proto__:null,createNode:v,handlers:h},Symbol.toStringTag,{value:"Module"})),Y=Object.freeze(Object.defineProperty({__proto__:null,handlers:h},Symbol.toStringTag,{value:"Module"}));export{Y as a,X as c,h};
