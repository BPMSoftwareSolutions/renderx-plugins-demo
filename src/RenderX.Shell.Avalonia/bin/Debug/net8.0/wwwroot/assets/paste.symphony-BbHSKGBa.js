import{toCreatePayloadFromData as b,attachStandardImportInteractions as h}from"./create.from-import-CoZP2EUZ.js";import{getClipboardText as l}from"./_clipboard-BxzBjI5u.js";import{r as x}from"./interactionManifest-BORsh5a3.js";function _(t){const o=document.getElementById("rx-selection-overlay")?.dataset?.targetId;return t?.id||t?.selectedId||o}function I(t,o){const e=t.tagName.toLowerCase(),n=Array.from(t.classList||[]).filter(c=>!/^rx-comp-[^-]+-/.test(c)),r={};t.style.width&&(r.width=t.style.width),t.style.height&&(r.height=t.style.height),t.style.background&&(r.background=t.style.background),t.style.color&&(r.color=t.style.color),t.style.padding&&(r.padding=t.style.padding);const s=t.style.left?parseFloat(t.style.left):0,a=t.style.top?parseFloat(t.style.top):0,i={tag:e,classes:n,style:r,text:(t.textContent||"").toString()};return t.getAttribute("data-role")==="container"&&(i.attributes={...i.attributes||{},"data-role":"container"}),{id:o,template:i,position:{x:s,y:a}}}async function d(t,o){let e="";try{e=await navigator?.clipboard?.readText?.()}catch{}if(!e)try{e=l()}catch{}try{const n=JSON.parse(String(e||""));if(n&&n.type==="renderx-component")return{clipboardText:e,clipboardData:n}}catch{}return{clipboardText:e}}async function y(t,o){let e=String(t?.clipboardText||"");if(!e)try{e=l()}catch{}try{const n=JSON.parse(e);if(n&&n.type==="renderx-component")return{clipboardData:n}}catch{}return{}}async function g(t,o){const e=t?.clipboardData?.component;if(!e)return t||{};const n=e.position||{x:0,y:0},r={x:(n.x||0)+20,y:(n.y||0)+20};return{...t,newPosition:r}}async function f(t,o){try{let e=t?.clipboardData?.component,n=null;if(e)o?.logger?.info?.("Using clipboardData component",{comp:e});else{try{const c=l();n=JSON.parse(String(c||"")),n&&n.type==="renderx-component"&&(e=n,o?.logger?.info?.("Using memory clipboard component",{comp:e}))}catch{}if(!e)try{const c=_(t),p=c?document.getElementById(String(c)):null;p&&(e=I(p,String(c)),o?.logger?.info?.("Using DOM fallback component",{comp:e}))}catch{}}if(!e){o?.logger?.warn?.("No component data found for paste");return}const r=b(e);o?.logger?.info?.("Transformed payload",{payload:r});const s=e?.position||r?.position||{x:0,y:0};let a=t?.newPosition??{x:(s.x||0)+20,y:(s.y||0)+20};e?.position&&a.x===e.position.x&&a.y===e.position.y&&(a={x:a.x+20,y:a.y+20}),r.position=a,"_overrideNodeId"in r&&delete r._overrideNodeId,h(r,o);const i=x("canvas.component.create");o?.logger?.info?.("Calling canvas.component.create",{pluginId:i.pluginId,sequenceId:i.sequenceId,payload:r}),await o?.conductor?.play?.(i.pluginId,i.sequenceId,r)}catch(e){try{o?.logger?.warn?.("Create pasted component failed",e)}catch{}}}async function m(t,o){}var u={readFromClipboard:d,deserializeComponentData:y,calculatePastePosition:g,createPastedComponent:f,notifyPasteComplete:m};const C=Object.freeze(Object.defineProperty({__proto__:null,calculatePastePosition:g,createPastedComponent:f,deserializeComponentData:y,handlers:u,notifyPasteComplete:m,readFromClipboard:d},Symbol.toStringTag,{value:"Module"})),O=Object.freeze(Object.defineProperty({__proto__:null,handlers:u},Symbol.toStringTag,{value:"Module"}));export{g as a,O as b,f as c,y as d,m as n,C as p,d as r};
