import{E as p}from"./EventRouter-DUQzZvsb.js";var g=new Set(["fill","stroke","stroke-width","stroke-dasharray","stroke-linecap","stroke-linejoin","opacity","fill-opacity","stroke-opacity","x","y","width","height","cx","cy","r","rx","ry","transform"]);async function h(s,e){const{id:o,path:r,attribute:n,value:a}=s||{};if(!o||!r||!n){e?.logger?.warn?.("SVG node update requires id, path, and attribute");return}if(!g.has(n)){e?.logger?.warn?.(`SVG attribute '${n}' is not allowed for security reasons`);return}const u=document.getElementById(String(o));if(!u){e?.logger?.warn?.(`SVG component with id ${o} not found`);return}let l=u;if(typeof r=="string"&&r.trim().length){const i=r.split("/").map(t=>t.trim()).filter(Boolean).map(t=>Number(t)).filter(t=>Number.isFinite(t)&&t>=0);for(const t of i){const d=Array.from(l.children);if(!d.length||t>=d.length){e?.logger?.warn?.(`Invalid path segment at index ${t} for path '${r}'`);return}l=d[t]}}try{if(a==null||a==="")l.removeAttribute(n);else{const i=String(a);l.setAttribute(n,i)}e.payload=e.payload||{},e.payload.updatedSvgNode={id:o,path:r,attribute:n,value:a},e.payload.elementId=o,e?.logger?.info?.(`Updated SVG node attribute: ${n} = ${a} at path ${r}`)}catch(i){e?.logger?.warn?.(`Failed to update SVG node attribute ${n}:`,i)}}function m(s,e){const o=e.payload?.elementId;if(!o){e?.logger?.warn?.("No element ID found for Control Panel refresh");return}try{p.publish("control.panel.update.requested",{id:o,source:"svg-node-update"},e?.conductor)}catch(r){e?.logger?.warn?.("Failed to refresh Control Panel after SVG node update:",r)}}export{m as refreshControlPanel,h as updateSvgNodeAttribute};
