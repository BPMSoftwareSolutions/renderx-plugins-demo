var a=async(n,o)=>{try{o.logger?.info?.("Querying all components from KV store");let e=[];if(o.io?.kv?.getAll)try{e=await o.io.kv.getAll(),o.logger?.info?.(`KV store available, found ${e?.length||0} components`)}catch(r){o.logger?.warn?.("KV store error:",r),e=[]}else o.logger?.info?.("KV store not available");(!e||e.length===0)&&(o.logger?.info?.("KV store empty, requesting DOM discovery for export"),e=o.payload.components||[]),o.payload.components=e||[],o.payload.componentCount=e?.length||0,o.payload.source||(o.payload.source="kv-store"),o.logger?.info?.(`Retrieved ${o.payload.componentCount} components from ${o.payload.source}`)}catch(e){o.logger?.error?.("Failed to query components:",e),o.payload.error=String(e),o.payload.components=[],o.payload.componentCount=0}};export{a as queryAllComponents};
