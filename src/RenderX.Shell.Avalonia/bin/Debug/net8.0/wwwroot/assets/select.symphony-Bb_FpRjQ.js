import{ensureAdvancedLineOverlayFor as v,attachAdvancedLineManipHandlers as h}from"./select.overlay.line-advanced.stage-crew-CF7iQdNt.js";import{attachResizeHandlers as b}from"./select.overlay.resize.stage-crew-i_8OfntN.js";import{ensureOverlay as w,applyOverlayRectForEl as I}from"./select.overlay.dom.stage-crew-T3p4uTrs.js";import{u as c}from"./Header-A6BR6KQZ-DYj0DEFE.js";import{E as S}from"./EventRouter-DUQzZvsb.js";import{r as E}from"./interactionManifest-BORsh5a3.js";import{i as _}from"./feature-flags-IuyZAa4_.js";async function u(e,o){try{if(e?._routed===!0)return;const t=e?.id;if(!t)return;const n=o?.conductor||c()||window.RenderX?.conductor;if(!n?.play){o.logger?.warn?.("No conductor available for selection routing");return}const r=E("canvas.component.select");await n.play(r.pluginId,r.sequenceId,{id:t,_routed:!0})}catch(t){o.logger?.warn?.("Selection routing error:",t)}}function O(e){return e?.id||e?.elementId||e?.event?.target?.closest?.(".rx-comp")?.id}function A(e,o){const t=o.getAttribute("data-resize-handles"),n=new Set((t||"nw,n,ne,e,se,s,sw,w").split(",").map(a=>a.trim()).filter(Boolean));e.querySelectorAll(".rx-handle").forEach(a=>{const l=Array.from(a.classList).find(i=>["n","s","e","w","nw","ne","sw","se"].includes(i));a.style.display=l&&n.has(l)?"block":"none"})}function y(e,o){const t=O(e);if(!t)return{};const n=document.getElementById(String(t));if(!n)return{};const r=(n.getAttribute("data-overlay")||"").trim().toLowerCase(),a=r==="line-advanced"||r==="line-endpoints",l=n.tagName?.toLowerCase()==="svg"&&n.classList.contains("rx-line"),i=_("lineAdvanced")&&n.classList.contains("rx-line")&&(a||l),d=o?.conductor||c();if(i){const s=document.getElementById("rx-selection-overlay");s&&(s.style.display="none")}else{const s=w();b(s,d),s.dataset.targetId=String(t),A(s,n),s.style.display="block",I(s,n)}try{if(i){const s=v(n);s.dataset.targetId=String(t),h(s,d),s.style.display="block"}}catch{}return{id:t}}function m(){const e=document.getElementById("rx-selection-overlay");e&&(e.style.display="none")}function p(e,o){try{const t=document.getElementById("rx-selection-overlay")?.dataset?.targetId,n=e?.id||o?.baton?.id||o?.baton?.elementId||o?.baton?.selectedId||t;if(!n)return;const r=(o?.conductor||c())?.play;r&&r("ControlPanelPlugin","control-panel-selection-show-symphony",{id:n})}catch{}}async function f(e,o){try{const t=o?.baton??e,n=document.getElementById("rx-selection-overlay")?.dataset?.targetId,r=e?.id||t?.id||t?.elementId||t?.selectedId||n;r&&await S.publish("canvas.component.selection.changed",{id:String(r)},o?.conductor)}catch{}}var g={routeSelectionRequest:u,showSelectionOverlay:y,hideSelectionOverlay:m,notifyUi:p,publishSelectionChanged:f};const P=Object.freeze(Object.defineProperty({__proto__:null,handlers:g,hideSelectionOverlay:m,notifyUi:p,publishSelectionChanged:f,routeSelectionRequest:u,showSelectionOverlay:y},Symbol.toStringTag,{value:"Module"})),k=Object.freeze(Object.defineProperty({__proto__:null,handlers:g},Symbol.toStringTag,{value:"Module"}));export{P as a,k as b,m as h,p as n,f as p,u as r,y as s};
